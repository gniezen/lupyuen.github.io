<!doctype html><html lang="en"><head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app39.us.archive.org';v.server_ms=263;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="/_static/js/playback.bundle.js?v=bQvHU8mx" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=cRqOKCOw" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","20200117210221","https://web.archive.org/","web","/_static/",
	      "1579294941");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=bsmaklHF" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->
<script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title data-rh="true">OpenOCD on Raspberry Pi: Better with SWD on SPI - Lup Yuen Lee 李立源 - Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-01-17T20:47:26.370Z"/><meta data-rh="true" name="title" content="OpenOCD on Raspberry Pi: Better with SWD on SPI - Lup Yuen Lee 李立源 - Medium"/><meta data-rh="true" property="og:title" content="OpenOCD on Raspberry Pi: Better with SWD on SPI"/><meta data-rh="true" property="twitter:title" content="OpenOCD on Raspberry Pi: Better with SWD on SPI"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/7dea9caeb590"/><meta data-rh="true" property="al:android:url" content="medium://p/7dea9caeb590"/><meta data-rh="true" property="al:ios:url" content="medium://p/7dea9caeb590"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="The setup that we see above… Debugging nRF52 with a Raspberry Pi running VSCode and OpenOCD… Was impossible just a week ago! OpenOCD connects to nRF52 for flashing and debugging by running Arm’s SWD…"/><meta data-rh="true" property="og:description" content="Sneaky tricks to align stray bits into proper bytes"/><meta data-rh="true" property="twitter:description" content="Sneaky tricks to align stray bits into proper bytes"/><meta data-rh="true" property="og:url" content="https://web.archive.org/web/20200117210221/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590"/><meta data-rh="true" property="og:image" content="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1200/1*I26BDuv0_N07S2JD_PZYWA.jpeg"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*I26BDuv0_N07S2JD_PZYWA.jpeg"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@ly.lee"/><meta data-rh="true" name="twitter:creator" content="@MisterTechBlog"/><meta data-rh="true" name="author" content="Lup Yuen Lee 李立源"/><meta data-rh="true" name="robots" content="index,follow"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="12 min read"/><meta data-rh="true" name="parsely-post-id" content="7dea9caeb590"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/web/20200117210221/https://medium.com/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://web.archive.org/web/20200117210221im_/https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://web.archive.org/web/20200117210221im_/https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://web.archive.org/web/20200117210221im_/https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://web.archive.org/web/20200117210221im_/https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="mask-icon" href="https://web.archive.org/web/20200117210221im_/https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"/><link data-rh="true" rel="icon" href="https://web.archive.org/web/20200117210221im_/https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://web.archive.org/web/20200117210221cs_/https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"/><link data-rh="true" rel="author" href="https://medium.com/@ly.lee"/><link data-rh="true" rel="canonical" href="https://web.archive.org/web/20200117210221/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590"/><link data-rh="true" rel="alternate" href="https://web.archive.org/web/20200117210221/android-app://com.medium.reader/https/medium.com/p/7dea9caeb590"/><script data-rh="true" type="application/ld+json">{"@context":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttp:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*I26BDuv0_N07S2JD_PZYWA.jpeg"],"url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","dateCreated":"2020-01-17T20:28:51.976Z","datePublished":"2020-01-17T20:28:51.976Z","dateModified":"2020-01-17T20:47:26.957Z","headline":"OpenOCD on Raspberry Pi: Better with SWD on SPI","name":"OpenOCD on Raspberry Pi: Better with SWD on SPI","description":"The setup that we see above… Debugging nRF52 with a Raspberry Pi running VSCode and OpenOCD… Was impossible just a week ago! OpenOCD connects to nRF52 for flashing and debugging by running Arm’s SWD…","identifier":"7dea9caeb590","keywords":["Lite:true","Tag:Raspberry Pi","Tag:Spi","Tag:Nrf52","Tag:Openocd","Tag:Internet of Things","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"Lup Yuen Lee 李立源","url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee"},"creator":["Lup Yuen Lee 李立源"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmiro.medium.com\u002Fmax\u002F616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590"}</script><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://web.archive.org/web/20200117210221/https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://web.archive.org/web/20200117210221/https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="454" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(0, 0, 0, 0.84)}.r{display:block}.s{position:fixed}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ai{max-width:1192px}.aj{min-width:0}.ak{width:100%}.al{height:65px}.ao{flex:1 0 auto}.ap{display:none}.ar{flex:0 0 auto}.as{visibility:hidden}.at{color:inherit}.au{fill:inherit}.av{font-size:inherit}.aw{border:inherit}.ax{font-family:inherit}.ay{letter-spacing:inherit}.az{font-weight:inherit}.ba{padding:0}.bb{margin:0}.bc:hover{cursor:pointer}.bd:hover{color:rgba(0, 0, 0, 0.9)}.be:hover{fill:rgba(0, 0, 0, 0.9)}.bf:focus{outline:none}.bg:disabled{cursor:default}.bh:disabled{color:rgba(0, 0, 0, 0.54)}.bi:disabled{fill:rgba(0, 0, 0, 0.54)}.bj{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.bk{font-style:normal}.bl{line-height:20px}.bm{font-size:15.8px}.bn{letter-spacing:0px}.bo{color:rgba(0, 0, 0, 0.54)}.bp{fill:rgba(0, 0, 0, 0.54)}.bq{margin-left:16px}.br{color:rgba(2, 158, 116, 1)}.bs{fill:rgba(3, 168, 124, 1)}.bt:hover{color:rgba(1, 143, 105, 1)}.bu:hover{fill:rgba(2, 158, 116, 1)}.bv:disabled{color:rgba(3, 168, 124, 0.5)}.bw:disabled{fill:rgba(3, 168, 124, 0.5)}.bx{padding:8px 16px}.by{background:0}.bz{border-color:rgba(3, 168, 124, 1)}.ca:hover{border-color:rgba(2, 158, 116, 1)}.cb{border-radius:4px}.cc{border-width:1px}.cd{border-style:solid}.ce{box-sizing:border-box}.cf{display:inline-block}.cg{text-decoration:none}.ch{margin-bottom:0px}.cj{padding-left:24px}.ck{padding-right:24px}.cl{margin-left:auto}.cm{margin-right:auto}.cn{max-width:728px}.co{flex-direction:column}.cp{position:absolute}.cq{top:calc(100vh + 100px)}.cr{bottom:calc(100vh + 100px)}.cs{width:10px}.ct{pointer-events:none}.cu{word-break:break-word}.cv{word-wrap:break-word}.cw:after{display:block}.cx:after{content:""}.cy:after{clear:both}.cz{clear:both}.da{margin-top:0px}.db{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.dc{cursor:zoom-in}.dd{position:relative}.de{z-index:auto}.df{opacity:0}.dg{transition:opacity 100ms 400ms}.dh{height:100%}.di{overflow:hidden}.dj{will-change:transform}.dk{transform:translateZ(0)}.dl{margin:auto}.dm{background-color:rgba(0, 0, 0, 0.05)}.dn{padding-bottom:75%}.do{filter:blur(20px)}.dp{transform:scale(1.1)}.dq{visibility:visible}.dr{background:rgba(255, 255, 255, 1)}.ds{font-size:16px}.dt{line-height:1.4}.du{margin-top:10px}.dv{text-align:center}.dy{font-weight:300}.dz{max-width:680px}.ea{line-height:1.23}.eb{letter-spacing:0}.ec{color:rgba(0, 0, 0, 0.84)}.ed{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.eo{margin-bottom:-0.27em}.eu{margin-top:32px}.ev{justify-content:space-between}.ez{width:48px}.fa{height:48px}.fb{flex-direction:row}.fc{width:calc(100% + 25px)}.fd{height:calc(100% + 25px)}.fe{top:50%}.ff{left:50%}.fg{transform:translateX(-50%) translateY(-50%)}.fh{border-radius:50%}.fi{margin-left:12px}.fj{margin-bottom:2px}.fl{max-height:20px}.fm{text-overflow:ellipsis}.fn{display:-webkit-box}.fo{-webkit-line-clamp:1}.fp{-webkit-box-orient:vertical}.fq:hover{text-decoration:underline}.fr{margin-left:8px}.fs{padding:0px 8px}.ft{border-color:rgba(0, 0, 0, 0.54)}.fu:hover{color:rgba(0, 0, 0, 0.97)}.fv:hover{fill:rgba(0, 0, 0, 0.97)}.fw:hover{border-color:rgba(0, 0, 0, 0.84)}.fx:disabled{fill:rgba(0, 0, 0, 0.76)}.fy:disabled{border-color:rgba(0, 0, 0, 0.2)}.fz:disabled{cursor:inherit}.ga:disabled:hover{color:rgba(0, 0, 0, 0.54)}.gb:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.gc:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.gd{line-height:18px}.ge{font-size:15px}.gf{align-items:flex-end}.gn{padding-right:8px}.go{margin-right:-6px}.gp{line-height:1.58}.gq{letter-spacing:-0.004em}.gr{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.hc{margin-bottom:-0.46em}.hd{font-style:italic}.he{background-repeat:repeat-x}.hf{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.hg{background-size:1px 1px}.hh{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.hi{font-family:medium-content-slab-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.hj{font-size:28px}.hk{border:none}.hl{margin-top:30px}.hm:before{content:"..."}.hn:before{letter-spacing:0.6em}.ho:before{text-indent:0.6em}.hp:before{font-style:italic}.hq:before{line-height:1.4}.hr{line-height:1.12}.hs{letter-spacing:-0.022em}.ht{font-weight:600}.ic{margin-bottom:-0.28em}.in{padding-bottom:10.809342748506246%}.io{font-weight:700}.ip{padding:2px 4px}.iq{font-size:75%}.ir> strong{font-family:inherit}.is{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.it{max-width:725px}.iu{padding-bottom:18.482758620689655%}.iv{padding-bottom:9.07849829351536%}.iw{max-width:569px}.ix{padding-bottom:23.374340949033392%}.iy{padding-bottom:NaN%}.iz{max-width:920px}.ja{padding-bottom:43.15217391304348%}.jb{padding-bottom:17.781402936378466%}.jc{padding-bottom:10.803474484256242%}.jd{max-width:647px}.je{padding-bottom:20.556414219474497%}.jf{max-width:507px}.jg{padding-bottom:26.035502958579883%}.jh{padding-bottom:10.007581501137226%}.ji{max-width:407px}.jj{padding-bottom:32.43243243243243%}.jk{max-width:743px}.jl{padding-bottom:17.765814266487215%}.jm{padding:20px}.jn{background:rgba(0, 0, 0, 0.05)}.jo{overflow-x:auto}.jp{line-height:1.18}.jq{margin-top:-0.09em}.jr{margin-bottom:-0.09em}.js{white-space:pre-wrap}.jt{list-style-type:decimal}.ju{margin-left:30px}.jv{padding-left:0px}.kb{max-width:1061px}.kc{padding-bottom:74.26955702167767%}.kd{padding-bottom:13.040712468193385%}.ke{max-width:866px}.kf{padding-bottom:24.595842956120094%}.kg{max-width:811px}.kh{padding-bottom:33.66214549938348%}.kq{max-width:1542px}.kr{padding-bottom:5px}.ks{padding-top:5px}.kt{padding-bottom:26.977950713359274%}.ku{max-width:1576px}.kv{padding-bottom:29.314720812182742%}.lb{box-shadow:0 1px 4px rgba(0, 0, 0, 0.1), inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.lc{max-height:40px}.ld{-webkit-line-clamp:2}.le{padding:0px}.lf{padding:16px 20px}.lg{flex:1 1 auto}.li{font-size:18px}.lj{margin-top:8px}.lk{margin-top:12px}.ll{width:160px}.lm{background-image:url(https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/320/0*8sStp5l0sA1eWFQY)}.ln{background-origin:border-box}.lo{background-size:cover}.lp{height:167px}.lq{background-position:50% 50%}.lr{max-width:100%}.ls{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.lt{list-style-type:disc}.lu{will-change:opacity}.lv{width:188px}.lw{transform:translateX(406px)}.lx{top:calc(65px + 54px + 14px)}.ma{top:calc(65px + 54px + 40px)}.mc{width:131px}.md{padding-top:28px}.me{margin-bottom:19px}.mf{margin-left:-5px}.mg{margin-right:5px}.mh{outline:0}.mi{border:0}.mj{user-select:none}.mk{cursor:pointer}.ml> svg{pointer-events:none}.mm:active{border-style:none}.mn{-webkit-user-select:none}.mo{fill:rgba(0, 0, 0, 0.76)}.mp:focus{fill:rgba(0, 0, 0, 0.54)}.mq:hover{fill:rgba(0, 0, 0, 0.54)}.mr{margin-top:5px}.ms button{text-align:left}.mt{margin-top:40px}.mu{flex-wrap:wrap}.mv{margin-top:25px}.mw{list-style-type:none}.mx{margin-right:8px}.my{margin-bottom:8px}.mz{border-radius:3px}.na{padding:5px 10px}.nb{line-height:22px}.nc{margin-top:15px}.nd{margin-right:16px}.ne{border:1px solid rgba(0, 0, 0, 0.1)}.nf{height:60px}.ng{width:60px}.nt:hover{border-color:rgba(0, 0, 0, 0.54)}.nu:active{border-style:solid}.nv{z-index:2}.nx{padding-top:32px}.ny{border-top:1px solid rgba(0, 0, 0, 0.1)}.nz{margin-bottom:25px}.oa{margin-bottom:32px}.ob{min-height:80px}.og{width:80px}.oh{height:80px}.oi{padding-left:102px}.ok{text-transform:uppercase}.ol{letter-spacing:0.05em}.om{margin-bottom:6px}.on{line-height:36px}.oo{padding:4px 12px}.op{max-width:555px}.oq{max-width:450px}.or{line-height:24px}.ot{padding-top:25px}.ou{color:rgba(0, 0, 0, 0.76)}.ov{opacity:1}.ow{border:1px solid rgba(3, 168, 124, 1)}.ox{margin-top:64px}.oy{background-color:rgba(0, 0, 0, 0.02)}.oz{padding:60px 0}.pa{background-color:rgba(0, 0, 0, 0.9)}.pr{padding-bottom:48px}.ps{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.pt{margin:0 -12px}.pu{margin:0 12px}.pv{flex:1 1 0}.pw{padding-bottom:12px}.px:hover{color:rgba(255, 255, 255, 0.99)}.py:hover{fill:rgba(255, 255, 255, 0.99)}.pz:disabled{color:rgba(255, 255, 255, 0.7)}.qa:disabled{fill:rgba(255, 255, 255, 0.7)}.qb{color:rgba(255, 255, 255, 0.98)}.qc{fill:rgba(255, 255, 255, 0.98)}.qd{text-align:inherit}.qe{font-size:21.6px}.qf{letter-spacing:-0.32px}.qg{color:rgba(255, 255, 255, 0.7)}.qh{fill:rgba(255, 255, 255, 0.7)}.qi{text-decoration:underline}.qj{padding-bottom:8px}.qk{padding-top:8px}.ql{width:200px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ah{margin:0 64px}.em{font-size:40px}.en{margin-top:0.78em}.et{line-height:48px}.gm{margin-left:30px}.ha{font-size:21px}.hb{margin-top:2em}.ia{font-size:34px}.ib{margin-top:1.25em}.ih{margin-top:0.86em}.im{margin-top:56px}.ka{margin-top:1.05em}.kp{max-width:1192px}.la{margin-top:32px}.po{padding-left:64px}.pp{padding-right:64px}.pq{max-width:1320px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.dw{margin-left:auto}.dx{text-align:center}.gl{margin-left:30px}.pl{padding-left:64px}.pm{padding-right:64px}.pn{max-width:1080px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gk{margin-left:30px}.pi{padding-left:48px}.pj{padding-right:48px}.pk{max-width:904px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.am{height:56px}.an{display:flex}.aq{display:block}.ci{margin-bottom:0px}.ex{margin-top:32px}.ey{flex-direction:column-reverse}.gi{margin-bottom:30px}.gj{margin-left:0px}.lh{padding:10px 12px 10px}.oc{margin-bottom:24px}.od{align-items:center}.oe{width:102px}.of{position:relative}.oj{padding-left:0}.os{margin-top:24px}.pb{padding:32px 0}.pf{padding-left:24px}.pg{padding-right:24px}.ph{max-width:728px}.qm{width:140px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ac{margin:0 24px}.ee{font-size:30px}.ef{margin-top:0.72em}.ep{line-height:40px}.ew{margin-top:32px}.fk{margin-bottom:0px}.gg{margin-bottom:30px}.gh{margin-left:0px}.gs{font-size:18px}.gt{margin-top:1.56em}.hu{margin-top:0.93em}.id{margin-top:0.67em}.ii{margin-top:40px}.jw{margin-top:1.34em}.ki{margin:0}.kj{max-width:100%}.kw{margin-top:24px}.pc{padding-left:24px}.pd{padding-right:24px}.pe{max-width:552px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ag{margin:0 64px}.ek{font-size:40px}.el{margin-top:0.78em}.es{line-height:48px}.gy{font-size:21px}.gz{margin-top:2em}.hy{font-size:34px}.hz{margin-top:1.25em}.ig{margin-top:0.86em}.il{margin-top:56px}.jz{margin-top:1.05em}.ko{max-width:1192px}.kz{margin-top:32px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.af{margin:0 48px}.ei{font-size:40px}.ej{margin-top:0.78em}.er{line-height:48px}.gw{font-size:21px}.gx{margin-top:2em}.hw{font-size:34px}.hx{margin-top:1.25em}.if{margin-top:0.86em}.ik{margin-top:56px}.jy{margin-top:1.05em}.km{margin:0}.kn{max-width:100%}.ky{margin-top:32px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ae{margin:0 24px}.eg{font-size:30px}.eh{margin-top:0.72em}.eq{line-height:40px}.gu{font-size:18px}.gv{margin-top:1.56em}.hv{margin-top:0.93em}.ie{margin-top:0.67em}.ij{margin-top:40px}.jx{margin-top:1.34em}.kk{margin:0}.kl{max-width:100%}.kx{margin-top:24px}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="print">.ab{display:none}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.y{transition:transform 300ms ease}.z{will-change:transform}.ly{transition:opacity 200ms}.nh{transition:border-color 150ms ease}.ni::before{background:
      radial-gradient(circle, rgba(0, 0, 0, 0.84) 60%, transparent 70%)
    }.nj::before{border-radius:50%}.nk::before{content:""}.nl::before{display:block}.nm::before{z-index:0}.nn::before{left:0}.no::before{height:100%}.np::before{position:absolute}.nq::before{top:0}.nr::before{width:100%}.ns:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.nw{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (max-width: 1230px)">.lz{display:none}</style><style type="text/css" data-fela-rehydration="454" data-fela-type="RULE" media="all and (max-width: 1198px)">.mb{display:none}</style></head><body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:110px;padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php"
             title="Sign In"
             id="wm-sign-in"
          >
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share">
          <a href="/web/20200117210221/http://web.archive.org/screenshot/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590"
             id="wm-screenshot"
             title="screenshot">
            <span class="wm-icon-screen-shot"></span>
          </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20200117210221/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20200117210221/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20200117210221" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap">Dec</td>
		  <td class="c" id="displayMonthEl" title="You are here: 21:02:21 Jan 17, 2020">JAN</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210206054524/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" title="06 Feb 2021"><strong>Feb</strong></a></td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><img src="/_static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" /></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 21:02:21 Jan 17, 2020">17</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210206054524/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" title="05:45:24 Feb 06, 2021"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap">2019</td>
		  <td class="c" id="displayYearEl" title="You are here: 21:02:21 Jan 17, 2020">2020</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210206054524/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" title="06 Feb 2021"><strong>2021</strong></a></td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20200117210221*/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" title="See a list of every capture for this URL">4 captures</a>
	      <div class="r" title="Timespan for captures of this URL">17 Jan 2020 - 07 Feb 2021</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="650" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/webwidecrawl" target="_new"><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/liveweb)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/liveweb" target="_new"><span class="wm-title">Live Web Proxy Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Content crawled via the <a href="http://archive.org/web/web.php">Wayback Machine</a> Live Proxy mostly by the Save Page Now feature on web.archive.org.
<br><br>
Liveweb proxy is a component of Internet Archive’s wayback machine project. The liveweb proxy captures the content of a web page in real time, archives it into a ARC or WARC file and returns the ARC/WARC record back to the wayback machine to process. The recorded ARC/WARC file becomes part of the wayback machine in due course of time.
<br>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20200117210221/https%3A//medium.com/%2540ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><script type="text/javascript">
__wm.bt(650,27,25,2,"web","https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","20200117210221",1996,"/_static/",["/_static/css/banner-styles.css?v=bsmaklHF","/_static/css/iconochive.css?v=qtvMKcIJ"]);
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT --><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y z ab"><div class="branch-journeys-top"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="al n o am an"><div class="r ao w"><div class="n o"><a aria-label="Homepage" rel="noopener" href="/web/20200117210221/https://medium.com/?source=post_page-----7dea9caeb590----------------------"><div class="ap g"><svg height="22" width="112" viewbox="0 0 111.5 22" class="q"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></div><div class="r aq"><svg width="35" height="35" viewbox="5 5 35 35" class="q"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></div></a></div></div><div class="r ar w"><div class="n o"><div class="n g"><div class="as" id="lo-post-page-navbar-upsell-button"><div><a href="https://web.archive.org/web/20200117210221/https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><span class="bj b bk bl bm bn r bo bp">Become a member</span></a></div></div><div class="as" id="lo-post-page-navbar-sign-in-link"><div class="bq r"><span class="bj b bk bl bm bn r bo bp"><a href="https://web.archive.org/web/20200117210221/https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590&amp;source=post_page-----7dea9caeb590---------------------nav_reg-" class="br bs av aw ax ay az ba bb bc bt bu bf bg bv bw" rel="noopener">Sign in</a></span></div></div></div><div class="as" id="lo-post-page-navbar-get-started-button"><div class="bq r"><button class="bx by br bs bz bt bu ca bc cb bj b bk bl bm bn cc cd ce cf cg bf">Get started</button></div></div></div></div></div></div></div></div></nav><div class="ch al r ci am"></div><article><section class="cj ck cl cm ak cn ce n co"></section><span class="r"></span><div><div class="cp u cq cr cs ct"></div><section class="cu cv cw cx cy"><div class="cz ak"><figure class="da cz ak paragraph-image"><div class="db dc dd de ak"><div class="dl r dd dm"><div class="dn r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*I26BDuv0_N07S2JD_PZYWA.jpeg?q=20" width="4032" height="3024" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="4032" height="3024" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/8064/1*I26BDuv0_N07S2JD_PZYWA.jpeg" width="4032" height="3024" role="presentation"/></noscript></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Debugging nRF52 with a Raspberry Pi 4 running VSCode and OpenOCD with SWD over SPI at 31 MHz</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><div><div id="2f47" class="ea eb ec bk ed b ee ef eg eh ei ej ek el em en eo"><h1 class="ed b ee ep eg eq ei er ek es em et ec">OpenOCD on Raspberry Pi: Better with SWD on SPI</h1></div><div class="eu"><div class="n ev ew ex ey"><div class="o n"><div><a rel="noopener" href="/web/20200117210221/https://medium.com/@ly.lee?source=post_page-----7dea9caeb590----------------------"><div class="dd ez fa"><div class="bs n fb o p cp fc fd fe ff fg ct"><svg width="57" height="57" viewbox="0 0 57 57"><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5 1.2A27.45 27.45 0 0 0 4.06 15.82L3 15.27A28.65 28.65 0 0 1 28.5 0C39.64 0 49.29 6.2 54 15.27l-1.06.55A27.45 27.45 0 0 0 28.5 1.2zM4.06 41.18A27.45 27.45 0 0 0 28.5 55.8a27.45 27.45 0 0 0 24.44-14.62l1.06.55A28.65 28.65 0 0 1 28.5 57 28.65 28.65 0 0 1 3 41.73l1.06-.55z"></path></svg></div><img alt="Lup Yuen Lee 李立源" class="r fh fa ez" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/fit/c/96/96/1*KGohS3sQaUnr58gc0BIfoQ.jpeg" width="48" height="48"/></div></a></div><div class="fi ak r"><div class="n"><div style="flex:1"><span class="bj b bk bl bm bn r ec q"><div class="fj n o fk"><span class="bj dy ds bl di fl fm fn fo fp ec"><a class="at au av aw ax ay az ba bb bc fq bf bg bh bi" rel="noopener" href="/web/20200117210221/https://medium.com/@ly.lee?source=post_page-----7dea9caeb590----------------------">Lup Yuen Lee 李立源</a></span><div class="fr r ar h"><button class="fs ec q by ft fu fv fw bc bh fx fy fz ga gb gc cb bj b bk gd ge bn cc cd ce cf cg bf">Follow</button></div></div></span></div></div><span class="bj b bk bl bm bn r bo bp"><span class="bj dy ds bl di fl fm fn fo fp bo"><div><a class="at au av aw ax ay az ba bb bc fq bf bg bh bi" rel="noopener" href="/web/20200117210221/https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590?source=post_page-----7dea9caeb590----------------------">Jan 17</a> <!-- -->·<!-- --> <!-- -->12<!-- --> min read</div></span></span></div></div><div class="n gf gg gh gi gj gk gl gm ab"><div class="n o"><div class="gn r ar"><a href="//web.archive.org/web/20200117210221/https://medium.com/p/7dea9caeb590/share/twitter?source=post_actions_header---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="gn r ar"><a href="//web.archive.org/web/20200117210221/https://medium.com/p/7dea9caeb590/share/facebook?source=post_actions_header---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="go r ao"><a href="https://web.archive.org/web/20200117210221/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590&amp;source=post_actions_header--------------------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewbox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div><p id="03ff" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">Sneaky tricks to align stray bits into proper bytes</em></p><p id="8f9a" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The setup that we see above… Debugging nRF52 with a Raspberry Pi running <a href="https://web.archive.org/web/20200117210221/https://code.headmelted.com/" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">VSCode</a> and <a href="https://web.archive.org/web/20200117210221/http://openocd.org/doc/html/About.html#What-is-OpenOCD_003f" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">OpenOCD</a>… <em class="hd">Was impossible just a week ago!</em></p><p id="7df9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">OpenOCD connects to nRF52 for flashing and debugging by running <a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">Arm’s SWD protocol</a> over GPIO <a href="https://web.archive.org/web/20200117210221/https://en.wikipedia.org/wiki/Bit_banging" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">Bit Banging</a>. OpenOCD was sending data to nRF52 one bit at a time… Works fine when OpenOCD is the only task running, <em class="hd">not when it’s sharing the CPU with VSCode and other interactive tasks!</em></p><p id="fb26" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">That’s because multitasking skews the precise timing that’s needed by OpenOCD to send each bit correctly.</p><p id="f9c9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Instead of sending data over GPIO one bit at a time, <em class="hd">what if we could blast out the data over </em><a href="https://web.archive.org/web/20200117210221/https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">Raspberry Pi’s SPI interface</em></a><em class="hd">?</em></p><p id="72df" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">SPI is implemented as a <a href="https://web.archive.org/web/20200117210221/https://github.com/raspberrypi/linux/blob/rpi-3.12.y/drivers/spi/spi-bcm2708.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">kernel mode driver</a> with interrupts, so it runs with high CPU priority. Raspberry Pi’s <a href="https://web.archive.org/web/20200117210221/https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2835/BCM2835-ARM-Peripherals.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">Broadcom microcontroller</a> fully supports Bidirectional SPI with precise clocking and buffering. <em class="hd">Why not use SPI for SWD?</em></p><p id="d4a6" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">This article explains how we did that… By overcoming some interesting bitwise challenges. First let’s learn the SWD protocol…</p></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="d19a" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">SWD Read Operation</h1><p id="b69d" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">For Raspberry Pi to read an SWD Register on nRF52, we perform an SWD Read Operation like this (Raspberry Pi is the host, PineTime/nRF52 is the target)…</p></div></div><div class="cz ak"><figure class="ii ij ik il im cz ak paragraph-image"><div class="dl r dd dm"><div class="in r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*vzRJDQaOchn48p1rU5Gleg.png?q=20" width="1841" height="199" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1841" height="199" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/3682/1*vzRJDQaOchn48p1rU5Gleg.png" width="1841" height="199" role="presentation"/></noscript></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">SWD Read Operation with 2 undefined trailing bits. From <a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0</a></figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="0038" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here we are reading the <strong class="gr io">IDCODE (Identification Code) Register</strong>, which identifies the Arm Debug Interface (<code class="dm ip iq ir is b">0x2ba01477</code> for nRF52). IDCODE is Register #0 (in Read Mode), so we set <code class="dm ip iq ir is b">A2</code> and <code class="dm ip iq ir is b">A3</code> (bits 2 and 3 of the register number) to <code class="dm ip iq ir is b">0</code>.</p><p id="1f2d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Pi → nRF52: 8 bits…</em></strong></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="db dc dd de ak"><div class="cl cm it"><div class="dl r dd dm"><div class="iu r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*f7T3HilgTJ1f4v772LPUjg.png?q=20" width="725" height="134" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="725" height="134" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1450/1*f7T3HilgTJ1f4v772LPUjg.png" width="725" height="134" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From Pi to nRF52</figcaption></figure><p id="57c4" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Pi sends <code class="dm ip iq ir is b">0xA5</code> (least significant bit first) to nRF52. That’s followed by <code class="dm ip iq ir is b">Trn</code>, the Turnaround Bit. This bit gives 1 clock cycle of breathing space whenever we flip the transmission from Pi to nRF52 and back. The value of <code class="dm ip iq ir is b">Trn</code> doesn’t matter.</p><p id="f84f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">nRF52 → Pi: 38 bits (including turnaround)…</em></strong></p></div></div><div class="cz ak"><figure class="ii ij ik il im cz ak paragraph-image"><div class="dl r dd dm"><div class="iv r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*rKTQ1FpshTHYiJ2ojmyowQ.png?q=20" width="1465" height="133" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1465" height="133" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/2930/1*rKTQ1FpshTHYiJ2ojmyowQ.png" width="1465" height="133" role="presentation"/></noscript></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From nRF52 to Pi</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="2fed" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">nRF52 responds with the Acknowledgement <code class="dm ip iq ir is b">100</code> (which means OK). Followed by 32 bits of data (the value of Register IDCODE), a Parity bit, and another Turnaround Bit.</p><p id="b426" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Now let’s see whether Raspberry Pi’s SPI interface will allow us to send and receive this kind of data.</p><p id="ecb9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Missing: 2 bits…</em></strong></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="cl cm iw"><div class="dl r dd dm"><div class="ix r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*jU0y8faClt9ZIU9v27SBjw.png?q=20" width="569" height="133" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="569" height="133" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1138/1*jU0y8faClt9ZIU9v27SBjw.png" width="569" height="133" role="presentation"/></noscript></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From nRF52 to Pi and back</figcaption></figure><p id="4545" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Count the bits for the entire SWD Read Operation (look at the red blocks)… It has 46 bits, which is <em class="hd">2 bits short of 6 whole bytes</em>.</p><p id="730b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Also the <em class="hd">last byte is split across Pi and nRF52</em>… nRF52 sends 5 bits, then Turnaround, then Pi is supposed to send 2 bits from the next read/write operation!</p><p id="c399" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Since Raspberry Pi’s SPI interface can only send and receive whole bytes (not bits)… <em class="hd">We have a problem with the last 2 stray bits!</em></p><p id="55f6" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">nRF52 gets utterly confused after the SWD Read Operation. Only way to fix this? <strong class="gr io">Reset the SWD connection and resynchronise by resending the JTAG-To-SWD Sequence.</strong></p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/f9c5ea7a23dad701b65d7eb9c486b137" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Sending the JTAG-To-SWD Sequence to reset SWD connection. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/swd.h" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/swd.h</a></figcaption></figure><p id="05bd" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Yes our SWD flashing may slow down when we reset the SWD connection after every SWD Read Operation… But we are now running the SWD connection over SPI at a speedy <strong class="gr io">31 MHz</strong>! This compensates for the reset transmission, so the overall SWD flashing is still fast.</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/7512be857515198a9886ce4cab4d6475" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">After every SWD Read Operation, send the JTAG-To-SWD Sequence to reset SWD connection. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="30e6" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Throwaway SWD Read Operation</h1><p id="fb58" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">For SWD to work over SPI, we need to reset the SWD connection after every SWD Read Operation… Just send the JTAG-To-SWD Sequence! But there’s a catch: <em class="hd">We MUST read IDCODE after sending the JTAG-To-SWD Sequence…</em></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="db dc dd de ak"><div class="cl cm iz"><div class="dl r dd dm"><div class="ja r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*ySSy6VmrSZKXhu2CQl87ig.png?q=20" width="920" height="397" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="920" height="397" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1840/1*ySSy6VmrSZKXhu2CQl87ig.png" width="920" height="397" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Resetting the SWD connection. From ARM® Debug Interface v5 Architecture Specification <a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf</a></figcaption></figure><p id="d77e" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">See the problem here? </em>We need to reset after reading a register… <em class="hd">And yet we need to read a register (IDCODE) after resetting!</em></p><p id="c12a" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">The snake eats its own tail! </em>To break the snake, we use a sneaky way to read IDCODE after resetting, the Throwaway Way…</p></div></div><div class="cz ak"><figure class="ii ij ik il im cz ak paragraph-image"><div class="dl r dd dm"><div class="jb r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*4PyuAj8bjDm_SJPv_U3vbA.png?q=20" width="1839" height="327" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1839" height="327" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/3678/1*4PyuAj8bjDm_SJPv_U3vbA.png" width="1839" height="327" role="presentation"/></noscript></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">SWD Read Operation: Normal version (above) and Throwaway version (below). From <a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0</a></figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="a7ab" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Notice that we <em class="hd">slide the entire Read IDCODE Operation two bits to the right</em>… Inserting two null bits in front.</p><p id="2cc8" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">Will nRF52 accept the two null leading bits sent by Pi?</em> Yes because all SWD Read/Write Operations must start with <code class="dm ip iq ir is b">1</code>. So it’s always OK for Pi to send null bits before and after every SWD Read/Write Operation.</p><p id="b4b0" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">For a normal SWD Read Operation (that’s not byte-aligned and hence problematic)…</p><p id="2d5b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Pi → nRF52</em></strong>: 8 bits (<code class="dm ip iq ir is b">A5</code>), followed by…<br/><strong class="gr io"><em class="hd">nRF52 → Pi</em></strong>: 38 bits (Data + Parity + Turnaround)</p><p id="b205" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io">Total 46 bits</strong>, not byte-aligned, no good. For our special Throwaway version with two prepadded null bits…</p><p id="449e" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Pi → nRF52</em></strong>: 48 bits (<code class="dm ip iq ir is b">94 02 00 00 00 00</code>), followed by…<br/><strong class="gr io"><em class="hd">nRF52 → Pi</em></strong>: 0 bits</p><p id="5182" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io">Total 48 bits</strong>, byte-aligned, all good! So the next SWD Read or Write Operation may be sent, perfectly aligned to the byte. (If the next operation is SWD Read, we’ll have to read the register, reset and read IDCODE again)</p><p id="3133" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">But it sounds like Pi is yakking away over the entire SWD Read Operation, not really listening to nRF52 (and getting the value of IDCODE)?</p><p id="0362" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">That’s perfectly fine… We don’t really care about the value of IDCODE anyway. We are only reading IDCODE because Arm said so.</p><p id="758a" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Thus in the SPI implementation of SWD, we see this special Throwaway Read IDCODE (<code class="dm ip iq ir is b">94 02 00 00 00 00</code>) that’s sent after every SWD connection reset in <code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">spi_transmit_resync</a>()</code>. To give sufficient clock cycles for nRF52 to do its job, we insert a null byte before and after the Throwaway Read IDCODE: <code class="dm ip iq ir is b"><strong class="gr io">00</strong> 94 02 00 00 00 00 <strong class="gr io">00</strong></code></p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/02cb00fb124630dce87c9f3e125505c3" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Reset SWD Connection with Throwaway Read IDCODE. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure><p id="7acf" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">What’s the SWD Write ABORT Operation?</em> We’ll learn in a while…</p></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="81ad" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">SWD Write Operation</h1><p id="7a4a" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">For Raspberry Pi to write an SWD Register on nRF52, we perform an SWD Write Operation like this (Raspberry Pi is the host, PineTime/nRF52 is the target)…</p></div></div><div class="cz ak"><figure class="ii ij ik il im cz ak paragraph-image"><div class="dl r dd dm"><div class="jc r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*49lUAkfSVR0aATyuz86N8Q.png?q=20" width="1842" height="199" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1842" height="199" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/3684/1*49lUAkfSVR0aATyuz86N8Q.png" width="1842" height="199" role="presentation"/></noscript></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">SWD Write Operation padded with 2 null bits. From <a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0</a></figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="31fa" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here we are writing the value <code class="dm ip iq ir is b">0x1E</code> to the <strong class="gr io">ABORT Register</strong>. Whenever a SWD protocol error occurs during transmission (e.g. misaligned bits), we need to clear the error by writing to the ABORT Register.</p><p id="91be" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">ABORT is Register #0 (in Write Mode), so we set <code class="dm ip iq ir is b">A2</code> and <code class="dm ip iq ir is b">A3</code> (bits 2 and 3 of the register number) to <code class="dm ip iq ir is b">0</code>.</p><p id="cb3f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Pi → nRF52: 8 bits…</em></strong></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="cl cm jd"><div class="dl r dd dm"><div class="je r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*UJjRRCHXBpCrPyy9wtneMg.png?q=20" width="647" height="133" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="647" height="133" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1294/1*UJjRRCHXBpCrPyy9wtneMg.png" width="647" height="133" role="presentation"/></noscript></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From Pi to nRF52</figcaption></figure><p id="78a0" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Pi sends <code class="dm ip iq ir is b">0x81</code> (least significant bit first) to nRF52. That’s followed by <code class="dm ip iq ir is b">Trn</code>, the Turnaround Bit.</p><p id="9139" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">nRF52 → Pi: 5 bits (including turnaround)…</em></strong></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="cl cm jf"><div class="dl r dd dm"><div class="jg r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*2OHTPpxD-_Qo5bdsWkWt6A.png?q=20" width="507" height="132" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="507" height="132" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1014/1*2OHTPpxD-_Qo5bdsWkWt6A.png" width="507" height="132" role="presentation"/></noscript></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From nRF52 to Pi</figcaption></figure><p id="59cf" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">nRF52 responds with the Acknowledgement <code class="dm ip iq ir is b">100</code> (which means OK). and another Turnaround Bit.</p><p id="a1fd" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Pi → nRF52: 33 bits…</em></strong></p></div></div><div class="cz ak"><figure class="ii ij ik il im cz ak paragraph-image"><div class="dl r dd dm"><div class="jh r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*rQaYOneDe4H71HiBuw6ClQ.png?q=20" width="1319" height="132" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1319" height="132" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/2638/1*rQaYOneDe4H71HiBuw6ClQ.png" width="1319" height="132" role="presentation"/></noscript></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From Pi to nRF52</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="c3aa" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Pi sends 32 bits of data (the value to be written to Register ABORT) and a Parity bit.</p><p id="b3c1" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">Pi → nRF52: 2 bits (padding for byte alignment)…</em></strong></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="cl cm ji"><div class="dl r dd dm"><div class="jj r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*RmZomPH4xTbSRHsvy0TUYg.png?q=20" width="407" height="132" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="407" height="132" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/814/1*RmZomPH4xTbSRHsvy0TUYg.png" width="407" height="132" role="presentation"/></noscript></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From Pi to nRF52</figcaption></figure><p id="ea2d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">For our SPI implementation, Pi sends an extra 2 null bits to make the entire operation byte-aligned: 6 whole SPI bytes. <em class="hd">(Remember: It’s OK to insert extra null bits before and after SWD Read/Write Operations)</em></p><p id="c4c9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">No misaligned bits for SWD Write Operations… <em class="hd">Phew!</em></p></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="a93c" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">A Convenient Write Lie</h1><p id="5a2c" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc"><em class="hd">Will SWD Write Operations work over SPI?</em> SWD Write Operations are always byte-aligned, because we padded 2 null bits. But we have a funny Turnaround situation in the second byte of the SWD Write Operation…</p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="db dc dd de ak"><div class="cl cm jk"><div class="dl r dd dm"><div class="jl r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*rDDxoGZkjko8cQqQVAYeXw.png?q=20" width="743" height="132" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="743" height="132" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1486/1*rDDxoGZkjko8cQqQVAYeXw.png" width="743" height="132" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From Pi to nRF52 and back</figcaption></figure><p id="69ee" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">There are Two Turnarounds in the same byte!</em></p><p id="d467" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">nRF52 → Pi:</em></strong> 3 Acknowledgement Bits + 2 Turnaround Bits, followed by…<em class="hd"><br/></em><strong class="gr io"><em class="hd">Pi → nRF52:</em></strong><em class="hd"> </em>3 Data Bits</p><p id="72be" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">We can’t flip the direction of transmission within a single SPI byte transfer. <em class="hd">So this fails for SPI!</em> Thankfully we have another sneaky solution for this problematic second byte…</p><p id="4c36" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr io"><em class="hd">nRF52 → Pi:</em></strong> 0 bits, followed by…<em class="hd"><br/></em><strong class="gr io"><em class="hd">Pi → nRF52:</em></strong><em class="hd"> </em>3 Acknowledgement Bits + 2 Turnaround Bits + 3 Data Bits</p><p id="155a" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">Look familiar?</em> This is the same trick as the Throwaway SWD Read Operation… <em class="hd">We now throw away the 3 Acknowledgement Bits sent by nRF52 to Pi!</em></p><p id="bde1" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Instead of Pi receiving the 3 Acknowledgement Bits from nRF52, <em class="hd">Pi now sends 3 bits to nRF52</em>. Doesn’t matter whether they are <code class="dm ip iq ir is b">0</code> or <code class="dm ip iq ir is b">1</code>, as long as it takes 3 clock cycles.</p><p id="2c7d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">But that means we won’t know whether the Write Acknowledgement is OK (<code class="dm ip iq ir is b">100</code>)!</p><p id="a5f4" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">Think about it… Is this Write Acknowledgement really useful?</em> It happens <em class="hd">before</em> the data is written! Most of the time it’s used to indicate that the Register ID (in <code class="dm ip iq ir is b">A2</code> and <code class="dm ip iq ir is b">A3</code>) is valid.</p><p id="101c" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Thus we take a calculated risk and assume that the <strong class="gr io">SWD Write Acknowledgement is always OK</strong>. Our SPI code always lies and returns <code class="dm ip iq ir is b">100</code> to OpenOCD.</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/98ed286f829bcea91406f6aa3cd79b48" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Our SPI code always returns OK to OpenOCD for SWD Write Acknowledgement. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure><p id="eb0b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">Will this cause problems when flashing the ROM of nRF52? Since we’re not checking the SWD Write Acknowledgement?</em></p><p id="749e" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here’s how we mitigate the risk of write failures: <strong class="gr io">We always read and verify the ROM contents after flashing</strong>, like in <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/pinetime-rust-mynewt/blob/master/scripts/nrf52/flash-app.ocd" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">this OpenOCD script</a>…</p><pre class="ii ij ik il im jm jn jo"><span id="dd35" class="jp hs ec bk is b ds jq jr r js">program bin/targets/nrf52_my_sensor/app/apps/my_sensor_app/my_sensor_app.img verify 0x00008000</span></pre><p id="1afa" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">When we throw away the SWD Write Acknowledgement, we eliminate all Turnarounds. Our SWD Write Operation becomes really simple… <em class="hd">Just send 8 whole bytes from Pi to nRF52!</em></p><p id="11ed" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">Perfect for implementing SWD over SPI!</em></p><p id="ff0e" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Hence to write value <code class="dm ip iq ir is b">0x1E</code> to the ABORT Register, Pi only needs to blast out 6 bytes over SPI to nRF52: <code class="dm ip iq ir is b">81 d3 03 00 00 00</code></p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/659648b29c54eebe853501321850e5f9" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Sending 8 whole bytes from Pi to nRF52 for an SPI Write Operation. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="81eb" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Clear the Sticky Error Bits</h1><p id="6561" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">We added debug logs to the existing OpenOCD code in <code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c#L414-L464" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">bitbang.c</a></code> to compare the old GPIO and new SPI implementations of the SWD protocol.</p><p id="b1f6" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Remember we said earlier that every SWD Read Operation will be followed by an SWD connection reset that transmits two byte sequences to nRF52…</p><ol class=""><li id="3467" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc jt ju jv">JTAG-To-SWD Sequence</li><li id="01a6" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc jt ju jv">Read IDCODE Sequence, prepadded with two null bits</li></ol><p id="3f64" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here’s what happens when we run OpenOCD with that setup…</p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="db dc dd de ak"><div class="cl cm kb"><div class="dl r dd dm"><div class="kc r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*NaHaYp3UvNfL1ubNdCOpkA.png?q=20" width="1061" height="788" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1061" height="788" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/2122/1*NaHaYp3UvNfL1ubNdCOpkA.png" width="1061" height="788" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Comparing the logs from SWD over GPIO (left) with SWD over SPI (right). From <a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=900511571" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=900511571</a></figcaption></figure><p id="27f8" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Both the GPIO and SPI versions of OpenOCD are reading and writing to the same nRF52 registers: IDCODE, SELECT AP, CTRL/STAT. But the value of the Control/Status Register (CTRL/STAT) is different for SPI: <code class="dm ip iq ir is b">f0000003</code>.</p><p id="6270" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">What’s <code class="dm ip iq ir is b">f0000003</code>? Let’s key that <a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=2077834467" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">into this spreadsheet</a> to decode the Control/Status value…</p></div></div><div class="cz ak"><figure class="ii ij ik il im cz ak paragraph-image"><div class="db dc dd de ak"><div class="dl r dd dm"><div class="kd r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*nXTgKPljszZxZmfxDXlVEQ.png?q=20" width="1572" height="205" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1572" height="205" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/3144/1*nXTgKPljszZxZmfxDXlVEQ.png" width="1572" height="205" role="presentation"/></noscript></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Control/Status Register Decoder: <a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=2077834467" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=2077834467</a></figcaption></figure></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="a209" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">What’s the difference between the GPIO and SPI values for the Control/Status Register?</em> SPI is experiencing the <strong class="gr io">STICKYORUN</strong> error…</p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="db dc dd de ak"><div class="cl cm ke"><div class="dl r dd dm"><div class="kf r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*e_ynAgJbcP4u8I8SOQytUA.png?q=20" width="866" height="213" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="866" height="213" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1732/1*e_ynAgJbcP4u8I8SOQytUA.png" width="866" height="213" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">STICKYORUN flag in the Control/Status Register. From ARM® Debug Interface v5 Architecture Specification <a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf</a></figcaption></figure><p id="528b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">This means that nRF52 has <strong class="gr io">detected some overrun garbage on the SWD connection</strong>… <em class="hd">Must be due to our misaligned SWD Read Operations!</em></p><p id="8474" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">This is a “Sticky” error… It sticks there forever until we do something to clear the error status. <strong class="gr io">If we don’t clear the Sticky error status, all SWD operations will fail.</strong></p><figure class="ii ij ik il im cz cl cm paragraph-image"><div class="db dc dd de ak"><div class="cl cm kg"><div class="dl r dd dm"><div class="kh r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*ci4QCcTcbS98B_FotQqMCw.png?q=20" width="811" height="273" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="811" height="273" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/1622/1*ci4QCcTcbS98B_FotQqMCw.png" width="811" height="273" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">ABORT Register. From ARM® Debug Interface v5 Architecture Specification <a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf</a></figcaption></figure><p id="264e" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The solution: We write value <code class="dm ip iq ir is b">0x1E</code> to the ABORT Register. That’s binary <code class="dm ip iq ir is b">11110</code>, which means that we are clearing <em class="hd">all</em> the errors: Overrun Error, Write Data Error, Sticky Error, Sticky Compare Error.</p><p id="b043" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">In the previous section we have learnt how to write value <code class="dm ip iq ir is b">0x1E</code> to the ABORT Register: By blasting out over SPI <code class="dm ip iq ir is b">81 d3 03 00 00 00</code></p><p id="8206" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">When shall we write to the ABORT Register to clear the errors?</em></p><p id="1b5f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Remember that Pi has become extremely negligent to nRF52… <em class="hd">Pi has thrown away so much feedback and acknowledgement from nRF52!</em> We don’t know exactly when nRF52 is having issues. But since…</p><ol class=""><li id="0b29" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc jt ju jv">The errors are caused by the misaligned SWD Read Operation</li><li id="0da2" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc jt ju jv">And we always reset the SWD connection after every SWD Read Operation (except the Throwaway Read IDCODE)…</li></ol><p id="f7cb" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Let’s write to the ABORT Register and <strong class="gr io">clear the errors at every SWD connection reset</strong>.</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/42f36e51a7e025e13dddb9ce07b7d6e9" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Clearing the errors at every SWD connect reset by writing to ABORT. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure><p id="6702" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">With this fix, SWD over SPI works perfectly!</em></p></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="6258" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Inject SPI into OpenOCD Bit Bang</h1><p id="2886" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">We have SWD Read and Write Operations working fine over SPI, and we have forcibly fixed all the SWD errors indirectly caused by SPI. Now let’s inject this SPI code into the OpenOCD code.</p><p id="8ac8" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">OpenOCD calls <code class="dm ip iq ir is b">bitbang_exchange()</code> in <code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c#L414-L464" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">bitbang.c</a></code> whenever it needs to transmit or receive a chunk of bits in a fixed direction. OpenOCD calls <code class="dm ip iq ir is b">bitbang_exchange()</code> two times for every SWD Read, three times for every SWD Write…</p></div></div><div class="cz"><div class="n p"><div class="ki kj kk kl km kn ag ko ah kp aj ak"><figure class="ii ij ik il im cz kr ks paragraph-image"><div class="db dc dd de ak"><div class="cl cm kq"><div class="dl r dd dm"><div class="kt r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*QbftBI6WVn4pCEgCTV-Rlw.png?q=20" width="1542" height="416" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1542" height="416" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/3084/1*QbftBI6WVn4pCEgCTV-Rlw.png" width="1542" height="416" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy"><code class="dm ip iq ir is b">SWD Read: bitbang_exchange()</code> called for two chunks of bits. From <a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf</a></figcaption></figure><figure class="da cz kr ks paragraph-image"><div class="db dc dd de ak"><div class="cl cm ku"><div class="dl r dd dm"><div class="kv r"><div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/60/1*cDrUeL7Xaih_AZ-6LPDIsQ.png?q=20" width="1576" height="462" role="presentation"/></div><img class="df dg cp t u dh ak dr" width="1576" height="462" role="presentation"/><noscript><img class="cp t u dh ak" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/max/3152/1*cDrUeL7Xaih_AZ-6LPDIsQ.png" width="1576" height="462" role="presentation"/></noscript></div></div></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy"><code class="dm ip iq ir is b">SWD Write: bitbang_exchange()</code> called for three chunks of bits. From <a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf</a></figcaption></figure></div></div></div><div class="n p"><div class="ac ae af ag ah dz aj ak"><p id="f7dd" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><code class="dm ip iq ir is b">bitbang_exchange()</code> is called by OpenOCD like this…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/a750ca570ea4253eacb11a57f6b03369" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div></figure><p id="fb07" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here’s the existing code for <code class="dm ip iq ir is b">bitbang_exchange()</code> that transmits and receives chunks of bits over GPIO…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/f7bf6a0ca70f02098fc0f263e5ca2a1c" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c</a></figcaption></figure><p id="f2da" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">And here’s the modification we made for <code class="dm ip iq ir is b">bitbang_exchange()</code> to transmit and receives chunks of bits over SPI…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/4d0c6c346c5307e69229059b946786cc" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c</a></figcaption></figure><p id="0fd4" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Which simply forwards the call to our new function <code class="dm ip iq ir is b">spi_exchange()</code> in <code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">spi.c</a></code>.</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/3ebaa39b41a1cbccc562e54c0dc2a456" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure><p id="3e6b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Because <code class="dm ip iq ir is b">spi_exchange()</code> is called with chunks of bits, we use the <code class="dm ip iq ir is b">offset</code> and <code class="dm ip iq ir is b">bit_cnt</code> parameters to figure out whether this chunk came from an SWD Read or Write Operation, and which chunk in that operation…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/98ed286f829bcea91406f6aa3cd79b48" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">Deducing the chunk by offset and bit_cnt. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/spi.c</a></figcaption></figure><p id="98d9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">(Yeah this chunk handling smells bad… We should inject the SPI code into </em><code class="dm ip iq ir is b">bitbang_swd_read_reg()</code><em class="hd"> and </em><code class="dm ip iq ir is b">bitbang_swd_write_reg()</code><em class="hd"> in </em><code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi/blob/master/src/jtag/drivers/bitbang.c#L414-L464" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">bitbang.c</a></code><em class="hd"> instead)</em></p><p id="b16e" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">In Raspberry Pi, all bytes must be sent over SPI in Most Significant Bit format… But OpenOCD uses Least Significant Bit format to manipulate the bytes. So we need to the reverse the bits like this…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/186cb60d044f92edb1b7c0d40531f491" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div></figure></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="1b10" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">SPI Sandbox</h1><p id="20e2" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">Before implementing SWD over SPI in OpenOCD, I used a simple C program <code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/pi-swd-spi/blob/master/pi-swd-spi.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">pi-swd-spi.c</a></code> to test the individual SWD functions. I hope you’ll do the same when you’re modifying OpenOCD.</p><p id="8f99" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The program tests all the functions we have covered: misaligned SWD reads, padded SWD writes, JTAG-To-SWD reset, Throwaway Read IDCODE, Write ABORT, Read CTRL/STAT, …</p><p id="5bed" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/pi-swd-spi/blob/master/pi-swd-spi.c#L296-L394" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">Here’s the output from the test program</a>…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/758f0754f69c0a5ff0fdfea138f462ca" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div><figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">SWD SPI Test Log. From <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/pi-swd-spi/blob/master/pi-swd-spi.c#L296-L394" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/pi-swd-spi/blob/master/pi-swd-spi.c#L296-L394</a></figcaption></figure></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="bda6" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Build and Test OpenOCD with SPI</h1><p id="a033" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">The modified fork of OpenOCD may be found in this repository…</p><div class="kw kx ky kz la lb"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi" rel="noopener nofollow"><div class="le n ar"><div class="lf n co p lg lh"><h2 class="bj ht li bl ec"><div class="di lc fm fn ld fp">lupyuen/openocd-spi</div></h2><div class="lj r"><h3 class="bj dy ds bl bo"><div class="di lc fm fn ld fp">You can&#x27;t perform that action at this time. You signed in with another tab or window. You signed out in another tab or…</div></h3></div><div class="lk r"><h4 class="bj dy ge bl bo"><div class="di lc fm fn ld fp">github.com</div></h4></div></div><div class="ll r"><div class="lm r ln lo lp ll lq lr ls"></div></div></div></a></div><p id="6b24" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">To build and test on Raspberry Pi…</p><p id="a357" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">1️⃣ Connect PineTime / nRF52 to the SPI port on Raspberry Pi…</p><figure class="ii ij ik il im cz"><div class="dl r dd"><div class="iy r"><iframe src="https://web.archive.org/web/20200117210221if_/https://medium.com/media/ff6891a05d70c0e092241c9d9f5e140a" allowfullscreen="" frameborder="0" height="0" width="0" title="See https://medium.com/@ly.lee/openocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590" class="cp t u dh ak" scrolling="auto"></iframe></div></div></figure><p id="bdc9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">2️⃣ Enable the SPI interface on Raspberry Pi…</p><pre class="ii ij ik il im jm jn jo"><span id="f7f6" class="jp hs ec bk is b ds jq jr r js">sudo raspi-config</span></pre><p id="ad7b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Select <code class="dm ip iq ir is b">Interfacing Options → SPI → Yes</code></p><p id="d671" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">3️⃣ Download and build the modified OpenOCD…</p><pre class="ii ij ik il im jm jn jo"><span id="b44b" class="jp hs ec bk is b ds jq jr r js">git clone <a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/openocd-spi" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">https://github.com/lupyuen/openocd-spi</a><br/>cd openocd-spi<br/>./bootstrap<br/>./configure --enable-sysfsgpio --enable-bcm2835gpio --enable-cmsis-dap<br/>make</span></pre><p id="8eda" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The modified OpenOCD executable is now at <code class="dm ip iq ir is b">openocd-spi/src/openocd</code></p><p id="5c77" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">4️⃣ If you’re using <code class="dm ip iq ir is b">pinetime-rust-mynewt</code> downloaded <a class="at cg he hf hg hh" target="_blank" rel="noopener" href="/web/20200117210221/https://medium.com/@ly.lee/build-and-flash-rust-mynewt-firmware-for-pinetime-smart-watch-5e14259c55?source=friends_link&amp;sk=150b2a73b84144e5ef25b985e65aebe9">from this article</a>…</p><p id="e40b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Edit the OpenOCD scripts located at <code class="dm ip iq ir is b">pinetime-rust-mynewt/scripts/nrf52-pi</code>…</p><p id="a482" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><code class="dm ip iq ir is b">flash-app.sh, flash-boot.sh, flash-unprotect.sh</code></p><p id="52a7" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Change the <code class="dm ip iq ir is b">openocd</code> folder to <code class="dm ip iq ir is b">openocd-spi</code> like this…</p><pre class="ii ij ik il im jm jn jo"><span id="e986" class="jp hs ec bk is b ds jq jr r js">sudo /home/pi/<strong class="is io">openocd-spi</strong>/src/openocd \<br/>    -s /home/pi/<strong class="is io">openocd-spi</strong>/tcl \<br/>    -f scripts/nrf52-pi/swd-pi.ocd \<br/>    -f scripts/nrf52/flash-app.ocd</span></pre><p id="51fd" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Run the scripts to unprotect the flash ROM, flash the bootloader and flash the application via SPI…</p><pre class="ii ij ik il im jm jn jo"><span id="f816" class="jp hs ec bk is b ds jq jr r js">cd ~/pinetime-rust-mynewt<br/>scripts/nrf52-pi/flash-unprotect.sh<br/>scripts/nrf52-pi/flash-boot.sh<br/>scripts/nrf52-pi/flash-app.sh</span></pre><p id="002d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">5️⃣ If you’re not using <code class="dm ip iq ir is b">pinetime-rust-mynewt</code>…</p><p id="1d6f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here’s a sample OpenOCD script and shell script that you may adapt for flashing…</p><p id="48f5" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/pinetime-rust-mynewt/blob/master/scripts/nrf52/flash-boot.ocd" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">flash-boot.ocd</a></code></p><p id="dad4" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><code class="dm ip iq ir is b"><a href="https://web.archive.org/web/20200117210221/https://github.com/lupyuen/pinetime-rust-mynewt/blob/master/scripts/nrf52-pi/flash-boot.sh" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">flash-boot.sh</a></code></p><p id="f709" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">In <code class="dm ip iq ir is b">flash-boot.sh</code>, change <code class="dm ip iq ir is b">/home/pi/openocd-spi</code> to the path of your <code class="dm ip iq ir is b">openocd-spi</code> folder, like <code class="dm ip iq ir is b">/home/pi/openocd-spi</code></p></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="7160" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Bit Banging Is Bad</h1><p id="f168" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc"><a href="https://web.archive.org/web/20200117210221/https://en.wikipedia.org/wiki/Bit_banging" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow">Bit Banging</a> means sending and receiving data one bit at a time… By looping around, waiting and sending one bit, waiting and sending another bit, …</p><p id="c9a9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">When I was teaching IoT with Arduino Uno, I saw plenty of Arduino drivers implemented with Bit Banging. This troubled me because…</p><ol class=""><li id="2b33" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc jt ju jv"><strong class="gr io">Hard to reuse the Bit Banging code on other platforms</strong> (from Arduino to Raspberry Pi, STM32, nRF52, RISC-V, …). The timing needs to be adjusted precisely for every platform.</li><li id="3792" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc jt ju jv"><strong class="gr io">Doesn’t work reliably with Multitasking</strong>, which skews the timing between bits. On a Raspberry Pi graphical desktop, this explains why <strong class="gr io">OpenOCD can’t flash nRF52 reliably with GPIO Bit Banging</strong>… The CPU is just too busy handling interactive tasks.</li><li id="bfda" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc jt ju jv">It’s 2020. <strong class="gr io">Surely our microcontroller supports interrupt-driven, precisely-clocked SPI and I2C interfaces,</strong> like on Raspberry Pi, STM32, nRF52, RISC-V, … (If you’re still using Arduino Uno… <em class="hd">Why???</em>)</li></ol><p id="2456" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here’s my plea to all Embedded Developers: <strong class="gr io">Please stop using Bit Banging!</strong> I hope this article has given you plenty of reasons. <em class="hd">(And this article has wasted your precious time, since you wouldn’t be reading it if OpenOCD were using SPI already)</em></p><p id="0ba3" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">If you’re designing a serial protocol like SWD… <strong class="gr io">Please align the bits to whole bytes!</strong> The SWD protocol was designed with plenty of stray bits <em class="hd">(every read/write operation is 46 bits)</em>, thus Bit Banging was the natural solution for implementing the SWD protocol.</p><p id="af0f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hd">If Arm had slipped in two measly bits and rounded up to 48 bits, we would have been using SWD over SPI, reliably and efficiently, a long time ago!</em></p></div></div></section><hr class="hi dy hj hk hl dv hm hn ho hp hq"/><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah dz aj ak"><h1 id="eb1a" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">References</h1><ul class=""><li id="2003" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc lt ju jv"><a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">Introduction to SWD</em></a></li><li id="6b0b" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc lt ju jv"><a href="https://web.archive.org/web/20200117210221/https://github.com/MarkDing/swd_programing_sram/blob/master/Ref/ARM_debug.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">ARM® Debug Interface v5 Architecture Specification</em></a></li><li id="60ea" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc lt ju jv"><a href="https://web.archive.org/web/20200117210221/https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">Raspberry Pi SPI Hardware</em></a></li><li id="f7ef" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc lt ju jv"><a href="https://web.archive.org/web/20200117210221/https://github.com/raspberrypi/linux/blob/rpi-3.12.y/drivers/spi/spi-bcm2708.c" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">Raspberry Pi SPI Kernel Driver</em></a></li><li id="9a3b" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc lt ju jv"><a href="https://web.archive.org/web/20200117210221/https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2835/BCM2835-ARM-Peripherals.pdf" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">BCM2835 Peripherals Datasheet</em></a></li><li id="dc67" class="gp gq ec bk gr b gs jw gu jx gw jy gy jz ha ka hc lt ju jv"><a href="https://web.archive.org/web/20200117210221/https://docs.google.com/spreadsheets/d/12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg/edit#gid=0" class="at cg he hf hg hh" target="_blank" rel="noopener nofollow"><em class="hd">SWD mapping to SPI bytes</em></a></li></ul></div></div></section></div></article><div class="df ct lu s ak ma ly mb" data-test-id="post-sidebar"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="mc n co"><div class="ct"><div class="md me mf n"><div class="n o"><div class="mg r dd"><a href="https://web.archive.org/web/20200117210221/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590&amp;source=post_sidebar-----7dea9caeb590---------------------clap_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="ba mh mi mj mk ml mm mn mo mp mq"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="mr r"><div class="ms"><h4 class="bj dy ds bl bo"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi">50 </button></h4></div></div></div></div><a href="https://web.archive.org/web/20200117210221/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewbox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="df ct lu s lv ff lw lx ly lz"></div><div><div class="mt cz n co p"><div class="n p"><div class="ac ae af ag ah dz aj ak"><div class="n mu"></div><div class="n o mu"></div><div class="mv r"><ul class="ba bb"><li class="cf mw mx my"><a href="/web/20200117210221/https://medium.com/tag/raspberry-pi" class="mz na cg bo r jn nb a b ge">Raspberry Pi</a></li><li class="cf mw mx my"><a href="/web/20200117210221/https://medium.com/tag/spi" class="mz na cg bo r jn nb a b ge">Spi</a></li><li class="cf mw mx my"><a href="/web/20200117210221/https://medium.com/tag/nrf52" class="mz na cg bo r jn nb a b ge">Nrf52</a></li><li class="cf mw mx my"><a href="/web/20200117210221/https://medium.com/tag/openocd" class="mz na cg bo r jn nb a b ge">Openocd</a></li><li class="cf mw mx my"><a href="/web/20200117210221/https://medium.com/tag/internet-of-things" class="mz na cg bo r jn nb a b ge">Internet of Things</a></li></ul></div><div class="nc n ev ab"><div class="n o"><div class="nd r dd"><a href="https://web.archive.org/web/20200117210221/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590&amp;source=post_actions_footer-----7dea9caeb590---------------------clap_footer-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="c ne fh n o nf dd ng nh ni nj nk nl nm nn no np nq nr ns nt"><div class="ba mh mi mj mk ml nu mn o dr fh n p nv u dh cp t ak mo mp mq nw"><svg width="33" height="33" viewbox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></div></a></div><div class="mr r"><div class="ms"><h4 class="bj dy ds bl ec"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi">50 claps</button></h4></div></div></div><div class="n o"><div class="gn r ar"><a href="//web.archive.org/web/20200117210221/https://medium.com/p/7dea9caeb590/share/twitter?source=post_actions_footer---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="gn r ar"><a href="//web.archive.org/web/20200117210221/https://medium.com/p/7dea9caeb590/share/facebook?source=post_actions_footer---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="gn r ar"><a href="https://web.archive.org/web/20200117210221/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590&amp;source=post_actions_footer--------------------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewbox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div><div class="cf" aria-hidden="true"><div class="r ar"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi"><svg width="25" height="25" viewbox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div><div class="nx ny nz mv r ab"><div class="oa ob r dd"><span class="r oc an od"><div class="r cp oe of"><a rel="noopener" href="/web/20200117210221/https://medium.com/@ly.lee?source=follow_footer--------------------------follow_footer-"><div class="dd og oh"><div class="bs n fb o p cp fc fd fe ff fg ct"><svg width="91" height="91" viewbox="0 0 91 91"><path fill-rule="evenodd" clip-rule="evenodd" d="M45.5 1.4c-17.14 0-32 9.95-39.25 24.5L5 25.28C12.47 10.28 27.8 0 45.5 0S78.53 10.29 86 25.28l-1.25.62C77.5 11.35 62.65 1.4 45.5 1.4zM6.25 65.1c7.25 14.55 22.1 24.5 39.25 24.5 17.14 0 32-9.95 39.25-24.5l1.25.62C78.53 80.72 63.2 91 45.5 91S12.47 80.71 5 65.72l1.25-.62z"></path></svg></div><img alt="Lup Yuen Lee 李立源" class="r fh oh og" src="https://web.archive.org/web/20200117210221im_/https://miro.medium.com/fit/c/160/160/1*KGohS3sQaUnr58gc0BIfoQ.jpeg" width="80" height="80"/></div></a></div><span class="r"><div class="oi r oj"><p class="bj dy ge bl bo ok ol">Written by</p></div><div class="oi om n oj"><div class="ak n o ev"><h2 class="bj ht hj on ec"><a class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener" href="/web/20200117210221/https://medium.com/@ly.lee?source=follow_footer--------------------------follow_footer-">Lup Yuen Lee 李立源</a></h2><div class="r g"><button class="oo ec q by ft fu fv fw bc bh fx fy fz ga gb gc cb bj b bk bl bm bn cc cd ce cf cg bf">Follow</button></div></div></div></span></span><div class="oi op r oj aq"><div class="oq r"><h4 class="bj dy li or bo">Techie and Educator in IoT 物聯網教師</h4></div><div class="ap os aq"><button class="oo ec q by ft fu fv fw bc bh fx fy fz ga gb gc cb bj b bk bl bm bn cc cd ce cf cg bf">Follow</button></div></div></div></div><div class="ot ny r ab"><a href="https://web.archive.org/web/20200117210221/https://medium.com/p/7dea9caeb590/responses/show?source=follow_footer--------------------------follow_footer-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><span class="ou ov mk"><div class="jm ow cb r dv g"><span class="br">Write the first response</span></div></span></a></div></div></div><div class="ox r oy ab"><div class="n p"><div class="ac ae af ag ah ai aj ak"></div></div></div></div></div><div class="oz r pa pb"><section class="cl cm ak ce r pc pd pe pf pg ph pi pj pk pl pm pn po pp pq"><div class="pr ps oa n ev g"><div class="pt n ev"><div class="pu r pv"><div class="pw r"><a href="https://web.archive.org/web/20200117210221/https://medium.com/about?autoplay=1&amp;source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc px py bf bg pz qa" rel="noopener"><h4 class="qb qc qd bj ht bk or qe qf r">Discover <!-- -->Medium</h4></a></div><span class="bj b bk bl bm bn r qg qh">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://web.archive.org/web/20200117210221/https://medium.com/about?autoplay=1&amp;source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc bf bg pz qa qi" rel="noopener">Watch</a></span></div><div class="pu r pv"><div class="qj r"><a href="https://web.archive.org/web/20200117210221/https://medium.com/topics?source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc px py bf bg pz qa" rel="noopener"><h4 class="qb qc qd bj ht bk or qe qf r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="bj b bk bl bm bn r qg qh">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://web.archive.org/web/20200117210221/https://medium.com/topics?source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc bf bg pz qa qi" rel="noopener">Explore</a></span></div><div class="pu r pv"><div class="pw r"><a href="https://web.archive.org/web/20200117210221/https://medium.com/membership?source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc px py bf bg pz qa" rel="noopener"><h4 class="qb qc qd bj ht bk or qe qf r">Become a member</h4></a></div><span class="bj b bk bl bm bn r qg qh">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://web.archive.org/web/20200117210221/https://medium.com/membership?source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc bf bg pz qa qi" rel="noopener">Upgrade</a></span></div></div></div><div class="n o ev"><a class="at au av aw ax ay az ba bb bc px py bf bg pz qa" rel="noopener" href="/web/20200117210221/https://medium.com/?source=post_page-----7dea9caeb590----------------------"><svg height="22" width="112" viewbox="0 0 111.5 22" class="qc"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="bj b bk bl bm bn r qg qh"><div class="qk ql n ev qm an"><a href="https://web.archive.org/web/20200117210221/https://medium.com/about?autoplay=1&amp;source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc fq bf bg pz qa" rel="noopener">About</a><a href="https://web.archive.org/web/20200117210221/https://help.medium.com/?source=post_page-----7dea9caeb590----------------------" class="at au av aw ax ay az ba bb bc fq bf bg pz qa" rel="noopener">Help</a><a class="at au av aw ax ay az ba bb bc fq bf bg pz qa" rel="noopener" href="/web/20200117210221/https://medium.com/policy/9db0094a1e0f?source=post_page-----7dea9caeb590----------------------">Legal</a></div></span></div></section></div></div></div><script src="https://web.archive.org/web/20200117210221js_/https://cdn.optimizely.com/js/16180790160.js"></script><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://web.archive.org/web/20200117210221/https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20200117-011557-850fb66e89","productName":"Medium","publicUrl":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20200117-011557-850fb66e89"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440}},"performanceTags":[]},"debug":{"requestId":"99d98cd4-4944-4be8-bfcd-42b881fa72e5","originalSpanCarrier":{"ot-tracer-spanid":"59788eef776c4a17","ot-tracer-traceid":"092734d175dd77ca","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_1EOW2Mqpzf6K"},"xsrf":""},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hasRenderedBranchBanner":null,"hideGoogleOneTap":false,"branchData":{"loaded":false},"currentLocation":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","host":"medium.com","hostname":"medium.com","susiModal":{"step":null,"operation":"register","reportEventInfo":{"eventName":"","data":{}}}},"client":{"isBot":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":false},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"viewer":null,"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.83","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.84","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.85","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.86","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.87","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.88","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.89","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.90","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.91","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.92","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.93","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.94","typename":"VariantFlag"}],"meterPost({\"postId\":\"7dea9caeb590\",\"postMeteringOptions\":{}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"7dea9caeb590\"})":{"type":"id","generated":false,"id":"Post:7dea9caeb590","typename":"Post"}},"ROOT_QUERY.variantFlags.0":{"name":"add_friction_to_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.3":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.4":{"name":"assign_default_topic_to_posts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.5":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.6":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.7":{"name":"branch_seo_metadata","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.9":{"name":"disable_go_social","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"disable_post_recommended_from_friends_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"enable_android_local_currency","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_auto_tier","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_expanded_feature_chunk_pool","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_filter_by_resend_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_geolocation_stripe_standard","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.35":{"name":"enable_json_logs_trained_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_kbfd_rex","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_kbfd_rex_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_kbfd_rex_daily_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_lite_membership_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagString","value":"new-content"},"ROOT_QUERY.variantFlags.41":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_lite_server_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_lo_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_lo_scroll_away_metabar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_new_pub_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_new_pub_modules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_new_suspended_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_new_three_dot_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_nonmember_reading_list_web","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_popularity_feature","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_post_seo_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_post_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"enable_rito_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.74":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"enable_sign_up_with_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"enable_suggest_account","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"enable_suggest_account_li","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.79":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.81":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.82":{"name":"enable_tribute_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.83":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.83.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.83.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.84":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.84.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.84.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.85":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.85.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.85.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.86":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.86.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.86.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.87":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.87.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.87.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.88":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.88.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.88.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.89":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.89.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.89.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.90":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.90.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.90.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.91":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.91.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.91.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.92":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.92.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.92.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.93":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.93.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.93.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.94":{"name":"use_sendgrid_queue_for_digest_sends","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.94.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.94.valueType":{"__typename":"VariantFlagBoolean","value":true},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:7dea9caeb590":{"__typename":"Post","visibility":"PUBLIC","latestPublishedVersion":"e8188b50d17f","collection":null,"id":"7dea9caeb590","creator":{"type":"id","generated":false,"id":"User:1da08193a324","typename":"User"},"isLocked":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","sequence":null,"mediumUrl":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","canonicalUrl":"","content({\"postMeteringOptions\":{}})":{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}})","typename":"PostContent"},"firstPublishedAt":1579292931976,"isPublished":true,"layerCake":0,"primaryTopic":null,"title":"OpenOCD on Raspberry Pi: Better with SWD on SPI","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":null,"readingTime":11.522641509433962,"readingList":"READING_LIST_NONE","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:raspberry-pi","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:spi","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:nrf52","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:openocd","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:internet-of-things","typename":"Tag"}],"viewerClapCount":0,"clapCount":50,"voterCount":1,"recommenders":[],"responsesCount":0,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":0,"isDistributionAlertDismissed":true,"audioVersionUrl":"","seoTitle":"","socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1579294046370,"previewContent":{"type":"id","generated":true,"id":"$Post:7dea9caeb590.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*I26BDuv0_N07S2JD_PZYWA.jpeg","typename":"ImageMetadata"},"updatedAt":1579294046957,"topics":[],"seoDescription":"","isSuspended":false},"User:1da08193a324":{"id":"1da08193a324","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Lup Yuen Lee 李立源","isFollowing":false,"username":"ly.lee","bio":"Techie and Educator in IoT 物聯網教師","imageId":"1*KGohS3sQaUnr58gc0BIfoQ.jpeg","mediumMemberAt":1571194811000,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":"MisterTechBlog"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel","typename":"RichText"}},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.0":{"name":"cb7b","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.1":{"name":"f4dc","startIndex":9,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.2":{"name":"4a55","startIndex":29,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.3":{"name":"4780","startIndex":47,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.4":{"name":"5e2a","startIndex":65,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.5":{"name":"fb40","startIndex":85,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.6":{"name":"3a66","startIndex":109,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.7":{"name":"5bdd","startIndex":127,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.8":{"name":"7b68","startIndex":132,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.9":{"name":"aeee","startIndex":156,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.10":{"name":"4b84","startIndex":165,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.0","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.1","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.2","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.3","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.4","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.5","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.6","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.7","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.8","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.9","typename":"Section"},{"type":"id","generated":true,"id":"$Post:7dea9caeb590.content({\"postMeteringOptions\":{}}).bodyModel.sections.10","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_75","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_76","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_77","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_78","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_79","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_80","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_81","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_82","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_83","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_84","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_85","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_86","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_87","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_88","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_89","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_90","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_91","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_92","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_93","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_94","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_95","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_96","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_97","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_98","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_99","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_100","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_101","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_102","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_103","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_104","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_105","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_106","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_107","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_108","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_109","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_110","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_111","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_112","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_113","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_114","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_115","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_116","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_117","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_118","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_119","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_120","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_121","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_122","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_123","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_124","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_125","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_126","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_127","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_128","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_129","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_130","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_131","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_132","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_133","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_134","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_135","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_136","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_137","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_138","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_139","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_140","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_141","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_142","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_143","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_144","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_145","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_146","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_147","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_148","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_149","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_150","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_151","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_152","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_153","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_154","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_155","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_156","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_157","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_158","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_159","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_160","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_161","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_162","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_163","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_164","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_165","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_166","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_167","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_168","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_169","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_170","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8188b50d17f_171","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:e8188b50d17f_0":{"id":"e8188b50d17f_0","name":"7e0c","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*I26BDuv0_N07S2JD_PZYWA.jpeg","typename":"ImageMetadata"},"text":"Debugging nRF52 with a Raspberry Pi 4 running VSCode and OpenOCD with SWD over SPI at 31 MHz","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*I26BDuv0_N07S2JD_PZYWA.jpeg":{"id":"1*I26BDuv0_N07S2JD_PZYWA.jpeg","originalHeight":3024,"originalWidth":4032,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_1":{"id":"e8188b50d17f_1","name":"2f47","type":"H3","href":null,"layout":null,"metadata":null,"text":"OpenOCD on Raspberry Pi: Better with SWD on SPI","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_2":{"id":"e8188b50d17f_2","name":"03ff","type":"P","href":null,"layout":null,"metadata":null,"text":"Sneaky tricks to align stray bits into proper bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_2.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_2.markups.0":{"type":"EM","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_3":{"id":"e8188b50d17f_3","name":"8f9a","type":"P","href":null,"layout":null,"metadata":null,"text":"The setup that we see above… Debugging nRF52 with a Raspberry Pi running VSCode and OpenOCD… Was impossible just a week ago!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_3.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_3.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_3.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_3.markups.0":{"type":"A","start":73,"end":79,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fcode.headmelted.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_3.markups.1":{"type":"A","start":84,"end":91,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttp:\u002F\u002Fopenocd.org\u002Fdoc\u002Fhtml\u002FAbout.html#What-is-OpenOCD_003f","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_3.markups.2":{"type":"EM","start":93,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_4":{"id":"e8188b50d17f_4","name":"7df9","type":"P","href":null,"layout":null,"metadata":null,"text":"OpenOCD connects to nRF52 for flashing and debugging by running Arm’s SWD protocol over GPIO Bit Banging. OpenOCD was sending data to nRF52 one bit at a time… Works fine when OpenOCD is the only task running, not when it’s sharing the CPU with VSCode and other interactive tasks!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_4.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_4.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_4.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_4.markups.0":{"type":"A","start":64,"end":82,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_4.markups.1":{"type":"A","start":93,"end":104,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FBit_banging","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_4.markups.2":{"type":"EM","start":209,"end":279,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_5":{"id":"e8188b50d17f_5","name":"fb26","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s because multitasking skews the precise timing that’s needed by OpenOCD to send each bit correctly.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_6":{"id":"e8188b50d17f_6","name":"f9c9","type":"P","href":null,"layout":null,"metadata":null,"text":"Instead of sending data over GPIO one bit at a time, what if we could blast out the data over Raspberry Pi’s SPI interface?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_6.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_6.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_6.markups.0":{"type":"A","start":94,"end":122,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fwww.raspberrypi.org\u002Fdocumentation\u002Fhardware\u002Fraspberrypi\u002Fspi\u002FREADME.md","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_6.markups.1":{"type":"EM","start":53,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_7":{"id":"e8188b50d17f_7","name":"72df","type":"P","href":null,"layout":null,"metadata":null,"text":"SPI is implemented as a kernel mode driver with interrupts, so it runs with high CPU priority. Raspberry Pi’s Broadcom microcontroller fully supports Bidirectional SPI with precise clocking and buffering. Why not use SPI for SWD?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_7.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_7.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_7.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_7.markups.0":{"type":"A","start":24,"end":42,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Fraspberrypi\u002Flinux\u002Fblob\u002Frpi-3.12.y\u002Fdrivers\u002Fspi\u002Fspi-bcm2708.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_7.markups.1":{"type":"A","start":110,"end":134,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fwww.raspberrypi.org\u002Fdocumentation\u002Fhardware\u002Fraspberrypi\u002Fbcm2835\u002FBCM2835-ARM-Peripherals.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_7.markups.2":{"type":"EM","start":205,"end":229,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_8":{"id":"e8188b50d17f_8","name":"d4a6","type":"P","href":null,"layout":null,"metadata":null,"text":"This article explains how we did that… By overcoming some interesting bitwise challenges. First let’s learn the SWD protocol…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_9":{"id":"e8188b50d17f_9","name":"d19a","type":"H3","href":null,"layout":null,"metadata":null,"text":"SWD Read Operation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_10":{"id":"e8188b50d17f_10","name":"b69d","type":"P","href":null,"layout":null,"metadata":null,"text":"For Raspberry Pi to read an SWD Register on nRF52, we perform an SWD Read Operation like this (Raspberry Pi is the host, PineTime\u002FnRF52 is the target)…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_11":{"id":"e8188b50d17f_11","name":"a5c2","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*vzRJDQaOchn48p1rU5Gleg.png","typename":"ImageMetadata"},"text":"SWD Read Operation with 2 undefined trailing bits. From https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_11.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vzRJDQaOchn48p1rU5Gleg.png":{"id":"1*vzRJDQaOchn48p1rU5Gleg.png","originalHeight":199,"originalWidth":1841,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_11.markups.0":{"type":"A","start":56,"end":150,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_12":{"id":"e8188b50d17f_12","name":"0038","type":"P","href":null,"layout":null,"metadata":null,"text":"Here we are reading the IDCODE (Identification Code) Register, which identifies the Arm Debug Interface (0x2ba01477 for nRF52). IDCODE is Register #0 (in Read Mode), so we set A2 and A3 (bits 2 and 3 of the register number) to 0.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_12.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_12.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_12.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_12.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_12.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_12.markups.0":{"type":"CODE","start":105,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_12.markups.1":{"type":"CODE","start":176,"end":178,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_12.markups.2":{"type":"CODE","start":183,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_12.markups.3":{"type":"CODE","start":227,"end":228,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_12.markups.4":{"type":"STRONG","start":24,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_13":{"id":"e8188b50d17f_13","name":"1f2d","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi → nRF52: 8 bits…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_13.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_13.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_13.markups.0":{"type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_13.markups.1":{"type":"EM","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_14":{"id":"e8188b50d17f_14","name":"e1ac","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*f7T3HilgTJ1f4v772LPUjg.png","typename":"ImageMetadata"},"text":"From Pi to nRF52","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*f7T3HilgTJ1f4v772LPUjg.png":{"id":"1*f7T3HilgTJ1f4v772LPUjg.png","originalHeight":134,"originalWidth":725,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_15":{"id":"e8188b50d17f_15","name":"57c4","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi sends 0xA5 (least significant bit first) to nRF52. That’s followed by Trn, the Turnaround Bit. This bit gives 1 clock cycle of breathing space whenever we flip the transmission from Pi to nRF52 and back. The value of Trn doesn’t matter.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_15.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_15.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_15.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_15.markups.0":{"type":"CODE","start":9,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_15.markups.1":{"type":"CODE","start":73,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_15.markups.2":{"type":"CODE","start":220,"end":223,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_16":{"id":"e8188b50d17f_16","name":"f84f","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 → Pi: 38 bits (including turnaround)…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_16.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_16.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_16.markups.0":{"type":"STRONG","start":0,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_16.markups.1":{"type":"EM","start":0,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_17":{"id":"e8188b50d17f_17","name":"77d0","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*rKTQ1FpshTHYiJ2ojmyowQ.png","typename":"ImageMetadata"},"text":"From nRF52 to Pi","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rKTQ1FpshTHYiJ2ojmyowQ.png":{"id":"1*rKTQ1FpshTHYiJ2ojmyowQ.png","originalHeight":133,"originalWidth":1465,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_18":{"id":"e8188b50d17f_18","name":"2fed","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 responds with the Acknowledgement 100 (which means OK). Followed by 32 bits of data (the value of Register IDCODE), a Parity bit, and another Turnaround Bit.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_18.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_18.markups.0":{"type":"CODE","start":40,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_19":{"id":"e8188b50d17f_19","name":"b426","type":"P","href":null,"layout":null,"metadata":null,"text":"Now let’s see whether Raspberry Pi’s SPI interface will allow us to send and receive this kind of data.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_20":{"id":"e8188b50d17f_20","name":"ecb9","type":"P","href":null,"layout":null,"metadata":null,"text":"Missing: 2 bits…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_20.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_20.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_20.markups.0":{"type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_20.markups.1":{"type":"EM","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_21":{"id":"e8188b50d17f_21","name":"3b14","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*jU0y8faClt9ZIU9v27SBjw.png","typename":"ImageMetadata"},"text":"From nRF52 to Pi and back","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jU0y8faClt9ZIU9v27SBjw.png":{"id":"1*jU0y8faClt9ZIU9v27SBjw.png","originalHeight":133,"originalWidth":569,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_22":{"id":"e8188b50d17f_22","name":"4545","type":"P","href":null,"layout":null,"metadata":null,"text":"Count the bits for the entire SWD Read Operation (look at the red blocks)… It has 46 bits, which is 2 bits short of 6 whole bytes.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_22.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_22.markups.0":{"type":"EM","start":100,"end":129,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_23":{"id":"e8188b50d17f_23","name":"730b","type":"P","href":null,"layout":null,"metadata":null,"text":"Also the last byte is split across Pi and nRF52… nRF52 sends 5 bits, then Turnaround, then Pi is supposed to send 2 bits from the next read\u002Fwrite operation!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_23.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_23.markups.0":{"type":"EM","start":9,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_24":{"id":"e8188b50d17f_24","name":"c399","type":"P","href":null,"layout":null,"metadata":null,"text":"Since Raspberry Pi’s SPI interface can only send and receive whole bytes (not bits)… We have a problem with the last 2 stray bits!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_24.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_24.markups.0":{"type":"EM","start":85,"end":130,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_25":{"id":"e8188b50d17f_25","name":"55f6","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 gets utterly confused after the SWD Read Operation. Only way to fix this? Reset the SWD connection and resynchronise by resending the JTAG-To-SWD Sequence.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_25.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_25.markups.0":{"type":"STRONG","start":80,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_26":{"id":"e8188b50d17f_26","name":"fc36","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Sending the JTAG-To-SWD Sequence to reset SWD connection. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fswd.h","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_26.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_26.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_26.markups.0":{"type":"A","start":63,"end":128,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fswd.h","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:f9c5ea7a23dad701b65d7eb9c486b137":{"id":"f9c5ea7a23dad701b65d7eb9c486b137","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_26.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:f9c5ea7a23dad701b65d7eb9c486b137","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_27":{"id":"e8188b50d17f_27","name":"05bd","type":"P","href":null,"layout":null,"metadata":null,"text":"Yes our SWD flashing may slow down when we reset the SWD connection after every SWD Read Operation… But we are now running the SWD connection over SPI at a speedy 31 MHz! This compensates for the reset transmission, so the overall SWD flashing is still fast.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_27.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_27.markups.0":{"type":"STRONG","start":163,"end":169,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_28":{"id":"e8188b50d17f_28","name":"faa2","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"After every SWD Read Operation, send the JTAG-To-SWD Sequence to reset SWD connection. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_28.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_28.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_28.markups.0":{"type":"A","start":92,"end":165,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:7512be857515198a9886ce4cab4d6475":{"id":"7512be857515198a9886ce4cab4d6475","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_28.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:7512be857515198a9886ce4cab4d6475","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_29":{"id":"e8188b50d17f_29","name":"30e6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Throwaway SWD Read Operation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_30":{"id":"e8188b50d17f_30","name":"fb58","type":"P","href":null,"layout":null,"metadata":null,"text":"For SWD to work over SPI, we need to reset the SWD connection after every SWD Read Operation… Just send the JTAG-To-SWD Sequence! But there’s a catch: We MUST read IDCODE after sending the JTAG-To-SWD Sequence…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_30.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_30.markups.0":{"type":"EM","start":151,"end":210,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_31":{"id":"e8188b50d17f_31","name":"4f5b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*ySSy6VmrSZKXhu2CQl87ig.png","typename":"ImageMetadata"},"text":"Resetting the SWD connection. From ARM® Debug Interface v5 Architecture Specification https:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_31.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ySSy6VmrSZKXhu2CQl87ig.png":{"id":"1*ySSy6VmrSZKXhu2CQl87ig.png","originalHeight":397,"originalWidth":920,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_31.markups.0":{"type":"A","start":86,"end":163,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_32":{"id":"e8188b50d17f_32","name":"d77e","type":"P","href":null,"layout":null,"metadata":null,"text":"See the problem here? We need to reset after reading a register… And yet we need to read a register (IDCODE) after resetting!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_32.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_32.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_32.markups.0":{"type":"EM","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_32.markups.1":{"type":"EM","start":65,"end":125,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_33":{"id":"e8188b50d17f_33","name":"c12a","type":"P","href":null,"layout":null,"metadata":null,"text":"The snake eats its own tail! To break the snake, we use a sneaky way to read IDCODE after resetting, the Throwaway Way…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_33.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_33.markups.0":{"type":"EM","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_34":{"id":"e8188b50d17f_34","name":"8d1f","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*4PyuAj8bjDm_SJPv_U3vbA.png","typename":"ImageMetadata"},"text":"SWD Read Operation: Normal version (above) and Throwaway version (below). From https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_34.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4PyuAj8bjDm_SJPv_U3vbA.png":{"id":"1*4PyuAj8bjDm_SJPv_U3vbA.png","originalHeight":327,"originalWidth":1839,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_34.markups.0":{"type":"A","start":79,"end":173,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_35":{"id":"e8188b50d17f_35","name":"a7ab","type":"P","href":null,"layout":null,"metadata":null,"text":"Notice that we slide the entire Read IDCODE Operation two bits to the right… Inserting two null bits in front.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_35.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_35.markups.0":{"type":"EM","start":15,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_36":{"id":"e8188b50d17f_36","name":"2cc8","type":"P","href":null,"layout":null,"metadata":null,"text":"Will nRF52 accept the two null leading bits sent by Pi? Yes because all SWD Read\u002FWrite Operations must start with 1. So it’s always OK for Pi to send null bits before and after every SWD Read\u002FWrite Operation.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_36.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_36.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_36.markups.0":{"type":"CODE","start":114,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_36.markups.1":{"type":"EM","start":0,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_37":{"id":"e8188b50d17f_37","name":"b4b0","type":"P","href":null,"layout":null,"metadata":null,"text":"For a normal SWD Read Operation (that’s not byte-aligned and hence problematic)…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_38":{"id":"e8188b50d17f_38","name":"2d5b","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi → nRF52: 8 bits (A5), followed by…\nnRF52 → Pi: 38 bits (Data + Parity + Turnaround)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_38.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_38.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_38.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_38.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_38.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_38.markups.0":{"type":"CODE","start":20,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_38.markups.1":{"type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_38.markups.2":{"type":"STRONG","start":38,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_38.markups.3":{"type":"EM","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_38.markups.4":{"type":"EM","start":38,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_39":{"id":"e8188b50d17f_39","name":"b205","type":"P","href":null,"layout":null,"metadata":null,"text":"Total 46 bits, not byte-aligned, no good. For our special Throwaway version with two prepadded null bits…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_39.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_39.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_40":{"id":"e8188b50d17f_40","name":"449e","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi → nRF52: 48 bits (94 02 00 00 00 00), followed by…\nnRF52 → Pi: 0 bits","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_40.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_40.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_40.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_40.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_40.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_40.markups.0":{"type":"CODE","start":21,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_40.markups.1":{"type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_40.markups.2":{"type":"STRONG","start":54,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_40.markups.3":{"type":"EM","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_40.markups.4":{"type":"EM","start":54,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_41":{"id":"e8188b50d17f_41","name":"5182","type":"P","href":null,"layout":null,"metadata":null,"text":"Total 48 bits, byte-aligned, all good! So the next SWD Read or Write Operation may be sent, perfectly aligned to the byte. (If the next operation is SWD Read, we’ll have to read the register, reset and read IDCODE again)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_41.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_41.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_42":{"id":"e8188b50d17f_42","name":"3133","type":"P","href":null,"layout":null,"metadata":null,"text":"But it sounds like Pi is yakking away over the entire SWD Read Operation, not really listening to nRF52 (and getting the value of IDCODE)?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_43":{"id":"e8188b50d17f_43","name":"0362","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s perfectly fine… We don’t really care about the value of IDCODE anyway. We are only reading IDCODE because Arm said so.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_44":{"id":"e8188b50d17f_44","name":"758a","type":"P","href":null,"layout":null,"metadata":null,"text":"Thus in the SPI implementation of SWD, we see this special Throwaway Read IDCODE (94 02 00 00 00 00) that’s sent after every SWD connection reset in spi_transmit_resync(). To give sufficient clock cycles for nRF52 to do its job, we insert a null byte before and after the Throwaway Read IDCODE: 00 94 02 00 00 00 00 00","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_44.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_44.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_44.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_44.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_44.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_44.markups.5","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_44.markups.0":{"type":"CODE","start":82,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_44.markups.1":{"type":"CODE","start":149,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_44.markups.2":{"type":"CODE","start":295,"end":318,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_44.markups.3":{"type":"A","start":149,"end":168,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_44.markups.4":{"type":"STRONG","start":295,"end":297,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_44.markups.5":{"type":"STRONG","start":316,"end":318,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_45":{"id":"e8188b50d17f_45","name":"7836","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Reset SWD Connection with Throwaway Read IDCODE. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_45.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_45.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_45.markups.0":{"type":"A","start":54,"end":127,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:02cb00fb124630dce87c9f3e125505c3":{"id":"02cb00fb124630dce87c9f3e125505c3","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_45.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:02cb00fb124630dce87c9f3e125505c3","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_46":{"id":"e8188b50d17f_46","name":"7acf","type":"P","href":null,"layout":null,"metadata":null,"text":"What’s the SWD Write ABORT Operation? We’ll learn in a while…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_46.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_46.markups.0":{"type":"EM","start":0,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_47":{"id":"e8188b50d17f_47","name":"81ad","type":"H3","href":null,"layout":null,"metadata":null,"text":"SWD Write Operation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_48":{"id":"e8188b50d17f_48","name":"7a4a","type":"P","href":null,"layout":null,"metadata":null,"text":"For Raspberry Pi to write an SWD Register on nRF52, we perform an SWD Write Operation like this (Raspberry Pi is the host, PineTime\u002FnRF52 is the target)…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_49":{"id":"e8188b50d17f_49","name":"3aca","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*49lUAkfSVR0aATyuz86N8Q.png","typename":"ImageMetadata"},"text":"SWD Write Operation padded with 2 null bits. From https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_49.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*49lUAkfSVR0aATyuz86N8Q.png":{"id":"1*49lUAkfSVR0aATyuz86N8Q.png","originalHeight":199,"originalWidth":1842,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_49.markups.0":{"type":"A","start":50,"end":144,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_50":{"id":"e8188b50d17f_50","name":"31fa","type":"P","href":null,"layout":null,"metadata":null,"text":"Here we are writing the value 0x1E to the ABORT Register. Whenever a SWD protocol error occurs during transmission (e.g. misaligned bits), we need to clear the error by writing to the ABORT Register.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_50.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_50.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_50.markups.0":{"type":"CODE","start":30,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_50.markups.1":{"type":"STRONG","start":42,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_51":{"id":"e8188b50d17f_51","name":"91be","type":"P","href":null,"layout":null,"metadata":null,"text":"ABORT is Register #0 (in Write Mode), so we set A2 and A3 (bits 2 and 3 of the register number) to 0.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_51.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_51.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_51.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_51.markups.0":{"type":"CODE","start":48,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_51.markups.1":{"type":"CODE","start":55,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_51.markups.2":{"type":"CODE","start":99,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_52":{"id":"e8188b50d17f_52","name":"cb3f","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi → nRF52: 8 bits…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_52.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_52.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_52.markups.0":{"type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_52.markups.1":{"type":"EM","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_53":{"id":"e8188b50d17f_53","name":"392b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*UJjRRCHXBpCrPyy9wtneMg.png","typename":"ImageMetadata"},"text":"From Pi to nRF52","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UJjRRCHXBpCrPyy9wtneMg.png":{"id":"1*UJjRRCHXBpCrPyy9wtneMg.png","originalHeight":133,"originalWidth":647,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_54":{"id":"e8188b50d17f_54","name":"78a0","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi sends 0x81 (least significant bit first) to nRF52. That’s followed by Trn, the Turnaround Bit.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_54.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_54.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_54.markups.0":{"type":"CODE","start":9,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_54.markups.1":{"type":"CODE","start":73,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_55":{"id":"e8188b50d17f_55","name":"9139","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 → Pi: 5 bits (including turnaround)…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_55.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_55.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_55.markups.0":{"type":"STRONG","start":0,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_55.markups.1":{"type":"EM","start":0,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_56":{"id":"e8188b50d17f_56","name":"9979","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*2OHTPpxD-_Qo5bdsWkWt6A.png","typename":"ImageMetadata"},"text":"From nRF52 to Pi","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2OHTPpxD-_Qo5bdsWkWt6A.png":{"id":"1*2OHTPpxD-_Qo5bdsWkWt6A.png","originalHeight":132,"originalWidth":507,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_57":{"id":"e8188b50d17f_57","name":"59cf","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 responds with the Acknowledgement 100 (which means OK). and another Turnaround Bit.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_57.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_57.markups.0":{"type":"CODE","start":40,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_58":{"id":"e8188b50d17f_58","name":"a1fd","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi → nRF52: 33 bits…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_58.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_58.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_58.markups.0":{"type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_58.markups.1":{"type":"EM","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_59":{"id":"e8188b50d17f_59","name":"8c11","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*rQaYOneDe4H71HiBuw6ClQ.png","typename":"ImageMetadata"},"text":"From Pi to nRF52","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rQaYOneDe4H71HiBuw6ClQ.png":{"id":"1*rQaYOneDe4H71HiBuw6ClQ.png","originalHeight":132,"originalWidth":1319,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_60":{"id":"e8188b50d17f_60","name":"c3aa","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi sends 32 bits of data (the value to be written to Register ABORT) and a Parity bit.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_61":{"id":"e8188b50d17f_61","name":"b3c1","type":"P","href":null,"layout":null,"metadata":null,"text":"Pi → nRF52: 2 bits (padding for byte alignment)…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_61.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_61.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_61.markups.0":{"type":"STRONG","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_61.markups.1":{"type":"EM","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_62":{"id":"e8188b50d17f_62","name":"7d23","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*RmZomPH4xTbSRHsvy0TUYg.png","typename":"ImageMetadata"},"text":"From Pi to nRF52","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RmZomPH4xTbSRHsvy0TUYg.png":{"id":"1*RmZomPH4xTbSRHsvy0TUYg.png","originalHeight":132,"originalWidth":407,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_63":{"id":"e8188b50d17f_63","name":"ea2d","type":"P","href":null,"layout":null,"metadata":null,"text":"For our SPI implementation, Pi sends an extra 2 null bits to make the entire operation byte-aligned: 6 whole SPI bytes. (Remember: It’s OK to insert extra null bits before and after SWD Read\u002FWrite Operations)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_63.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_63.markups.0":{"type":"EM","start":120,"end":208,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_64":{"id":"e8188b50d17f_64","name":"c4c9","type":"P","href":null,"layout":null,"metadata":null,"text":"No misaligned bits for SWD Write Operations… Phew!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_64.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_64.markups.0":{"type":"EM","start":45,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_65":{"id":"e8188b50d17f_65","name":"a93c","type":"H3","href":null,"layout":null,"metadata":null,"text":"A Convenient Write Lie","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_66":{"id":"e8188b50d17f_66","name":"5a2c","type":"P","href":null,"layout":null,"metadata":null,"text":"Will SWD Write Operations work over SPI? SWD Write Operations are always byte-aligned, because we padded 2 null bits. But we have a funny Turnaround situation in the second byte of the SWD Write Operation…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_66.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_66.markups.0":{"type":"EM","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_67":{"id":"e8188b50d17f_67","name":"43b8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*rDDxoGZkjko8cQqQVAYeXw.png","typename":"ImageMetadata"},"text":"From Pi to nRF52 and back","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rDDxoGZkjko8cQqQVAYeXw.png":{"id":"1*rDDxoGZkjko8cQqQVAYeXw.png","originalHeight":132,"originalWidth":743,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_68":{"id":"e8188b50d17f_68","name":"69ee","type":"P","href":null,"layout":null,"metadata":null,"text":"There are Two Turnarounds in the same byte!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_68.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_68.markups.0":{"type":"EM","start":0,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_69":{"id":"e8188b50d17f_69","name":"d467","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 → Pi: 3 Acknowledgement Bits + 2 Turnaround Bits, followed by…\nPi → nRF52: 3 Data Bits","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_69.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_69.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_69.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_69.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_69.markups.0":{"type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_69.markups.1":{"type":"STRONG","start":69,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_69.markups.2":{"type":"EM","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_69.markups.3":{"type":"EM","start":68,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_70":{"id":"e8188b50d17f_70","name":"72be","type":"P","href":null,"layout":null,"metadata":null,"text":"We can’t flip the direction of transmission within a single SPI byte transfer. So this fails for SPI! Thankfully we have another sneaky solution for this problematic second byte…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_70.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_70.markups.0":{"type":"EM","start":79,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_71":{"id":"e8188b50d17f_71","name":"4c36","type":"P","href":null,"layout":null,"metadata":null,"text":"nRF52 → Pi: 0 bits, followed by…\nPi → nRF52: 3 Acknowledgement Bits + 2 Turnaround Bits + 3 Data Bits","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_71.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_71.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_71.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_71.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_71.markups.0":{"type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_71.markups.1":{"type":"STRONG","start":33,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_71.markups.2":{"type":"EM","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_71.markups.3":{"type":"EM","start":32,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_72":{"id":"e8188b50d17f_72","name":"155a","type":"P","href":null,"layout":null,"metadata":null,"text":"Look familiar? This is the same trick as the Throwaway SWD Read Operation… We now throw away the 3 Acknowledgement Bits sent by nRF52 to Pi!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_72.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_72.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_72.markups.0":{"type":"EM","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_72.markups.1":{"type":"EM","start":75,"end":140,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_73":{"id":"e8188b50d17f_73","name":"bde1","type":"P","href":null,"layout":null,"metadata":null,"text":"Instead of Pi receiving the 3 Acknowledgement Bits from nRF52, Pi now sends 3 bits to nRF52. Doesn’t matter whether they are 0 or 1, as long as it takes 3 clock cycles.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_73.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_73.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_73.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_73.markups.0":{"type":"CODE","start":125,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_73.markups.1":{"type":"CODE","start":130,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_73.markups.2":{"type":"EM","start":63,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_74":{"id":"e8188b50d17f_74","name":"2c7d","type":"P","href":null,"layout":null,"metadata":null,"text":"But that means we won’t know whether the Write Acknowledgement is OK (100)!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_74.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_74.markups.0":{"type":"CODE","start":70,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_75":{"id":"e8188b50d17f_75","name":"a5f4","type":"P","href":null,"layout":null,"metadata":null,"text":"Think about it… Is this Write Acknowledgement really useful? It happens before the data is written! Most of the time it’s used to indicate that the Register ID (in A2 and A3) is valid.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_75.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_75.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_75.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_75.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_75.markups.0":{"type":"CODE","start":164,"end":166,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_75.markups.1":{"type":"CODE","start":171,"end":173,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_75.markups.2":{"type":"EM","start":0,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_75.markups.3":{"type":"EM","start":72,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_76":{"id":"e8188b50d17f_76","name":"101c","type":"P","href":null,"layout":null,"metadata":null,"text":"Thus we take a calculated risk and assume that the SWD Write Acknowledgement is always OK. Our SPI code always lies and returns 100 to OpenOCD.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_76.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_76.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_76.markups.0":{"type":"CODE","start":128,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_76.markups.1":{"type":"STRONG","start":51,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_77":{"id":"e8188b50d17f_77","name":"61c0","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Our SPI code always returns OK to OpenOCD for SWD Write Acknowledgement. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_77.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_77.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_77.markups.0":{"type":"A","start":78,"end":151,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:98ed286f829bcea91406f6aa3cd79b48":{"id":"98ed286f829bcea91406f6aa3cd79b48","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_77.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:98ed286f829bcea91406f6aa3cd79b48","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_78":{"id":"e8188b50d17f_78","name":"eb0b","type":"P","href":null,"layout":null,"metadata":null,"text":"Will this cause problems when flashing the ROM of nRF52? Since we’re not checking the SWD Write Acknowledgement?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_78.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_78.markups.0":{"type":"EM","start":0,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_79":{"id":"e8188b50d17f_79","name":"749e","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s how we mitigate the risk of write failures: We always read and verify the ROM contents after flashing, like in this OpenOCD script…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_79.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_79.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_79.markups.0":{"type":"A","start":118,"end":137,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpinetime-rust-mynewt\u002Fblob\u002Fmaster\u002Fscripts\u002Fnrf52\u002Fflash-app.ocd","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_79.markups.1":{"type":"STRONG","start":51,"end":108,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_80":{"id":"e8188b50d17f_80","name":"dd35","type":"PRE","href":null,"layout":null,"metadata":null,"text":"program bin\u002Ftargets\u002Fnrf52_my_sensor\u002Fapp\u002Fapps\u002Fmy_sensor_app\u002Fmy_sensor_app.img verify 0x00008000","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_81":{"id":"e8188b50d17f_81","name":"1afa","type":"P","href":null,"layout":null,"metadata":null,"text":"When we throw away the SWD Write Acknowledgement, we eliminate all Turnarounds. Our SWD Write Operation becomes really simple… Just send 8 whole bytes from Pi to nRF52!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_81.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_81.markups.0":{"type":"EM","start":127,"end":168,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_82":{"id":"e8188b50d17f_82","name":"11ed","type":"P","href":null,"layout":null,"metadata":null,"text":"Perfect for implementing SWD over SPI!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_82.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_82.markups.0":{"type":"EM","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_83":{"id":"e8188b50d17f_83","name":"ff0e","type":"P","href":null,"layout":null,"metadata":null,"text":"Hence to write value 0x1E to the ABORT Register, Pi only needs to blast out 6 bytes over SPI to nRF52: 81 d3 03 00 00 00","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_83.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_83.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_83.markups.0":{"type":"CODE","start":21,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_83.markups.1":{"type":"CODE","start":103,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_84":{"id":"e8188b50d17f_84","name":"dd2b","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Sending 8 whole bytes from Pi to nRF52 for an SPI Write Operation. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_84.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_84.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_84.markups.0":{"type":"A","start":72,"end":145,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:659648b29c54eebe853501321850e5f9":{"id":"659648b29c54eebe853501321850e5f9","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_84.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:659648b29c54eebe853501321850e5f9","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_85":{"id":"e8188b50d17f_85","name":"81eb","type":"H3","href":null,"layout":null,"metadata":null,"text":"Clear the Sticky Error Bits","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_86":{"id":"e8188b50d17f_86","name":"6561","type":"P","href":null,"layout":null,"metadata":null,"text":"We added debug logs to the existing OpenOCD code in bitbang.c to compare the old GPIO and new SPI implementations of the SWD protocol.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_86.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_86.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_86.markups.0":{"type":"CODE","start":52,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_86.markups.1":{"type":"A","start":52,"end":61,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c#L414-L464","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_87":{"id":"e8188b50d17f_87","name":"b1f6","type":"P","href":null,"layout":null,"metadata":null,"text":"Remember we said earlier that every SWD Read Operation will be followed by an SWD connection reset that transmits two byte sequences to nRF52…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_88":{"id":"e8188b50d17f_88","name":"3467","type":"OLI","href":null,"layout":null,"metadata":null,"text":"JTAG-To-SWD Sequence","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_89":{"id":"e8188b50d17f_89","name":"01a6","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Read IDCODE Sequence, prepadded with two null bits","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_90":{"id":"e8188b50d17f_90","name":"3f64","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s what happens when we run OpenOCD with that setup…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_91":{"id":"e8188b50d17f_91","name":"4a1c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*NaHaYp3UvNfL1ubNdCOpkA.png","typename":"ImageMetadata"},"text":"Comparing the logs from SWD over GPIO (left) with SWD over SPI (right). From https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=900511571","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_91.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NaHaYp3UvNfL1ubNdCOpkA.png":{"id":"1*NaHaYp3UvNfL1ubNdCOpkA.png","originalHeight":788,"originalWidth":1061,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_91.markups.0":{"type":"A","start":77,"end":179,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=900511571","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_92":{"id":"e8188b50d17f_92","name":"27f8","type":"P","href":null,"layout":null,"metadata":null,"text":"Both the GPIO and SPI versions of OpenOCD are reading and writing to the same nRF52 registers: IDCODE, SELECT AP, CTRL\u002FSTAT. But the value of the Control\u002FStatus Register (CTRL\u002FSTAT) is different for SPI: f0000003.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_92.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_92.markups.0":{"type":"CODE","start":204,"end":212,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_93":{"id":"e8188b50d17f_93","name":"6270","type":"P","href":null,"layout":null,"metadata":null,"text":"What’s f0000003? Let’s key that into this spreadsheet to decode the Control\u002FStatus value…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_93.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_93.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_93.markups.0":{"type":"CODE","start":7,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_93.markups.1":{"type":"A","start":32,"end":53,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=2077834467","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_94":{"id":"e8188b50d17f_94","name":"0add","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*nXTgKPljszZxZmfxDXlVEQ.png","typename":"ImageMetadata"},"text":"Control\u002FStatus Register Decoder: https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=2077834467","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_94.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nXTgKPljszZxZmfxDXlVEQ.png":{"id":"1*nXTgKPljszZxZmfxDXlVEQ.png","originalHeight":205,"originalWidth":1572,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_94.markups.0":{"type":"A","start":33,"end":136,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=2077834467","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_95":{"id":"e8188b50d17f_95","name":"a209","type":"P","href":null,"layout":null,"metadata":null,"text":"What’s the difference between the GPIO and SPI values for the Control\u002FStatus Register? SPI is experiencing the STICKYORUN error…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_95.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_95.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_95.markups.0":{"type":"STRONG","start":111,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_95.markups.1":{"type":"EM","start":0,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_96":{"id":"e8188b50d17f_96","name":"274e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*e_ynAgJbcP4u8I8SOQytUA.png","typename":"ImageMetadata"},"text":"STICKYORUN flag in the Control\u002FStatus Register. From ARM® Debug Interface v5 Architecture Specification https:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_96.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*e_ynAgJbcP4u8I8SOQytUA.png":{"id":"1*e_ynAgJbcP4u8I8SOQytUA.png","originalHeight":213,"originalWidth":866,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_96.markups.0":{"type":"A","start":104,"end":181,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_97":{"id":"e8188b50d17f_97","name":"528b","type":"P","href":null,"layout":null,"metadata":null,"text":"This means that nRF52 has detected some overrun garbage on the SWD connection… Must be due to our misaligned SWD Read Operations!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_97.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_97.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_97.markups.0":{"type":"STRONG","start":26,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_97.markups.1":{"type":"EM","start":79,"end":129,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_98":{"id":"e8188b50d17f_98","name":"8474","type":"P","href":null,"layout":null,"metadata":null,"text":"This is a “Sticky” error… It sticks there forever until we do something to clear the error status. If we don’t clear the Sticky error status, all SWD operations will fail.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_98.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_98.markups.0":{"type":"STRONG","start":99,"end":171,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_99":{"id":"e8188b50d17f_99","name":"57ef","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*ci4QCcTcbS98B_FotQqMCw.png","typename":"ImageMetadata"},"text":"ABORT Register. From ARM® Debug Interface v5 Architecture Specification https:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_99.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ci4QCcTcbS98B_FotQqMCw.png":{"id":"1*ci4QCcTcbS98B_FotQqMCw.png","originalHeight":273,"originalWidth":811,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_99.markups.0":{"type":"A","start":72,"end":149,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_100":{"id":"e8188b50d17f_100","name":"264e","type":"P","href":null,"layout":null,"metadata":null,"text":"The solution: We write value 0x1E to the ABORT Register. That’s binary 11110, which means that we are clearing all the errors: Overrun Error, Write Data Error, Sticky Error, Sticky Compare Error.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_100.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_100.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_100.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_100.markups.0":{"type":"CODE","start":29,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_100.markups.1":{"type":"CODE","start":71,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_100.markups.2":{"type":"EM","start":111,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_101":{"id":"e8188b50d17f_101","name":"b043","type":"P","href":null,"layout":null,"metadata":null,"text":"In the previous section we have learnt how to write value 0x1E to the ABORT Register: By blasting out over SPI 81 d3 03 00 00 00","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_101.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_101.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_101.markups.0":{"type":"CODE","start":58,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_101.markups.1":{"type":"CODE","start":111,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_102":{"id":"e8188b50d17f_102","name":"8206","type":"P","href":null,"layout":null,"metadata":null,"text":"When shall we write to the ABORT Register to clear the errors?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_102.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_102.markups.0":{"type":"EM","start":0,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_103":{"id":"e8188b50d17f_103","name":"1b5f","type":"P","href":null,"layout":null,"metadata":null,"text":"Remember that Pi has become extremely negligent to nRF52… Pi has thrown away so much feedback and acknowledgement from nRF52! We don’t know exactly when nRF52 is having issues. But since…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_103.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_103.markups.0":{"type":"EM","start":58,"end":125,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_104":{"id":"e8188b50d17f_104","name":"0b29","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The errors are caused by the misaligned SWD Read Operation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_105":{"id":"e8188b50d17f_105","name":"0da2","type":"OLI","href":null,"layout":null,"metadata":null,"text":"And we always reset the SWD connection after every SWD Read Operation (except the Throwaway Read IDCODE)…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_106":{"id":"e8188b50d17f_106","name":"f7cb","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s write to the ABORT Register and clear the errors at every SWD connection reset.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_106.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_106.markups.0":{"type":"STRONG","start":38,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_107":{"id":"e8188b50d17f_107","name":"9890","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Clearing the errors at every SWD connect reset by writing to ABORT. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_107.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_107.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_107.markups.0":{"type":"A","start":73,"end":146,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:42f36e51a7e025e13dddb9ce07b7d6e9":{"id":"42f36e51a7e025e13dddb9ce07b7d6e9","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_107.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:42f36e51a7e025e13dddb9ce07b7d6e9","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_108":{"id":"e8188b50d17f_108","name":"6702","type":"P","href":null,"layout":null,"metadata":null,"text":"With this fix, SWD over SPI works perfectly!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_108.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_108.markups.0":{"type":"EM","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_109":{"id":"e8188b50d17f_109","name":"6258","type":"H3","href":null,"layout":null,"metadata":null,"text":"Inject SPI into OpenOCD Bit Bang","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_110":{"id":"e8188b50d17f_110","name":"2886","type":"P","href":null,"layout":null,"metadata":null,"text":"We have SWD Read and Write Operations working fine over SPI, and we have forcibly fixed all the SWD errors indirectly caused by SPI. Now let’s inject this SPI code into the OpenOCD code.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_111":{"id":"e8188b50d17f_111","name":"8ac8","type":"P","href":null,"layout":null,"metadata":null,"text":"OpenOCD calls bitbang_exchange() in bitbang.c whenever it needs to transmit or receive a chunk of bits in a fixed direction. OpenOCD calls bitbang_exchange() two times for every SWD Read, three times for every SWD Write…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_111.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_111.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_111.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_111.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_111.markups.0":{"type":"CODE","start":14,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_111.markups.1":{"type":"CODE","start":36,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_111.markups.2":{"type":"CODE","start":139,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_111.markups.3":{"type":"A","start":36,"end":45,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c#L414-L464","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_112":{"id":"e8188b50d17f_112","name":"c473","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*QbftBI6WVn4pCEgCTV-Rlw.png","typename":"ImageMetadata"},"text":"SWD Read: bitbang_exchange() called for two chunks of bits. From https:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_112.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_112.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QbftBI6WVn4pCEgCTV-Rlw.png":{"id":"1*QbftBI6WVn4pCEgCTV-Rlw.png","originalHeight":416,"originalWidth":1542,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_112.markups.0":{"type":"CODE","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_112.markups.1":{"type":"A","start":65,"end":142,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_113":{"id":"e8188b50d17f_113","name":"d90a","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*cDrUeL7Xaih_AZ-6LPDIsQ.png","typename":"ImageMetadata"},"text":"SWD Write: bitbang_exchange() called for three chunks of bits. From https:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_113.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_113.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cDrUeL7Xaih_AZ-6LPDIsQ.png":{"id":"1*cDrUeL7Xaih_AZ-6LPDIsQ.png","originalHeight":462,"originalWidth":1576,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8188b50d17f_113.markups.0":{"type":"CODE","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_113.markups.1":{"type":"A","start":68,"end":145,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_114":{"id":"e8188b50d17f_114","name":"f7dd","type":"P","href":null,"layout":null,"metadata":null,"text":"bitbang_exchange() is called by OpenOCD like this…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_114.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_114.markups.0":{"type":"CODE","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_115":{"id":"e8188b50d17f_115","name":"e9a0","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_115.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:a750ca570ea4253eacb11a57f6b03369":{"id":"a750ca570ea4253eacb11a57f6b03369","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_115.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:a750ca570ea4253eacb11a57f6b03369","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_116":{"id":"e8188b50d17f_116","name":"fb07","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s the existing code for bitbang_exchange() that transmits and receives chunks of bits over GPIO…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_116.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_116.markups.0":{"type":"CODE","start":29,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_117":{"id":"e8188b50d17f_117","name":"beb7","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_117.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_117.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_117.markups.0":{"type":"A","start":5,"end":82,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:f7bf6a0ca70f02098fc0f263e5ca2a1c":{"id":"f7bf6a0ca70f02098fc0f263e5ca2a1c","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_117.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:f7bf6a0ca70f02098fc0f263e5ca2a1c","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_118":{"id":"e8188b50d17f_118","name":"f2da","type":"P","href":null,"layout":null,"metadata":null,"text":"And here’s the modification we made for bitbang_exchange() to transmit and receives chunks of bits over SPI…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_118.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_118.markups.0":{"type":"CODE","start":40,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_119":{"id":"e8188b50d17f_119","name":"2aba","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_119.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_119.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_119.markups.0":{"type":"A","start":5,"end":82,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:4d0c6c346c5307e69229059b946786cc":{"id":"4d0c6c346c5307e69229059b946786cc","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_119.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:4d0c6c346c5307e69229059b946786cc","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_120":{"id":"e8188b50d17f_120","name":"0fd4","type":"P","href":null,"layout":null,"metadata":null,"text":"Which simply forwards the call to our new function spi_exchange() in spi.c.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_120.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_120.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_120.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_120.markups.0":{"type":"CODE","start":51,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_120.markups.1":{"type":"CODE","start":69,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_120.markups.2":{"type":"A","start":69,"end":74,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_121":{"id":"e8188b50d17f_121","name":"7c44","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_121.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_121.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_121.markups.0":{"type":"A","start":5,"end":78,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:3ebaa39b41a1cbccc562e54c0dc2a456":{"id":"3ebaa39b41a1cbccc562e54c0dc2a456","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_121.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:3ebaa39b41a1cbccc562e54c0dc2a456","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_122":{"id":"e8188b50d17f_122","name":"3e6b","type":"P","href":null,"layout":null,"metadata":null,"text":"Because spi_exchange() is called with chunks of bits, we use the offset and bit_cnt parameters to figure out whether this chunk came from an SWD Read or Write Operation, and which chunk in that operation…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_122.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_122.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_122.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_122.markups.0":{"type":"CODE","start":8,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_122.markups.1":{"type":"CODE","start":65,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_122.markups.2":{"type":"CODE","start":76,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_123":{"id":"e8188b50d17f_123","name":"1bc2","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Deducing the chunk by offset and bit_cnt. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_123.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_123.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_123.markups.0":{"type":"A","start":47,"end":120,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fspi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:e8188b50d17f_123.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:98ed286f829bcea91406f6aa3cd79b48","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_124":{"id":"e8188b50d17f_124","name":"98d9","type":"P","href":null,"layout":null,"metadata":null,"text":"(Yeah this chunk handling smells bad… We should inject the SPI code into bitbang_swd_read_reg() and bitbang_swd_write_reg() in bitbang.c instead)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.6","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_124.markups.7","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_124.markups.0":{"type":"CODE","start":73,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.1":{"type":"CODE","start":100,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.2":{"type":"CODE","start":127,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.3":{"type":"A","start":127,"end":136,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\u002Fblob\u002Fmaster\u002Fsrc\u002Fjtag\u002Fdrivers\u002Fbitbang.c#L414-L464","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.4":{"type":"EM","start":0,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.5":{"type":"EM","start":95,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.6":{"type":"EM","start":123,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_124.markups.7":{"type":"EM","start":136,"end":145,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_125":{"id":"e8188b50d17f_125","name":"b16e","type":"P","href":null,"layout":null,"metadata":null,"text":"In Raspberry Pi, all bytes must be sent over SPI in Most Significant Bit format… But OpenOCD uses Least Significant Bit format to manipulate the bytes. So we need to the reverse the bits like this…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_126":{"id":"e8188b50d17f_126","name":"3df5","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_126.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:186cb60d044f92edb1b7c0d40531f491":{"id":"186cb60d044f92edb1b7c0d40531f491","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_126.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:186cb60d044f92edb1b7c0d40531f491","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_127":{"id":"e8188b50d17f_127","name":"1b10","type":"H3","href":null,"layout":null,"metadata":null,"text":"SPI Sandbox","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_128":{"id":"e8188b50d17f_128","name":"20e2","type":"P","href":null,"layout":null,"metadata":null,"text":"Before implementing SWD over SPI in OpenOCD, I used a simple C program pi-swd-spi.c to test the individual SWD functions. I hope you’ll do the same when you’re modifying OpenOCD.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_128.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_128.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_128.markups.0":{"type":"CODE","start":71,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_128.markups.1":{"type":"A","start":71,"end":83,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpi-swd-spi\u002Fblob\u002Fmaster\u002Fpi-swd-spi.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_129":{"id":"e8188b50d17f_129","name":"8f99","type":"P","href":null,"layout":null,"metadata":null,"text":"The program tests all the functions we have covered: misaligned SWD reads, padded SWD writes, JTAG-To-SWD reset, Throwaway Read IDCODE, Write ABORT, Read CTRL\u002FSTAT, …","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_130":{"id":"e8188b50d17f_130","name":"5bed","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s the output from the test program…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_130.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_130.markups.0":{"type":"A","start":0,"end":39,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpi-swd-spi\u002Fblob\u002Fmaster\u002Fpi-swd-spi.c#L296-L394","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_131":{"id":"e8188b50d17f_131","name":"af6e","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"SWD SPI Test Log. From https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpi-swd-spi\u002Fblob\u002Fmaster\u002Fpi-swd-spi.c#L296-L394","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_131.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_131.iframe","typename":"Iframe"},"mixtapeMetadata":null},"Paragraph:e8188b50d17f_131.markups.0":{"type":"A","start":23,"end":95,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpi-swd-spi\u002Fblob\u002Fmaster\u002Fpi-swd-spi.c#L296-L394","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"MediaResource:758f0754f69c0a5ff0fdfea138f462ca":{"id":"758f0754f69c0a5ff0fdfea138f462ca","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_131.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:758f0754f69c0a5ff0fdfea138f462ca","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_132":{"id":"e8188b50d17f_132","name":"bda6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Build and Test OpenOCD with SPI","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_133":{"id":"e8188b50d17f_133","name":"a033","type":"P","href":null,"layout":null,"metadata":null,"text":"The modified fork of OpenOCD may be found in this repository…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_134":{"id":"e8188b50d17f_134","name":"3ed1","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"lupyuen\u002Fopenocd-spi\nYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_134.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_134.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_134.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_134.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:e8188b50d17f_134.markups.0":{"type":"A","start":0,"end":149,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_134.markups.1":{"type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_134.markups.2":{"type":"EM","start":20,"end":139,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:e8188b50d17f_134.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi","thumbnailImageId":"0*8sStp5l0sA1eWFQY","mediaResourceId":"0*8sStp5l0sA1eWFQY","__typename":"MixtapeMetadata"},"Paragraph:e8188b50d17f_135":{"id":"e8188b50d17f_135","name":"6b24","type":"P","href":null,"layout":null,"metadata":null,"text":"To build and test on Raspberry Pi…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_136":{"id":"e8188b50d17f_136","name":"a357","type":"P","href":null,"layout":null,"metadata":null,"text":"1️⃣ Connect PineTime \u002F nRF52 to the SPI port on Raspberry Pi…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_137":{"id":"e8188b50d17f_137","name":"2000","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:e8188b50d17f_137.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:ff6891a05d70c0e092241c9d9f5e140a":{"id":"ff6891a05d70c0e092241c9d9f5e140a","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"See https:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fopenocd-on-raspberry-pi-better-with-swd-on-spi-7dea9caeb590","__typename":"MediaResource"},"$Paragraph:e8188b50d17f_137.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:ff6891a05d70c0e092241c9d9f5e140a","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8188b50d17f_138":{"id":"e8188b50d17f_138","name":"bdc9","type":"P","href":null,"layout":null,"metadata":null,"text":"2️⃣ Enable the SPI interface on Raspberry Pi…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_139":{"id":"e8188b50d17f_139","name":"f7f6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sudo raspi-config","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_140":{"id":"e8188b50d17f_140","name":"ad7b","type":"P","href":null,"layout":null,"metadata":null,"text":"Select Interfacing Options → SPI → Yes","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_140.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_140.markups.0":{"type":"CODE","start":7,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_141":{"id":"e8188b50d17f_141","name":"d671","type":"P","href":null,"layout":null,"metadata":null,"text":"3️⃣ Download and build the modified OpenOCD…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_142":{"id":"e8188b50d17f_142","name":"b44b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"git clone https:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi\ncd openocd-spi\n.\u002Fbootstrap\n.\u002Fconfigure --enable-sysfsgpio --enable-bcm2835gpio --enable-cmsis-dap\nmake","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_142.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_142.markups.0":{"type":"A","start":10,"end":48,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fopenocd-spi","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_143":{"id":"e8188b50d17f_143","name":"8eda","type":"P","href":null,"layout":null,"metadata":null,"text":"The modified OpenOCD executable is now at openocd-spi\u002Fsrc\u002Fopenocd","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_143.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_143.markups.0":{"type":"CODE","start":42,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_144":{"id":"e8188b50d17f_144","name":"5c77","type":"P","href":null,"layout":null,"metadata":null,"text":"4️⃣ If you’re using pinetime-rust-mynewt downloaded from this article…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_144.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_144.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_144.markups.0":{"type":"CODE","start":20,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_144.markups.1":{"type":"A","start":52,"end":69,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fbuild-and-flash-rust-mynewt-firmware-for-pinetime-smart-watch-5e14259c55?source=friends_link&sk=150b2a73b84144e5ef25b985e65aebe9","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_145":{"id":"e8188b50d17f_145","name":"e40b","type":"P","href":null,"layout":null,"metadata":null,"text":"Edit the OpenOCD scripts located at pinetime-rust-mynewt\u002Fscripts\u002Fnrf52-pi…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_145.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_145.markups.0":{"type":"CODE","start":36,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_146":{"id":"e8188b50d17f_146","name":"a482","type":"P","href":null,"layout":null,"metadata":null,"text":"flash-app.sh, flash-boot.sh, flash-unprotect.sh","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_146.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_146.markups.0":{"type":"CODE","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_147":{"id":"e8188b50d17f_147","name":"52a7","type":"P","href":null,"layout":null,"metadata":null,"text":"Change the openocd folder to openocd-spi like this…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_147.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_147.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_147.markups.0":{"type":"CODE","start":11,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_147.markups.1":{"type":"CODE","start":29,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_148":{"id":"e8188b50d17f_148","name":"e986","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sudo \u002Fhome\u002Fpi\u002Fopenocd-spi\u002Fsrc\u002Fopenocd \\\n    -s \u002Fhome\u002Fpi\u002Fopenocd-spi\u002Ftcl \\\n    -f scripts\u002Fnrf52-pi\u002Fswd-pi.ocd \\\n    -f scripts\u002Fnrf52\u002Fflash-app.ocd","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_148.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_148.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_148.markups.0":{"type":"STRONG","start":14,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_148.markups.1":{"type":"STRONG","start":56,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_149":{"id":"e8188b50d17f_149","name":"51fd","type":"P","href":null,"layout":null,"metadata":null,"text":"Run the scripts to unprotect the flash ROM, flash the bootloader and flash the application via SPI…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_150":{"id":"e8188b50d17f_150","name":"f816","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cd ~\u002Fpinetime-rust-mynewt\nscripts\u002Fnrf52-pi\u002Fflash-unprotect.sh\nscripts\u002Fnrf52-pi\u002Fflash-boot.sh\nscripts\u002Fnrf52-pi\u002Fflash-app.sh","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_151":{"id":"e8188b50d17f_151","name":"002d","type":"P","href":null,"layout":null,"metadata":null,"text":"5️⃣ If you’re not using pinetime-rust-mynewt…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_151.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_151.markups.0":{"type":"CODE","start":24,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_152":{"id":"e8188b50d17f_152","name":"1d6f","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s a sample OpenOCD script and shell script that you may adapt for flashing…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_153":{"id":"e8188b50d17f_153","name":"48f5","type":"P","href":null,"layout":null,"metadata":null,"text":"flash-boot.ocd","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_153.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_153.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_153.markups.0":{"type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_153.markups.1":{"type":"A","start":0,"end":14,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpinetime-rust-mynewt\u002Fblob\u002Fmaster\u002Fscripts\u002Fnrf52\u002Fflash-boot.ocd","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_154":{"id":"e8188b50d17f_154","name":"dad4","type":"P","href":null,"layout":null,"metadata":null,"text":"flash-boot.sh","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_154.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_154.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_154.markups.0":{"type":"CODE","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_154.markups.1":{"type":"A","start":0,"end":13,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpinetime-rust-mynewt\u002Fblob\u002Fmaster\u002Fscripts\u002Fnrf52-pi\u002Fflash-boot.sh","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_155":{"id":"e8188b50d17f_155","name":"f709","type":"P","href":null,"layout":null,"metadata":null,"text":"In flash-boot.sh, change \u002Fhome\u002Fpi\u002Fopenocd-spi to the path of your openocd-spi folder, like \u002Fhome\u002Fpi\u002Fopenocd-spi","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_155.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_155.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_155.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_155.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_155.markups.0":{"type":"CODE","start":3,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_155.markups.1":{"type":"CODE","start":25,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_155.markups.2":{"type":"CODE","start":66,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_155.markups.3":{"type":"CODE","start":91,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_156":{"id":"e8188b50d17f_156","name":"7160","type":"H3","href":null,"layout":null,"metadata":null,"text":"Bit Banging Is Bad","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_157":{"id":"e8188b50d17f_157","name":"f168","type":"P","href":null,"layout":null,"metadata":null,"text":"Bit Banging means sending and receiving data one bit at a time… By looping around, waiting and sending one bit, waiting and sending another bit, …","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_157.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_157.markups.0":{"type":"A","start":0,"end":11,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FBit_banging","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_158":{"id":"e8188b50d17f_158","name":"c9a9","type":"P","href":null,"layout":null,"metadata":null,"text":"When I was teaching IoT with Arduino Uno, I saw plenty of Arduino drivers implemented with Bit Banging. This troubled me because…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_159":{"id":"e8188b50d17f_159","name":"2b33","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Hard to reuse the Bit Banging code on other platforms (from Arduino to Raspberry Pi, STM32, nRF52, RISC-V, …). The timing needs to be adjusted precisely for every platform.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_159.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_159.markups.0":{"type":"STRONG","start":0,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_160":{"id":"e8188b50d17f_160","name":"3792","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Doesn’t work reliably with Multitasking, which skews the timing between bits. On a Raspberry Pi graphical desktop, this explains why OpenOCD can’t flash nRF52 reliably with GPIO Bit Banging… The CPU is just too busy handling interactive tasks.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_160.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_160.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_160.markups.0":{"type":"STRONG","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_160.markups.1":{"type":"STRONG","start":133,"end":189,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_161":{"id":"e8188b50d17f_161","name":"bfda","type":"OLI","href":null,"layout":null,"metadata":null,"text":"It’s 2020. Surely our microcontroller supports interrupt-driven, precisely-clocked SPI and I2C interfaces, like on Raspberry Pi, STM32, nRF52, RISC-V, … (If you’re still using Arduino Uno… Why???)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_161.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_161.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_161.markups.0":{"type":"STRONG","start":11,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_161.markups.1":{"type":"EM","start":189,"end":195,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_162":{"id":"e8188b50d17f_162","name":"2456","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s my plea to all Embedded Developers: Please stop using Bit Banging! I hope this article has given you plenty of reasons. (And this article has wasted your precious time, since you wouldn’t be reading it if OpenOCD were using SPI already)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_162.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_162.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_162.markups.0":{"type":"STRONG","start":43,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_162.markups.1":{"type":"EM","start":127,"end":243,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_163":{"id":"e8188b50d17f_163","name":"0ba3","type":"P","href":null,"layout":null,"metadata":null,"text":"If you’re designing a serial protocol like SWD… Please align the bits to whole bytes! The SWD protocol was designed with plenty of stray bits (every read\u002Fwrite operation is 46 bits), thus Bit Banging was the natural solution for implementing the SWD protocol.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_163.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_163.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_163.markups.0":{"type":"STRONG","start":48,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_163.markups.1":{"type":"EM","start":142,"end":181,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_164":{"id":"e8188b50d17f_164","name":"af0f","type":"P","href":null,"layout":null,"metadata":null,"text":"If Arm had slipped in two measly bits and rounded up to 48 bits, we would have been using SWD over SPI, reliably and efficiently, a long time ago!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_164.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_164.markups.0":{"type":"EM","start":0,"end":146,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_165":{"id":"e8188b50d17f_165","name":"eb1a","type":"H3","href":null,"layout":null,"metadata":null,"text":"References","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_166":{"id":"e8188b50d17f_166","name":"2003","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Introduction to SWD","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_166.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_166.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_166.markups.0":{"type":"A","start":0,"end":19,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_166.markups.1":{"type":"EM","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_167":{"id":"e8188b50d17f_167","name":"6b0b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ARM® Debug Interface v5 Architecture Specification","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_167.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_167.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_167.markups.0":{"type":"A","start":0,"end":50,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002FMarkDing\u002Fswd_programing_sram\u002Fblob\u002Fmaster\u002FRef\u002FARM_debug.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_167.markups.1":{"type":"EM","start":0,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_168":{"id":"e8188b50d17f_168","name":"60ea","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Raspberry Pi SPI Hardware","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_168.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_168.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_168.markups.0":{"type":"A","start":0,"end":25,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fwww.raspberrypi.org\u002Fdocumentation\u002Fhardware\u002Fraspberrypi\u002Fspi\u002FREADME.md","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_168.markups.1":{"type":"EM","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_169":{"id":"e8188b50d17f_169","name":"f7ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Raspberry Pi SPI Kernel Driver","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_169.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_169.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_169.markups.0":{"type":"A","start":0,"end":30,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fgithub.com\u002Fraspberrypi\u002Flinux\u002Fblob\u002Frpi-3.12.y\u002Fdrivers\u002Fspi\u002Fspi-bcm2708.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_169.markups.1":{"type":"EM","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_170":{"id":"e8188b50d17f_170","name":"9a3b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"BCM2835 Peripherals Datasheet","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_170.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_170.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_170.markups.0":{"type":"A","start":0,"end":29,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fwww.raspberrypi.org\u002Fdocumentation\u002Fhardware\u002Fraspberrypi\u002Fbcm2835\u002FBCM2835-ARM-Peripherals.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_170.markups.1":{"type":"EM","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_171":{"id":"e8188b50d17f_171","name":"dc67","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SWD mapping to SPI bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_171.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8188b50d17f_171.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:e8188b50d17f_171.markups.0":{"type":"A","start":0,"end":24,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200117210221\u002Fhttps:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F12oXe1MTTEZVIbdmFXsOgOXVFHCQnYVvIw6fRpIQZybg\u002Fedit#gid=0","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8188b50d17f_171.markups.1":{"type":"EM","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Tag:raspberry-pi":{"id":"raspberry-pi","displayTitle":"Raspberry Pi","__typename":"Tag"},"Tag:spi":{"id":"spi","displayTitle":"Spi","__typename":"Tag"},"Tag:nrf52":{"id":"nrf52","displayTitle":"Nrf52","__typename":"Tag"},"Tag:openocd":{"id":"openocd","displayTitle":"Openocd","__typename":"Tag"},"Tag:internet-of-things":{"id":"internet-of-things","displayTitle":"Internet of Things","__typename":"Tag"},"$Post:7dea9caeb590.previewContent":{"subtitle":"Sneaky tricks to align stray bits into proper bytes","__typename":"PreviewContent"}}</script><script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/manifest.d8c1ef95.js"></script><script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/vendors~main.a133fb80.chunk.js"></script><script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/main.4d7aa2a8.chunk.js"></script><script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/vendors~screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~scre~3e410f11.d2f0cb5c.chunk.js"></script>
<script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~screen.post~~4767c889.4d21fc30.chunk.js"></script>
<script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~screen.post~~73c4bb05.b17cddc8.chunk.js"></script>
<script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/screen.post~screen.post.amp~screen.profile~screen.sequence.library~screen.sequence.post~screen.stori~aba94ffa.e7eb6440.chunk.js"></script>
<script src="https://web.archive.org/web/20200117210221js_/https://cdn-client.medium.com/lite/static/js/screen.post.c54733eb.chunk.js"></script><script>window.main();</script></body></html><!--
     FILE ARCHIVED ON 21:02:21 Jan 17, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:16:07 Feb 20, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  LoadShardBlock: 67.641 (3)
  PetaboxLoader3.datanode: 89.242 (4)
  RedisCDXSource: 0.942
  exclusion.robots.policy: 0.342
  exclusion.robots: 0.356
  CDXLines.iter: 26.317 (3)
  captures_list: 98.904
  esindex: 0.012
  PetaboxLoader3.resolve: 85.294
  load_resource: 142.424
-->