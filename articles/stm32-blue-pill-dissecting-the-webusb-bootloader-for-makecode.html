<!doctype html><html lang="en"><head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app200.us.archive.org';v.server_ms=204;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="/_static/js/playback.bundle.js?v=bQvHU8mx" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=cRqOKCOw" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&sk=661984e9775f991a97e5747a67214b60","20191204194207","https://web.archive.org/","web","/_static/",
	      "1575488527");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=bsmaklHF" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->
<script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title data-rh="true">STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-02-15T17:01:46.544Z"/><meta data-rh="true" name="title" content="STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode"/><meta data-rh="true" property="og:title" content="STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode"/><meta data-rh="true" property="twitter:title" content="STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/b7f1a1508e89"/><meta data-rh="true" property="al:android:url" content="medium://p/b7f1a1508e89"/><meta data-rh="true" property="al:ios:url" content="medium://p/b7f1a1508e89"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="How the MakeCode Bootloader for Blue Pill implements flashing over WebUSB"/><meta data-rh="true" property="og:description" content="How  the MakeCode Bootloader for Blue Pill implements flashing over WebUSB"/><meta data-rh="true" property="twitter:description" content="How  the MakeCode Bootloader for Blue Pill implements flashing over WebUSB"/><meta data-rh="true" property="og:url" content="https://web.archive.org/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89"/><meta data-rh="true" property="og:image" content="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/1200/1*0P7BkmUox48Rak_cta48QA.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*0P7BkmUox48Rak_cta48QA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@ly.lee"/><meta data-rh="true" name="twitter:creator" content="@MisterTechBlog"/><meta data-rh="true" name="author" content="Lup Yuen Lee 李立源"/><meta data-rh="true" name="robots" content="index,follow"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="13 min read"/><meta data-rh="true" name="parsely-post-id" content="b7f1a1508e89"/><link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/web/20191204194207/https://medium.com/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://web.archive.org/web/20191204194207im_/https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://web.archive.org/web/20191204194207im_/https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://web.archive.org/web/20191204194207im_/https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://web.archive.org/web/20191204194207im_/https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="mask-icon" href="https://web.archive.org/web/20191204194207im_/https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"/><link data-rh="true" rel="icon" href="https://web.archive.org/web/20191204194207im_/https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://web.archive.org/web/20191204194207cs_/https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"/><link data-rh="true" rel="author" href="https://medium.com/@ly.lee"/><link data-rh="true" rel="canonical" href="https://web.archive.org/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89"/><link data-rh="true" rel="alternate" href="https://web.archive.org/web/20191204194207/android-app://com.medium.reader/https/medium.com/p/b7f1a1508e89"/><script data-rh="true" type="application/ld+json">{"@context":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttp:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*0P7BkmUox48Rak_cta48QA.png"],"url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89","dateCreated":"2019-02-15T17:01:46.544Z","datePublished":"2019-02-15T17:01:46.544Z","dateModified":"2019-02-15T19:17:55.701Z","headline":"STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode","name":"STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode","description":"How the MakeCode Bootloader for Blue Pill implements flashing over WebUSB","identifier":"b7f1a1508e89","keywords":["Lite:true","Tag:Programming","Tag:Gadgets","Tag:Internet of Things","Tag:Stm32","Topic:Gadgets","Topic:Programming","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC_UNENROLLED","LayerCake:3"],"author":{"@type":"Person","name":"Lup Yuen Lee 李立源","url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee"},"creator":["Lup Yuen Lee 李立源"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmiro.medium.com\u002Fmax\u002F616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://web.archive.org/web/20191204194207/https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://web.archive.org/web/20191204194207/https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="438" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(0, 0, 0, 0.84)}.r{display:block}.s{position:fixed}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ai{max-width:1192px}.aj{min-width:0}.ak{width:100%}.al{height:65px}.ao{flex:1 0 auto}.ap{font-family:'Helvetica Neue', sans-serif}.aq{font-size:20px}.ar{color:rgba(0, 0, 0, 0.84)}.as{margin-top:7px}.at{margin-left:10px}.au{display:-webkit-box}.av{-webkit-line-clamp:1}.aw{-webkit-box-orient:vertical}.ax{overflow:hidden}.bc{display:none}.be{margin-left:15px}.bf{margin-top:1px}.bg{visibility:hidden}.bh{flex:0 0 auto}.bi{color:inherit}.bj{fill:inherit}.bk{font-size:inherit}.bl{border:inherit}.bm{font-family:inherit}.bn{letter-spacing:inherit}.bo{font-weight:inherit}.bp{padding:0}.bq{margin:0}.br:hover{cursor:pointer}.bs:hover{color:rgba(0, 0, 0, 0.9)}.bt:hover{fill:rgba(0, 0, 0, 0.9)}.bu:focus{outline:none}.bv:disabled{cursor:default}.bw:disabled{color:rgba(0, 0, 0, 0.54)}.bx:disabled{fill:rgba(0, 0, 0, 0.54)}.by{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.bz{font-style:normal}.ca{line-height:20px}.cb{font-size:15.8px}.cc{letter-spacing:0px}.cd{color:rgba(0, 0, 0, 0.54)}.ce{fill:rgba(0, 0, 0, 0.54)}.cf{margin-left:16px}.cg{color:rgba(2, 158, 116, 1)}.ch{fill:rgba(3, 168, 124, 1)}.ci:hover{color:rgba(1, 143, 105, 1)}.cj:hover{fill:rgba(2, 158, 116, 1)}.ck:disabled{color:rgba(3, 168, 124, 0.5)}.cl:disabled{fill:rgba(3, 168, 124, 0.5)}.cm{padding:8px 16px}.cn{background:0}.co{border-color:rgba(3, 168, 124, 1)}.cp:hover{border-color:rgba(2, 158, 116, 1)}.cq{border-radius:4px}.cr{border-width:1px}.cs{border-style:solid}.ct{box-sizing:border-box}.cu{display:inline-block}.cv{text-decoration:none}.cw{margin-bottom:0px}.cy{padding-left:24px}.cz{padding-right:24px}.da{margin-left:auto}.db{margin-right:auto}.dc{max-width:728px}.dd{flex-direction:column}.de{position:absolute}.df{top:calc(100vh + 100px)}.dg{bottom:calc(100vh + 100px)}.dh{width:10px}.di{pointer-events:none}.dj{word-break:break-word}.dk{word-wrap:break-word}.dl:after{display:block}.dm:after{content:""}.dn:after{clear:both}.do{clear:both}.dp{margin-top:0px}.dq{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.dr{cursor:zoom-in}.ds{position:relative}.dt{z-index:auto}.du{opacity:0}.dv{transition:opacity 100ms 400ms}.dw{height:100%}.dx{will-change:transform}.dy{transform:translateZ(0)}.dz{margin:auto}.ea{background-color:rgba(0, 0, 0, 0.05)}.eb{padding-bottom:40.05947323704333%}.ec{filter:blur(20px)}.ed{transform:scale(1.1)}.ee{visibility:visible}.ef{background:rgba(255, 255, 255, 1)}.eg{max-width:680px}.eh{line-height:1.23}.ei{letter-spacing:0}.ej{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.ek{font-size:40px}.eq{margin-bottom:-0.27em}.er{line-height:48px}.es{margin-top:32px}.et{justify-content:space-between}.ex{width:48px}.ey{height:48px}.ez{flex-direction:row}.fa{width:calc(100% + 25px)}.fb{height:calc(100% + 25px)}.fc{top:50%}.fd{left:50%}.fe{transform:translateX(-50%) translateY(-50%)}.ff{border-radius:50%}.fg{margin-left:12px}.fh{margin-bottom:2px}.fj{font-weight:300}.fk{font-size:16px}.fl{max-height:20px}.fm{text-overflow:ellipsis}.fn:hover{text-decoration:underline}.fo{margin-left:8px}.fp{padding:0px 8px}.fq{border-color:rgba(0, 0, 0, 0.54)}.fr:hover{color:rgba(0, 0, 0, 0.97)}.fs:hover{fill:rgba(0, 0, 0, 0.97)}.ft:hover{border-color:rgba(0, 0, 0, 0.84)}.fu:disabled{fill:rgba(0, 0, 0, 0.76)}.fv:disabled{border-color:rgba(0, 0, 0, 0.2)}.fw:disabled{cursor:inherit}.fx:disabled:hover{color:rgba(0, 0, 0, 0.54)}.fy:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.fz:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.ga{line-height:18px}.gb{font-size:15px}.gc{align-items:flex-end}.gk{padding-right:8px}.gl{margin-right:-6px}.gm{line-height:1.58}.gn{letter-spacing:-0.004em}.go{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.gz{margin-bottom:-0.46em}.ha{background-repeat:repeat-x}.hb{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.hc{background-size:1px 1px}.hd{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.he{font-weight:700}.hf{font-style:italic}.hl{padding-bottom:75%}.hm{line-height:1.4}.hn{margin-top:10px}.ho{text-align:center}.hr{list-style-type:decimal}.hs{margin-left:30px}.ht{padding-left:0px}.hz{font-family:medium-content-slab-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.ia{font-size:28px}.ib{border:none}.ic{margin-top:30px}.id:before{content:"..."}.ie:before{letter-spacing:0.6em}.if:before{text-indent:0.6em}.ig:before{font-style:italic}.ih:before{line-height:1.4}.ii{line-height:1.12}.ij{letter-spacing:-0.022em}.ik{font-weight:600}.iv{margin-bottom:-0.28em}.jb{padding:2px 4px}.jc{font-size:75%}.jd> strong{font-family:inherit}.je{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jp{box-shadow:0 1px 4px rgba(0, 0, 0, 0.1), inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.jq{max-height:40px}.jr{-webkit-line-clamp:2}.js{padding:0px}.ki{padding:16px 20px}.kj{flex:1 1 auto}.kl{font-size:18px}.km{margin-top:8px}.kn{margin-top:12px}.ko{width:160px}.kp{background-image:url(https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/320/1*fjfoda1Ovwdahy09TwUkqA.png)}.kq{background-origin:border-box}.kr{background-size:cover}.ks{height:167px}.kt{background-position:50% 50%}.ku{max-width:100%}.kv{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.kw{padding:20px}.kx{background:rgba(0, 0, 0, 0.05)}.ky{overflow-x:auto}.kz{line-height:1.18}.la{margin-top:-0.09em}.lb{margin-bottom:-0.09em}.lc{white-space:pre-wrap}.ld{background-image:url(https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/320/0*DObDXKFSly6ip9jt)}.le{background-image:url(https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/320/1*sqHQVxWsmoA7_PW7j9_GJQ.png)}.lf{padding-bottom:24.520804114071996%}.lg{list-style-type:disc}.lh{padding-bottom:56.70202507232401%}.li{max-width:1726px}.lj{padding-bottom:71.14716106604867%}.lk{padding-bottom:86.79026651216685%}.ll{background-image:url(https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/320/1*Vxgr9fS45NRgtYPmDzkOgg.png)}.lm{background-image:url(https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/320/1*M3Y_T_EI28gPHHBXGxTmjw.png)}.ln{background-image:url(https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/320/1*nRCSpyqsYtpaJSNGwD13bQ.jpeg)}.lt{will-change:opacity}.lu{top:calc(65px + 54px + 40px)}.lx{width:131px}.ly{padding-top:28px}.lz{margin-bottom:19px}.ma{margin-left:-5px}.mb{margin-right:5px}.mc{outline:0}.md{border:0}.me{user-select:none}.mf{cursor:pointer}.mg> svg{pointer-events:none}.mh:active{border-style:none}.mi{-webkit-user-select:none}.mj{fill:rgba(0, 0, 0, 0.76)}.mk:focus{fill:rgba(0, 0, 0, 0.54)}.ml:hover{fill:rgba(0, 0, 0, 0.54)}.mm{margin-top:5px}.mn button{text-align:left}.mo{width:188px}.mp{transform:translateX(406px)}.mq{top:calc(65px + 54px + 14px)}.ms{margin-top:40px}.mt{flex-wrap:wrap}.mu{margin-top:25px}.mv{list-style-type:none}.mw{margin-right:8px}.mx{margin-bottom:8px}.my{border-radius:3px}.mz{padding:5px 10px}.na{line-height:22px}.nb{margin-top:15px}.nc{margin-right:16px}.nd{border:1px solid rgba(0, 0, 0, 0.1)}.ne{height:60px}.nf{width:60px}.ns:hover{border-color:rgba(0, 0, 0, 0.54)}.nt:active{border-style:solid}.nu{z-index:2}.nw{padding-top:32px}.nx{border-top:1px solid rgba(0, 0, 0, 0.1)}.ny{margin-bottom:25px}.nz{margin-bottom:32px}.oa{min-height:80px}.of{width:80px}.og{height:80px}.oh{padding-left:102px}.oj{text-transform:uppercase}.ok{letter-spacing:0.05em}.ol{margin-bottom:6px}.om{line-height:36px}.on{padding:4px 12px}.oo{max-width:555px}.op{max-width:450px}.oq{line-height:24px}.os{padding-top:25px}.ot{color:rgba(0, 0, 0, 0.76)}.ou{opacity:1}.ov{border:1px solid rgba(3, 168, 124, 1)}.ow{margin-top:64px}.ox{background-color:rgba(0, 0, 0, 0.02)}.oy{padding:60px 0}.oz{background-color:rgba(0, 0, 0, 0.9)}.pb{padding-bottom:48px}.pc{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.pd{margin:0 -12px}.pe{margin:0 12px}.pf{flex:1 1 0}.pg{padding-bottom:12px}.ph:hover{color:rgba(255, 255, 255, 0.99)}.pi:hover{fill:rgba(255, 255, 255, 0.99)}.pj:disabled{color:rgba(255, 255, 255, 0.7)}.pk:disabled{fill:rgba(255, 255, 255, 0.7)}.pl{color:rgba(255, 255, 255, 0.98)}.pm{fill:rgba(255, 255, 255, 0.98)}.pn{text-align:inherit}.po{font-size:21.6px}.pp{letter-spacing:-0.32px}.pq{color:rgba(255, 255, 255, 0.7)}.pr{fill:rgba(255, 255, 255, 0.7)}.ps{text-decoration:underline}.pt{padding-bottom:8px}.pu{padding-top:8px}.pv{width:200px}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ah{margin:0 64px}.ep{margin-top:0.78em}.gj{margin-left:30px}.gx{font-size:21px}.gy{margin-top:2em}.hk{margin-top:56px}.hy{margin-top:1.05em}.it{font-size:34px}.iu{margin-top:1.25em}.ja{margin-top:0.86em}.jj{margin-top:1.95em}.jo{margin-top:32px}.kf{padding-left:64px}.kg{padding-right:64px}.kh{max-width:1320px}.ls{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gi{margin-left:30px}.hp{margin-left:auto}.hq{text-align:center}.kc{padding-left:64px}.kd{padding-right:64px}.ke{max-width:1080px}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gh{margin-left:30px}.jz{padding-left:48px}.ka{padding-right:48px}.kb{max-width:904px}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.am{height:56px}.an{display:flex}.ay{font-size:14px}.az{margin-top:0px}.ba{margin-left:4px}.bb{-webkit-line-clamp:2}.bd{display:block}.cx{margin-bottom:0px}.ev{margin-top:32px}.ew{flex-direction:column-reverse}.gf{margin-bottom:30px}.gg{margin-left:0px}.jw{padding-left:24px}.jx{padding-right:24px}.jy{max-width:728px}.kk{padding:10px 12px 10px}.ob{margin-bottom:24px}.oc{align-items:center}.od{width:102px}.oe{position:relative}.oi{padding-left:0}.or{margin-top:24px}.pa{padding:32px 0}.pw{width:140px}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ac{margin:0 24px}.el{margin-top:0.39em}.eu{margin-top:32px}.fi{margin-bottom:0px}.gd{margin-bottom:30px}.ge{margin-left:0px}.gp{font-size:18px}.gq{margin-top:1.56em}.hg{margin-top:40px}.hu{margin-top:1.34em}.il{font-size:30px}.im{margin-top:0.93em}.iw{margin-top:0.67em}.jf{margin-top:1.2em}.jk{margin-top:24px}.jt{padding-left:24px}.ju{padding-right:24px}.jv{max-width:552px}.lo{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ag{margin:0 64px}.eo{margin-top:0.78em}.gv{font-size:21px}.gw{margin-top:2em}.hj{margin-top:56px}.hx{margin-top:1.05em}.ir{font-size:34px}.is{margin-top:1.25em}.iz{margin-top:0.86em}.ji{margin-top:1.95em}.jn{margin-top:32px}.lr{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.af{margin:0 48px}.en{margin-top:0.78em}.gt{font-size:21px}.gu{margin-top:2em}.hi{margin-top:56px}.hw{margin-top:1.05em}.ip{font-size:34px}.iq{margin-top:1.25em}.iy{margin-top:0.86em}.jh{margin-top:1.95em}.jm{margin-top:32px}.lq{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ae{margin:0 24px}.em{margin-top:0.39em}.gr{font-size:18px}.gs{margin-top:1.56em}.hh{margin-top:40px}.hv{margin-top:1.34em}.in{font-size:30px}.io{margin-top:0.93em}.ix{margin-top:0.67em}.jg{margin-top:1.2em}.jl{margin-top:24px}.lp{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="print">.ab{display:none}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.y{transition:transform 300ms ease}.z{will-change:transform}.lv{transition:opacity 200ms}.ng{transition:border-color 150ms ease}.nh::before{background:
      radial-gradient(circle, rgba(0, 0, 0, 0.84) 60%, transparent 70%)
    }.ni::before{border-radius:50%}.nj::before{content:""}.nk::before{display:block}.nl::before{z-index:0}.nm::before{left:0}.nn::before{height:100%}.no::before{position:absolute}.np::before{top:0}.nq::before{width:100%}.nr:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.nv{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (max-width: 1198px)">.lw{display:none}</style><style type="text/css" data-fela-rehydration="438" data-fela-type="RULE" media="all and (max-width: 1230px)">.mr{display:none}</style></head><body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:110px;padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php"
             title="Sign In"
             id="wm-sign-in"
          >
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share">
          <a href="/web/20191204194207/http://web.archive.org/screenshot/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&sk=661984e9775f991a97e5747a67214b60"
             id="wm-screenshot"
             title="screenshot">
            <span class="wm-icon-screen-shot"></span>
          </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&amp;sk=661984e9775f991a97e5747a67214b60" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&amp;sk=661984e9775f991a97e5747a67214b60" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&sk=661984e9775f991a97e5747a67214b60" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20191204194207" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap">Nov</td>
		  <td class="c" id="displayMonthEl" title="You are here: 19:42:07 Dec 04, 2019">DEC</td>
		  <td class="f" nowrap="nowrap">Jan</td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><img src="/_static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" /></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 19:42:07 Dec 04, 2019">04</td>
		  <td class="f" nowrap="nowrap"><img src="/_static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0" /></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap">2018</td>
		  <td class="c" id="displayYearEl" title="You are here: 19:42:07 Dec 04, 2019">2019</td>
		  <td class="f" nowrap="nowrap">2020</td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20191204194207*/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&sk=661984e9775f991a97e5747a67214b60" title="See a list of every capture for this URL">1 capture</a>
	      <div class="r" title="Timespan for captures of this URL">04 Dec 2019</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="650" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/ArchiveIt-Partner-1028);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/ArchiveIt-Partner-1028" target="_new"><span class="wm-title">Mark Graham&#39;s Archive-IT Collections</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  This is a set of web collections curated by Mark Graham using the <a href="http://archive-it.org">Archive-IT</a> service of the <a href="http//archive.org">Internet Archive.</a>
<br>
<br>
They include web captures of the ISKME.org website as well as captures from sites hosted by IGC.org.
<br>
<br>
<br><br>
These web captures are available to the general public.
<br>
<br>
For more information about this collection please feel free to contact Mark via <a href="mailto:mark@archive.org?Subject=Question%20about%20you%20Archive-IT%20Collection" target="_top">Send Mail</a>
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/ArchiveIt-Collection-8332)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/ArchiveIt-Collection-8332" target="_new"><span class="wm-title">General Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Archive-It Partner 1028: Mark Graham - Collection 8332: General Crawls
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20191204194207/https%3A//medium.com/%2540ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89%3Fsource%3Dfriends_link%26sk%3D661984e9775f991a97e5747a67214b60"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><script type="text/javascript">
__wm.bt(650,27,25,2,"web","https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=friends_link&sk=661984e9775f991a97e5747a67214b60","20191204194207",1996,"/_static/",["/_static/css/banner-styles.css?v=bsmaklHF","/_static/css/iconochive.css?v=qtvMKcIJ"]);
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT --><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y z ab"><div class="branch-journeys-top"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="al n o am an"><div class="r ao w"><div class="n o"><a aria-label="Homepage" rel="noopener" href="/web/20191204194207/https://medium.com/?source=post_page-----b7f1a1508e89----------------------"><div class="r g"><svg height="22" width="112" viewbox="0 0 111.5 22" class="q"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></div><div class="bc bd"><svg width="35" height="35" viewbox="5 5 35 35" class="q"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></div></a><div class="be bf r g"><svg width="2" height="29"><path d="M1 29V1" stroke="#D5D5D5" stroke-width="0.5" fill="none" stroke-linecap="round"></path></svg></div><div class="bg" id="lo-post-page-navbar-topic-copy"><a rel="noopener" href="/web/20191204194207/https://medium.com/topic/gadgets?source=post_page-----b7f1a1508e89----------------------"><div class="ap aq ar as at au av aw ax ay az ba bb">Gadgets</div></a></div></div></div><div class="r bh w"><div class="n o"><div class="n g"><div class="bg" id="lo-post-page-navbar-upsell-button"><div><a href="https://web.archive.org/web/20191204194207/https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><span class="by b bz ca cb cc r cd ce">Become a member</span></a></div></div><div class="bg" id="lo-post-page-navbar-sign-in-link"><div class="cf r"><span class="by b bz ca cb cc r cd ce"><a href="https://web.archive.org/web/20191204194207/https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89&amp;source=post_page-----b7f1a1508e89---------------------nav_reg-" class="cg ch bk bl bm bn bo bp bq br ci cj bu bv ck cl" rel="noopener">Sign in</a></span></div></div></div><div class="bg" id="lo-post-page-navbar-get-started-button"><div class="cf r"><button class="cm cn cg ch co ci cj cp br cq by b bz ca cb cc cr cs ct cu cv bu">Get started</button></div></div></div></div></div></div></div></div></nav><div class="cw al r cx am"></div><article class="meteredContent"><section class="cy cz da db ak dc ct n dd"></section><span class="r"></span><div><div class="de u df dg dh di"></div><section class="dj dk dl dm dn"><div class="do ak"><figure class="dp do ak paragraph-image"><div class="dq dr ds dt ak"><div class="dz r ds ea"><div class="eb r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*0P7BkmUox48Rak_cta48QA.png?q=20" width="4708" height="1886" role="presentation"/></div><img class="du dv de t u dw ak ef" width="4708" height="1886" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/9416/1*0P7BkmUox48Rak_cta48QA.png" width="4708" height="1886" role="presentation"/></noscript></div></div></div></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><div><div id="8c8f" class="eh ei ar bz ej b ek el em en eo ep eq"><h1 class="ej b ek er ar">STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode</h1></div><div class="es"><div class="n et eu ev ew"><div class="o n"><div><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee?source=post_page-----b7f1a1508e89----------------------"><div class="ds ex ey"><div class="ch n ez o p de fa fb fc fd fe di"><svg width="57" height="57" viewbox="0 0 57 57"><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5 1.2A27.45 27.45 0 0 0 4.06 15.82L3 15.27A28.65 28.65 0 0 1 28.5 0C39.64 0 49.29 6.2 54 15.27l-1.06.55A27.45 27.45 0 0 0 28.5 1.2zM4.06 41.18A27.45 27.45 0 0 0 28.5 55.8a27.45 27.45 0 0 0 24.44-14.62l1.06.55A28.65 28.65 0 0 1 28.5 57 28.65 28.65 0 0 1 3 41.73l1.06-.55z"></path></svg></div><img alt="Lup Yuen Lee 李立源" class="r ff ey ex" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/fit/c/96/96/1*KGohS3sQaUnr58gc0BIfoQ.jpeg" width="48" height="48"/></div></a></div><div class="fg ak r"><div class="n"><div style="flex:1"><span class="by b bz ca cb cc r ar q"><div class="fh n o fi"><span class="by fj fk ca ax fl fm au av aw ar"><a class="bi bj bk bl bm bn bo bp bq br fn bu bv bw bx" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee?source=post_page-----b7f1a1508e89----------------------">Lup Yuen Lee 李立源</a></span><div class="fo r bh h"><button class="fp ar q cn fq fr fs ft br bw fu fv fw fx fy fz cq by b bz ga gb cc cr cs ct cu cv bu">Follow</button></div></div></span></div></div><span class="by b bz ca cb cc r cd ce"><span class="by fj fk ca ax fl fm au av aw cd"><div><a class="bi bj bk bl bm bn bo bp bq br fn bu bv bw bx" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89?source=post_page-----b7f1a1508e89----------------------">Feb 15</a> <!-- -->·<!-- --> <!-- -->13<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewbox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div><div class="n gc gd ge gf gg gh gi gj ab"><div class="n o"><div class="gk r bh"><a href="//web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/share/twitter?source=post_actions_header---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" target="_blank" rel="noopener"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="gk r bh"><a href="//web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/share/linkedIn?source=post_actions_header---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" target="_blank" rel="noopener"><svg width="29" height="29" viewbox="0 0 29 29" fill="none" class="q"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></a></div><div class="gk r bh"><a href="//web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/share/facebook?source=post_actions_header---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" target="_blank" rel="noopener"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="gl r ao"><div><div class="cu"><a href="https://web.archive.org/web/20191204194207/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89&amp;source=post_actions_header--------------------------bookmark_sidebar-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><svg width="25" height="25" viewbox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div><p id="d978" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Could <a href="https://web.archive.org/web/20191204194207/http://wiki.stm32duino.com/index.php?title=Blue_Pill" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">STM32 Blue Pill</a> overtake Arduino as the <strong class="go he">preferred platform for creating IoT prototypes?</strong></p><p id="f241" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">1️⃣ Blue Pill is <strong class="go he">packed with features</strong>, yet costs <strong class="go he">under US$ 2</strong></p><p id="5d99" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">2️⃣ <strong class="go he">Cheaper Blue Pill clones</strong> are now emerging. No signs of Blue Pill fatigue.</p><p id="76af" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">3️⃣ Microcontrollers are joining <strong class="go he">mesh networks</strong> to become smarter collectives. Cheap microcontrollers like Blue Pill are needed.</p><p id="9df0" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">4️⃣ The closest competitor, <strong class="go he">ESP8266 / ESP32</strong>, is still slowly growing its software base from scratch (though the embedded WiFi is a huge advantage)</p><p id="f4a0" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">5️⃣ Blue Pill developers have <strong class="go he">plenty of open-source Arm and STM32 code</strong> to guide them</p><p id="c014" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">So what’s holding back Blue Pill? <em class="hf">Blue Pill is way more advanced than the ancient Arduino Uno, yet we are still using the same primitive coding tools… </em><strong class="go he"><em class="hf">a text editor and a C compiler.</em></strong></p><p id="9613" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">There must be a modern, easier way to write Blue Pill programs. Maybe we should sacrifice a bit of Blue Pill’s processing power to make it faster and friendlier to code and test. And this leads to MakeCode, the popular web-based tool for programming and flashing microcontrollers…</p></div></div><div class="do ak"><figure class="hg hh hi hj hk do"><div class="dz r ds"><div class="hl r"><iframe src="https://web.archive.org/web/20191204194207if_/https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FDSNDvrVOJns%3Ffeature%3Doembed&amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DDSNDvrVOJns&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FDSNDvrVOJns%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" allowfullscreen="" frameborder="0" height="480" width="640" title="STM32 Blue Pill USB Bootloader and MakeCode" class="de t u dw ak" scrolling="auto"></iframe></div></div><figcaption class="cd fk hm hn ho dc da db hp hq by fj">Creating a MakeCode visual program and flashing to Blue Pill</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><p id="8ac4" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz"><a href="https://web.archive.org/web/20191204194207/https://makecode.com/about" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><strong class="go he">MakeCode</strong></a> is an open-source <strong class="go he">visual programming tool</strong> that’s easy to learn and use — makers around the world are already using MakeCode today with the BBC micro:bit. It generates <a href="https://web.archive.org/web/20191204194207/https://makecode.com/language" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><strong class="go he">Static TypeScript</strong></a>, a variant of JavaScript that’s optimised for newer powerful microcontrollers like Blue Pill. <em class="hf">MakeCode could be the missing element that will make Blue Pill wildly successful for IoT.</em></p><p id="f46e" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Will MakeCode run on Blue Pill? There’s no official port of MakeCode for Blue Pill, but we’re nearly there. I have ported the most complicated part of MakeCode to Blue Pill: the <strong class="go he">MakeCode Bootloader</strong>. If the MakeCode Bootloader runs on Blue Pill, the rest is a piece of cake!</p><p id="0c84" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">In this article we’ll take our surgical scalpels, dissect and explore the innards of the MakeCode Bootloader that I have ported to Blue Pill. We’ll learn…</p><ol class=""><li id="54b7" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz hr hs ht">What’s a <strong class="go he">Bootloader</strong> and why we need a <strong class="go he">Custom Bootloader</strong></li><li id="9c81" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz hr hs ht"><strong class="go he">CODAL</strong> runtime library used by MakeCode to execute Blue Pill-specific functions</li><li id="8dc0" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz hr hs ht">How the <strong class="go he">Bootloader uses Blue Pill memory optimally</strong></li><li id="f6de" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz hr hs ht"><strong class="go he">HF2 Protocol</strong> used by MakeCode and the Bootloader to flash the Blue Pill</li><li id="bc88" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz hr hs ht"><strong class="go he">Linker Script</strong> used to create the Bootloader memory layout</li></ol><p id="e56c" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">What’s a visual program? <a href="https://web.archive.org/web/20191204194207/https://youtu.be/P8GDrmWWSbk" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Check this video</a> to see how MakeCode may be used to write a visual program that blinks the Blue Pill LED.</p></div></div></section><hr class="hz fj ia ib ic ho id ie if ig ih"/><section class="dj dk dl dm dn"><div class="n p"><div class="ac ae af ag ah eg aj ak"><h1 id="16d5" class="ii ij ar bz by ik il im in io ip iq ir is it iu iv">What’s A Bootloader?</h1><p id="15ae" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz">Well it <strong class="go he">boots</strong> and it <strong class="go he">loads</strong>… Duh.</p><p id="54b9" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz"><strong class="go he">Boot</strong>: The Bootloader is a small program that’s pre-installed in the ROM of the microcontroller. It’s the first program that runs when we power on the device. Normally the Bootloader will jump to the custom program that we have flashed into the ROM (assuming it has been flashed). So most of the time we won’t notice that the Bootloader is actually started before our custom program.</p><p id="7a08" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz"><strong class="go he">Load</strong>: The Bootloader enables us to load (or flash) our custom program into ROM. On the Arduino Uno, the Bootloader receives our custom program file via the USB Serial Port and flashes the custom program into ROM. For Blue Pill, the factory-installed Bootloader works the same way except that it uses the UART pins instead of the USB port. See<em class="hf"> </em><a href="https://web.archive.org/web/20191204194207/https://www.st.com/content/ccc/resource/technical/document/application_note/51/5f/03/1e/bd/9b/45/be/CD00264342.pdf/files/CD00264342.pdf/jcr:content/translations/en.CD00264342.pdf" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><em class="hf">AN3155: USART protocol used in the STM32 bootloader</em></a> and <a href="https://web.archive.org/web/20191204194207/https://www.st.com/content/ccc/resource/technical/document/application_note/b9/9b/16/3a/12/1e/40/0c/CD00167594.pdf/files/CD00167594.pdf/jcr:content/translations/en.CD00167594.pdf" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><em class="hf">AN2606: STM32 microcontroller system memory boot mode</em></a>.</p><p id="090f" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Remember that we set the <code class="ea jb jc jd je b">BOOT0</code> jumper to <code class="ea jb jc jd je b">0</code> while flashing Blue Pill via ST Link? This disables the factory-installed Bootloader so we don’t actually flash the custom program via the UART pins. ST Link uses the SWD port on the Blue Pill to flash our custom program into the ROM.</p><h1 id="af68" class="ii ij ar bz by ik il jf in jg ip jh ir ji it jj iv">Why Build A Custom Bootloader?</h1><p id="4960" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz">Flashing the Blue Pill via the bare UART pins or the SWD port (via ST Link) is cumbersome. What if we could simply <strong class="go he">click a button in a web page, and transmit our custom program directly into the Blue Pill ROM</strong>? And how would we connect the Blue Pill to our computer? Just use the <strong class="go he">USB port</strong> that’s already provided on Blue Pill! <em class="hf">Flashing the Blue Pill would become so easy — just like in the demo above!</em></p><p id="fe22" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz"><strong class="go he"><em class="hf">But there’s a catch (or two)…</em></strong></p><p id="f15e" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">1️⃣ <strong class="go he">The Blue Pill’s USB port doesn’t have any built-in functionality.</strong> (Surprised? Many of my students assumed that the Blue Pill USB port actually did <em class="hf">something</em>.) We need to write the Blue Pill code to perform the flashing over USB. And the code will go into a <strong class="go he">Custom Bootloader</strong> that we’ll install ourselves into our new Blue Pills. Once installed, we shouldn’t need to re-flash the Custom Bootloader <em class="hf">(although there’s actually an easy way to do this… in our next article!)</em></p><p id="642a" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">2️⃣ <strong class="go he">Web Browsers won’t allow us to access all types of USB devices (e.g. Blue Pill) directly through a web page, for safety reasons</strong>. The Chrome browser provides the <a href="https://web.archive.org/web/20191204194207/https://developers.google.com/web/updates/2016/03/access-usb-devices-on-the-web" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><strong class="go he">WebUSB JavaScript API</strong></a> for safely accessing some USB devices, including Blue Pill. With the right code in the web page and the right code in the Custom Bootloader, we’ll see in a while that it’s indeed possible to flash the Blue Pill via a web page, as we have seen in the demo above.</p><p id="7ea0" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">So this article is all about the <strong class="go he">internals of the Custom Bootloader for Blue Pill that supports flashing over WebUSB</strong>. Details on implementing WebUSB on Blue Pill may be found in <a class="bi cv ha hb hc hd" target="_blank" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c?source=friends_link&amp;sk=70a29cd31425ec4d03144bce14a1c922">my earlier article</a>.</p><div class="jk jl jm jn jo jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">STM32 Blue Pill USB Bootloader — How I fixed the USB Storage, Serial, DFU and WebUSB interfaces</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Building a complex composite USB device with libopencm3 that works on Windows, Mac and Linux</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="kp r kq kr ks ko kt ku kv"></div></div></section></a></div></div></div></section><hr class="hz fj ia ib ic ho id ie if ig ih"/><section class="dj dk dl dm dn"><div class="n p"><div class="ac ae af ag ah eg aj ak"><div class="hg hh hi hj hk jp"><a href="https://web.archive.org/web/20191204194207/https://lancaster-university.github.io/codal/?source=post_page-----b7f1a1508e89----------------------" rel="noopener nofollow"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">CODAL</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Information on the Component Oriented Device Abstraction Layer (CODAL), created and maintained by Lancaster University.</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">lancaster-university.github.io</div></h4></div></div></section></a></div><h1 id="a2de" class="ii ij ar bz by ik il jf in jg ip jh ir ji it jj iv">CODAL Runtime for Embedded Devices</h1><p id="5671" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz">The <a href="https://web.archive.org/web/20191204194207/https://lancaster-university.github.io/codal/" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">CODAL runtime library created by Lancaster University</a> provides a friendly and flexible C++ API for programming embedded devices. MakeCode compiles our visual programs into Static TypeScript code that calls the CODAL library to access the device and peripheral functions like the onboard LED and ports for UART, I2C, SPI, …</p><p id="1d1f" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Here’s a <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/samples/main.cpp" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">sample CODAL program that blinks the LED</a>…</p><pre class="hg hh hi hj hk kw kx ky"><span id="e934" class="kz ij ar bz je b fk la lb r lc">void Blink_main(<strong class="je he">STM32BluePill</strong>&amp; device) {<br/> int state = 0;<br/> while(1) {    <br/><strong class="je he">   device.io.led.setDigitalValue(state);<br/></strong>   device.sleep(1000);<br/>   state = !state;<br/> }<br/>}</span></pre><p id="0122" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Comparing this with the <a href="https://web.archive.org/web/20191204194207/https://www.arduino.cc/en/tutorial/blink" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">same Arduino program that blinks the LED</a>, it doesn’t look that different. But note that the onboard LED is neatly encapsulated as <code class="ea jb jc jd je b"><strong class="go he">device.io.led</strong></code>. <code class="ea jb jc jd je b">device</code> is an <code class="ea jb jc jd je b"><a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/model/STM32BluePill.h" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><strong class="go he">STM32BluePill</strong></a></code> object that’s defined as…</p><pre class="hg hh hi hj hk kw kx ky"><span id="9810" class="kz ij ar bz je b fk la lb r lc">class STM32BluePill : public CodalComponent {<br/>public:<br/>  Timer              timer;<br/>  MessageBus         messageBus;<br/>  STM32BluePillIO    io;<br/>  I2C                i2c1;<br/>  SPI                spi1;<br/>  SPI                spi2;<br/>  Serial             usart2;</span></pre><p id="decb" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Wow we have just dissected the Blue Pill to reveal its innards: the system timer, I2C port, SPI port, USART port, … Each of these are CODAL objects that expose methods for accessing the device and port-specific functions. The <code class="ea jb jc jd je b">led</code> object we saw earlier is just another CODAL object defined in <code class="ea jb jc jd je b">STM32BluePillIO</code>.</p><p id="beba" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">CODAL gives us a clean way to write embedded programs in C++ that will work with many types of modern microcontrollers, without resorting to Arduino’s preprocessor symbols like in <code class="ea jb jc jd je b">digitalWrite(LED_BUILTIN, HIGH)</code>.</p><p id="7c1e" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">CODAL is officially supported for <a href="https://web.archive.org/web/20191204194207/https://github.com/lancaster-university/codal-mbed" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Arm microcontrollers</a> that use Arm’s Mbed device library (including the <a href="https://web.archive.org/web/20191204194207/https://github.com/lancaster-university/microbit-dal" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">BBC micro:bit</a>). However Mbed is not optimised for Blue Pill so I have ported CODAL to Blue Pill using the optimised open-source <a href="https://web.archive.org/web/20191204194207/https://github.com/libopencm3/libopencm3/wiki" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">libopencm3</a> library instead…</p><div class="jk jl jm jn jo jp"><a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3?source=post_page-----b7f1a1508e89----------------------" rel="noopener nofollow"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">lupyuen/codal-libopencm3</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Codal framework ported to libopencm3 to support MakeCode on STM32 Blue Pill - lupyuen/codal-libopencm3</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">github.com</div></h4></div></div><div class="ko r"><div class="ld r kq kr ks ko kt ku kv"></div></div></section></a></div><p id="ea2e" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">From here onwards, we’ll use the term “CODAL” to refer to the Blue Pill version of CODAL. We’ll now look at the challenges in squeezing CODAL to run on Blue Pill, coexisting with the Bootloader.</p></div></div></section><hr class="hz fj ia ib ic ho id ie if ig ih"/><section class="dj dk dl dm dn"><div class="n p"><div class="ac ae af ag ah eg aj ak"><div class="hg hh hi hj hk jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">STM32 Blue Pill — Analyse and Optimise Your RAM and ROM</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Tips and tools to prevent Blue Pill Bloat</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="le r kq kr ks ko kt ku kv"></div></div></section></a></div><h1 id="1d5c" class="ii ij ar bz by ik il jf in jg ip jh ir ji it jj iv">Memory Layout for Bootloader</h1><p id="1b01" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz">In <a class="bi cv ha hb hc hd" target="_blank" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7?source=friends_link&amp;sk=54719084d640bb1d92ac1097d623bba2">my article on memory optimisation</a>, we learnt that the Blue Pill has <strong class="go he">64 KB of ROM</strong>, from address <code class="ea jb jc jd je b">0x0800 0000</code> to <code class="ea jb jc jd je b">0x0801 0000</code>. Assuming that we can use all 64 KB of ROM, our MakeCode Application (the one we created through drag-and-drop) will fill up the available ROM like this…</p></div></div><div class="do ak"><figure class="hg hh hi hj hk do ak paragraph-image"><div class="dq dr ds dt ak"><div class="dz r ds ea"><div class="lf r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*yso3pjwk8Vkvb3GxOqwkgg.png?q=20" width="4278" height="1049" role="presentation"/></div><img class="du dv de t u dw ak ef" width="4278" height="1049" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/8556/1*yso3pjwk8Vkvb3GxOqwkgg.png" width="4278" height="1049" role="presentation"/></noscript></div></div></div><figcaption class="cd fk hm hn ho dc da db hp hq by fj">Memory Layout for MakeCode Application</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><p id="651c" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">MakeCode compiles our visual program into <strong class="go he">Arm Cortex machine code </strong>(not into intermediate bytecode), so the compiled MakeCode App appears to Blue Pill like any other C function. The compiled MakeCode App calls the <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">CODAL library</a> to execute Blue Pill device functions. To do its job, CODAL needs to call some friends…</p><ul class=""><li id="a327" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz lg hs ht"><strong class="go he">libopencm3</strong>: The <a href="https://web.archive.org/web/20191204194207/https://github.com/libopencm3/libopencm3/wiki" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">open-source library</a> for Blue Pill device functions</li><li id="8e8b" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz lg hs ht"><strong class="go he">nano-float</strong>:<a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/tree/master/lib/nano-float" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"> Math library</a> optimised for Blue Pill. Includes <a href="https://web.archive.org/web/20191204194207/https://www.quinapalus.com/qfplib.html" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Qfplib</a>. I wrote about nano-float <a class="bi cv ha hb hc hd" target="_blank" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-shrink-your-math-libraries-with-qfplib-55093aab163a?source=friends_link&amp;sk=d7cd162dabcc45f96490e5e1f5f4c534">in this article</a> and the <a class="bi cv ha hb hc hd" target="_blank" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-unit-testing-with-qemu-blue-pill-emulator-9d88002a68b2?source=friends_link&amp;sk=9a9389cdea5828cb48713f963c8f7615">Unit Testing</a> too.</li><li id="7ba2" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz lg hs ht"><strong class="go he">newlib</strong>: <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/newlib/tree/master" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Standard C library</a> optimised for Blue Pill</li><li id="73d2" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz lg hs ht"><strong class="go he">logger</strong>: <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/tree/master/stm32/logger" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Library for logging</a> errors and diagnostic messages</li><li id="2836" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz lg hs ht"><strong class="go he">bluepill</strong>: <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/tree/master/stm32/bluepill" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Common functions</a> for Real-Time Clock and System Timers</li><li id="0077" class="gm gn ar bz go b gp hu gr hv gt hw gv hx gx hy gz lg hs ht"><strong class="go he">hal</strong>: <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/tree/master/stm32/hal" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Hardware Adaptation Layer</a>, called by CODAL</li></ul><p id="ed9c" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">What’s missing from the picture? The <strong class="go he">Bootloader</strong> of course! Without the Bootloader, we won’t be able to flash the MakeCode App to Blue Pill via the web browser. Let’s add the Bootloader…</p></div></div><div class="do ak"><figure class="hg hh hi hj hk do ak paragraph-image"><div class="dq dr ds dt ak"><div class="dz r ds ea"><div class="lf r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*6-mdzt_0NGcai867jdRFJw.png?q=20" width="4278" height="1049" role="presentation"/></div><img class="du dv de t u dw ak ef" width="4278" height="1049" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/8556/1*6-mdzt_0NGcai867jdRFJw.png" width="4278" height="1049" role="presentation"/></noscript></div></div></div><figcaption class="cd fk hm hn ho dc da db hp hq by fj">Memory Layout after adding Bootloader</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><p id="fb1e" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Now we have a problem… 1️⃣ <strong class="go he">CODAL calls the libopencm3 library</strong> to access the Blue Pill device functions 2️⃣ <strong class="go he">Bootloader needs the libopencm3 library</strong> to write to flash memory and to access the USB port. So we have <strong class="go he">TWO copies</strong> of the libopencm3 code in ROM.</p><p id="3421" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">We don’t have enough ROM space for two copies of libopencm3, so let’s use only one copy of libopencm3, shared by the <strong class="go he">Application</strong> (CODAL + MakeCode App) and the <strong class="go he">Bootloader</strong>…</p></div></div><div class="do ak"><figure class="hg hh hi hj hk do ak paragraph-image"><div class="dq dr ds dt ak"><div class="dz r ds ea"><div class="lf r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*afGJhqhuce_Ld0b6Eks1kw.png?q=20" width="4278" height="1049" role="presentation"/></div><img class="du dv de t u dw ak ef" width="4278" height="1049" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/8556/1*afGJhqhuce_Ld0b6Eks1kw.png" width="4278" height="1049" role="presentation"/></noscript></div></div></div><figcaption class="cd fk hm hn ho dc da db hp hq by fj">Memory Layout optimised for Application + Bootloader</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><p id="e92a" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">For clarity, we segregate the Bootloader and the Application into two Memory Regions: <code class="ea jb jc jd je b"><strong class="go he">bootrom</strong></code> (for Bootloader) and <code class="ea jb jc jd je b"><strong class="go he">rom</strong></code> (for Application). Recall that the Application (<code class="ea jb jc jd je b">rom</code>) will be updated more often than the Bootloader (<code class="ea jb jc jd je b">bootrom</code>).</p><p id="5001" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">This Bootloader design is rarely used in real life because it needs the <strong class="go he">Bootloader and the Application to be carefully matched by code version.</strong> Otherwise the Application might call a shared function (in libopencm3, for example) using an older address that’s no longer valid in the current Bootloader.</p><p id="dfc1" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">How do we tell the Blue Pill compiler and linker to use this memory layout? We define the memory layout in the <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/ld/stm32f103x8.ld" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Linker Script</a>. The details may be found in the <em class="hf">“For Advanced Programmers: Linker Script for Bootloader”</em> section below.</p></div></div></section><hr class="hz fj ia ib ic ho id ie if ig ih"/><section class="dj dk dl dm dn"><div class="n p"><div class="ac ae af ag ah eg aj ak"><h1 id="d175" class="ii ij ar bz by ik il im in io ip iq ir is it iu iv">WebUSB Flashing with the HF2 Protocol</h1><p id="5c9c" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz">The <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/tree/master/stm32/bootloader" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">WebUSB Bootloader</a> that I have implemented for Blue Pill (adapted from <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/bootloader/README.md" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">various sources</a>) is a hefty embedded program taking <strong class="go he">29 KB of ROM</strong> space. Why is it so huge? Because it supports…</p><p id="ebdd" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">1️⃣ <strong class="go he">WebUSB and WinUSB</strong> protocols. Allows the MakeCode website to access the Blue Pill via USB through the Chrome web browser, without installing any drivers. I wrote about WebUSB and WinUSB <a class="bi cv ha hb hc hd" target="_blank" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c?source=friends_link&amp;sk=70a29cd31425ec4d03144bce14a1c922">in this article</a>.</p><p id="9346" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">2️⃣ <strong class="go he">USB Serial Port</strong> (<a href="https://web.archive.org/web/20191204194207/https://en.wikipedia.org/wiki/USB_communications_device_class" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">USB CDC</a>) for debug logging</p><p id="c131" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">3️⃣ <a href="https://web.archive.org/web/20191204194207/https://github.com/Microsoft/uf2/blob/master/hf2.md" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"><strong class="go he">HF2 Protocol</strong></a> for flashing Blue Pill via WebUSB</p><p id="36f1" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">4️⃣ And remember that the Bootloader includes <strong class="go he">libopencm3 and other common functions</strong> used by the MakeCode Application, due to the way we partitioned the ROM space into Bootloader and Application regions.</p><p id="fe8e" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">How do we tell Blue Pill that we want to flash a new Application into ROM? Do we press a button on Blue Pill to enter Bootloader Mode, <a href="https://web.archive.org/web/20191204194207/https://learn.adafruit.com/makecode/downloading-and-flashing" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">like on some MakeCode devices</a>?</p><p id="8214" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Not so! The demo above shows that the flashing of Blue Pill is fully automated and triggered by the web browser, when we click the <code class="ea jb jc jd je b">Download</code> button in the MakeCode web page. How does this work?</p><p id="aa78" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">While the Application runs on Blue Pill (we call this the <strong class="go he">Application Mode</strong>), the Bootloader is called periodically to check for USB requests. When the Bootloader receives a request for flashing, it restarts the Blue Pill into <strong class="go he">Bootloader Mode</strong> to perform the flashing. The Application doesn’t run until the flashing has been completed.</p></div></div><div class="do ak"><figure class="hg hh hi hj hk do ak paragraph-image"><div class="dz r ds ea"><div class="lh r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*kciuJ3Kl_p9eC1cVE9hOPw.png?q=20" width="2074" height="1176" role="presentation"/></div><img class="du dv de t u dw ak ef" width="2074" height="1176" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/4148/1*kciuJ3Kl_p9eC1cVE9hOPw.png" width="2074" height="1176" role="presentation"/></noscript></div></div></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><p id="386b" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">The flashing magic is made possible by the <strong class="go he">HF2 Protocol</strong> implemented in the <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/stm32bluepill-makecode" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">MakeCode website</a> and in the Bootloader code. The MakeCode website <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/pxt/blob/master/pxtlib/hf2.ts" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">transmits HF2 command packets</a> via in-browser JavaScript, via the WebUSB JavaScript API, via the WinUSB driver (on Windows), finally to the USB port of the Blue Pill.</p><p id="fa37" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">The <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/bootloader/hf2.c" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Blue Pill Bootloader</a> receives the HF2 command packets and executes them, switching between Application and Bootloader Modes when necessary.</p><p id="c82a" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Here’s the overall flow of the HF2 flashing process as implemented in our <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/bootloader/hf2.c#L101-L215" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Blue Pill WebUSB Bootloader</a>…</p><figure class="hg hh hi hj hk do da db paragraph-image"><div class="dq dr ds dt ak"><div class="da db li"><div class="dz r ds ea"><div class="lj r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*niQsB5ijxu28x4dj3naRiw.png?q=20" width="1726" height="1228" role="presentation"/></div><img class="du dv de t u dw ak ef" width="1726" height="1228" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/3452/1*niQsB5ijxu28x4dj3naRiw.png" width="1726" height="1228" role="presentation"/></noscript></div></div></div></div></figure><p id="2f2b" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">1️⃣ MakeCode website first sends the <code class="ea jb jc jd je b">BININFO</code> command. Blue Pill returns the current mode (Application or Bootloader Mode), and the flash memory size (64 KB).</p><p id="f7df" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">2️⃣ MakeCode then sends the <code class="ea jb jc jd je b">INFO</code> command. Blue Pill returns the identity of the device e.g. <code class="ea jb jc jd je b">STM32BLUEPILL</code>.</p><p id="2696" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">3️⃣ MakeCode sends <code class="ea jb jc jd je b">START_FLASH</code>. Blue Pill restarts in Bootloader Mode to begin flashing.</p><figure class="hg hh hi hj hk do da db paragraph-image"><div class="dq dr ds dt ak"><div class="da db li"><div class="dz r ds ea"><div class="lk r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*8BrNvbyovzAuZDjn9yTrlg.png?q=20" width="1726" height="1498" role="presentation"/></div><img class="du dv de t u dw ak ef" width="1726" height="1498" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/3452/1*8BrNvbyovzAuZDjn9yTrlg.png" width="1726" height="1498" role="presentation"/></noscript></div></div></div></div></figure><p id="ed5f" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">4️⃣ For each 1 KB page of data to be flashed, MakeCode sends the <code class="ea jb jc jd je b">WRITE_FLASH_PAGE</code> command and the data to be flashed. Blue Pill compares the received data with the current ROM data. If the data is different, it writes the received data to ROM. This is only applicable for the Application ROM, not the Bootloader ROM.</p><p id="3328" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">5️⃣ MakeCode sends <code class="ea jb jc jd je b">RESET_INTO_APP</code>. Blue Pill restarts in Application Mode and runs the flashed Application.</p><p id="6fe6" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">What if the Bootloader needs to be upgraded? The same flow works for upgrading the Bootloader as well. In the next article I’ll explain how the <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/tree/master/stm32/baseloader" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Baseloader</a> upgrades the Bootloader code.</p></div></div></section><hr class="hz fj ia ib ic ho id ie if ig ih"/><section class="dj dk dl dm dn"><div class="n p"><div class="ac ae af ag ah eg aj ak"><h1 id="5c8c" class="ii ij ar bz by ik il im in io ip iq ir is it iu iv">What’s Next?</h1><p id="4055" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz">The WebUSB Bootloader for MakeCode on Blue Pill is incredibly complex — it required four articles (plus this article) to explain the topics that we have covered today…</p><p id="7026" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">1️⃣ We implemented the WebUSB and WinUSB interfaces on Blue Pill…</p><div class="jk jl jm jn jo jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">STM32 Blue Pill USB Bootloader — How I fixed the USB Storage, Serial, DFU and WebUSB interfaces</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Building a complex composite USB device with libopencm3 that works on Windows, Mac and Linux</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="kp r kq kr ks ko kt ku kv"></div></div></section></a></div><p id="4e43" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">2️⃣ We applied memory optimisation tools and techniques to squeeze the Bootloader into Blue Pill…</p><div class="jk jl jm jn jo jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">STM32 Blue Pill — Analyse and Optimise Your RAM and ROM</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Tips and tools to prevent Blue Pill Bloat</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="le r kq kr ks ko kt ku kv"></div></div></section></a></div><p id="38d8" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">3️⃣ We created nano-float, an optimised version of the standard math library…</p><div class="jk jl jm jn jo jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-shrink-your-math-libraries-with-qfplib-55093aab163a?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">STM32 Blue Pill – Shrink your math libraries with Qfplib</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Floating-point math libraries can bloat your Blue Pill code. Here’s one way to fix that</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="ll r kq kr ks ko kt ku kv"></div></div></section></a></div><p id="60d5" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">4️⃣ And we verified the accuracy of the nano-float library through Unit Testing…</p><div class="jk jl jm jn jo jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-unit-testing-with-qemu-blue-pill-emulator-9d88002a68b2?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">STM32 Blue Pill — Unit Testing with Qemu Blue Pill Emulator</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Unit Testing can help to stop bugs before they pollute the entire IoT chain</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="lm r kq kr ks ko kt ku kv"></div></div></section></a></div><p id="1c37" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">5️⃣ We have one upcoming article that explains how the Baseloader upgrades the Bootloader.</p><p id="e041" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">It’s been a long journey —<strong class="go he"> join me if you’re keen to complete the Blue Pill port of MakeCode!</strong> So that we’ll finally have the perfect platform to build and test IoT prototypes.</p><p id="b3c7" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">There are too many topics to cover, so I kept a log of all things that I have tried (even the failed ones)…</p><div class="jk jl jm jn jo jp"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/work-in-progress-stm32-blue-pill-visual-programming-with-makecode-codal-and-libopencm3-422d308f252e?source=post_page-----b7f1a1508e89----------------------"><section class="js da db ak ct n bh jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="ki n dd p kj kk"><h2 class="by ik kl ca ar"><div class="ax jq fm au jr aw">[Work In Progress] STM32 Blue Pill Visual Programming with MakeCode, CODAL and libopencm3</div></h2><div class="km r"><h3 class="by fj fk ca cd"><div class="ax jq fm au jr aw">Note: This work-in-progress document describes an incomplete implementation of STM32 Blue Pill visual programming. The…</div></h3></div><div class="kn r"><h4 class="by fj gb ca cd"><div class="ax jq fm au jr aw">medium.com</div></h4></div></div><div class="ko r"><div class="ln r kq kr ks ko kt ku kv"></div></div></section></a></div><p id="427a" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Why not port MicroPython to Blue Pill? <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/send_altitude_cocoos/tree/micropython/lib/bluepill-micropython/ports/bluepill" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">I tried but failed miserably</a>. MicroPython was designed for dynamic memory allocation, which works poorly on Blue Pill’s constrained RAM. Unlike MakeCode, which implements Static TypeScript without dynamic memory.</p><p id="345d" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">Look forward to having you onboard the Blue Pill MakeCode journey! :-)</p></div></div></section><hr class="hz fj ia ib ic ho id ie if ig ih"/><section class="dj dk dl dm dn"><div class="n p"><div class="ac ae af ag ah eg aj ak"><h1 id="37f4" class="ii ij ar bz by ik il im in io ip iq ir is it iu iv">For Advanced Programmers: Linker Script for Bootloader</h1><p id="b877" class="gm gn ar bz go b gp iw gr ix gt iy gv iz gx ja gz"><em class="hf">If you’re interested in writing a Linker Script to customise the memory layout in your embedded program, read on…</em></p><pre class="hg hh hi hj hk kw kx ky"><span id="465f" class="kz ij ar bz je b fk la lb r lc">_bootrom_size = 29K<br/>...<br/>MEMORY /* Define memory regions. */<br/>{<br/>  /* Available ROM is 64K (0x10000). <br/>     Reserve lower part for Bootloader, <br/>     upper part for Application. */</span><span id="3538" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">bootrom (rx)  : ORIGIN = 0x08000000,      <br/>                 LENGTH = _bootrom_size</span><span id="5fc9" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">rom     (rx)  : ORIGIN = 0x08000000 + _bootrom_size, <br/>                 LENGTH = 64K - _bootrom_size</span></pre><p id="05a6" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">The above <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/ld/stm32f103x8.ld" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Linker Script</a> tells the GNU Linker to create two memory regions: <code class="ea jb jc jd je b">bootrom</code> (29 KB) and <code class="ea jb jc jd je b">rom</code> (64–29=35 KB). How do we instruct the linker to allocate various libraries to <code class="ea jb jc jd je b">bootrom</code> and <code class="ea jb jc jd je b">rom</code>?</p></div></div><div class="do ak"><figure class="hg hh hi hj hk do ak paragraph-image"><div class="dq dr ds dt ak"><div class="dz r ds ea"><div class="lf r"><div class="du dv de t u dw ak ax dx dy"><img class="de t u dw ak ec ed ee" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/60/1*afGJhqhuce_Ld0b6Eks1kw.png?q=20" width="4278" height="1049" role="presentation"/></div><img class="du dv de t u dw ak ef" width="4278" height="1049" role="presentation"/><noscript><img class="de t u dw ak" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/max/8556/1*afGJhqhuce_Ld0b6Eks1kw.png" width="4278" height="1049" role="presentation"/></noscript></div></div></div><figcaption class="cd fk hm hn ho dc da db hp hq by fj">Memory Layout with two memory regions</figcaption></figure></div><div class="n p"><div class="ac ae af ag ah eg aj ak"><p id="fef5" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">From <a class="bi cv ha hb hc hd" target="_blank" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee/stm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7?source=friends_link&amp;sk=54719084d640bb1d92ac1097d623bba2">my article on memory optimisation</a>, you’ll recall that the <code class="ea jb jc jd je b">rom</code> memory region contains a <strong class="go he">Text Section</strong> (for program code) and a <strong class="go he">Data Section</strong> (for initial values of non-zero variables). Here’s how we tell the linker which libraries to allocate into the Text Section of <code class="ea jb jc jd je b">bootrom</code>…</p><pre class="hg hh hi hj hk kw kx ky"><span id="bbd7" class="kz ij ar bz je b fk la lb r lc">SECTIONS<br/>{<br/> .boot_text : { /* Bootloader ROM */<br/>  ...<br/>  *liblibopencm3.a: (.text*) /* libopencm3       */<br/>  *libnano-float.a: (.text*) /* Math Library     */<br/>  *libnewlib.a:     (.text*) /* C Library        */<br/>  *liblogger.a:     (.text*) /* Logger           */<br/>  *libbluepill.a:   (.text*) /* Device Functions */<br/>  *libbootloader.a: (.text*) /* Bootloader       */<br/>  ...<br/>} &gt;bootrom</span></pre><p id="23f2" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">The <code class="ea jb jc jd je b">*</code> wildcard matches any number of characters. When used like this…</p><pre class="hg hh hi hj hk kw kx ky"><span id="804b" class="kz ij ar bz je b fk la lb r lc">*liblibopencm3.a: (.text*)</span></pre><p id="0888" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">…the linker takes all object files (<code class="ea jb jc jd je b">*.o</code>) from the library <code class="ea jb jc jd je b">liblibopencm3.a</code>, extracts all the Text Sections, and writes them into the <code class="ea jb jc jd je b">bootrom</code> memory region.</p><p id="0f36" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">All other libraries and object files that don’t match the above patterns will be allocated in the <code class="ea jb jc jd je b">rom</code> memory region, according to this rule…</p><pre class="hg hh hi hj hk kw kx ky"><span id="0eac" class="kz ij ar bz je b fk la lb r lc">.text : {          /* Application ROM        */<br/>  ...<br/>  * (.text*) /* Other Application Code */<br/>  ...<br/>} &gt;rom</span></pre><p id="fa86" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">What about the Blue Pill RAM? We allocate the available RAM into three memory regions: <code class="ea jb jc jd je b">bootram</code> (for the Bootloader), <code class="ea jb jc jd je b">ram</code> (for the Application) and <code class="ea jb jc jd je b">bootbuf</code>. <code class="ea jb jc jd je b">bootbuf</code> contains the RAM buffers used for flashing the ROM in Bootloader Mode. Since <code class="ea jb jc jd je b">bootbuf</code> is not used in Application Mode, <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/bootloader/bootloader.c#L170-L173" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">we convert </a><code class="ea jb jc jd je b"><a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/bootloader/bootloader.c#L170-L173" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">bootbuf</a></code><a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/stm32/bootloader/bootloader.c#L170-L173" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow"> into an extended memory space for the stack and the heap</a> while running the Application.</p><p id="05ef" class="gm gn ar bz go b gp gq gr gs gt gu gv gw gx gy gz">The <a href="https://web.archive.org/web/20191204194207/https://github.com/lupyuen/codal-libopencm3/blob/master/ld/stm32f103x8.ld" class="bi cv ha hb hc hd" target="_blank" rel="noopener nofollow">Linker Script</a> for RAM layout looks like this…</p><pre class="hg hh hi hj hk kw kx ky"><span id="13cc" class="kz ij ar bz je b fk la lb r lc">_bootrom_size = 29K;    /* Size of Bootloader ROM <br/>                           (code + constant data) */</span><span id="5881" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">_bootram_size =  4K;    /* Size of Bootloader RAM */</span><span id="c6c3" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">_bootbuf_size = /* Size of the Bootloader buffers...         */<br/> 1090 +         /* flashBuf from stm32/bootloader/ghostfat.c */<br/> 1024 +         /* hf2_buffer from stm32/bootloader/hf2.c    */<br/>    2;          /* Align to 4 bytes */<br/>...<br/>MEMORY /* Define memory regions. */<br/>{<br/>  /* Available RAM is 20K (0x5000). <br/>     Reserve lower part for Bootloader, <br/>     middle part for Application,<br/>     upper part for Bootloader flash buffers <br/>     (not used in Application Mode). */</span><span id="2ee4" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">  bootram (rwx) : ORIGIN = 0x20000000,      <br/>                  LENGTH = _bootram_size</span><span id="0368" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">  ram     (rwx) : ORIGIN = 0x20000000 + _bootram_size, <br/>                  LENGTH = 20K - _bootram_size - _bootbuf_size</span><span id="531c" class="kz ij ar bz je b fk lo lp lq lr ls lb r lc">  bootbuf (rwx) : ORIGIN = 0x20005000 - _bootbuf_size, <br/>                  LENGTH = _bootbuf_size</span></pre></div></div></section></div></article><div class="du di lt s ak lu lv lw" data-test-id="post-sidebar"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="lx n dd"><div class="di"><div class="ly lz ma n"><div class="n o"><div class="mb r ds"><a href="https://web.archive.org/web/20191204194207/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89&amp;source=post_sidebar-----b7f1a1508e89---------------------clap_sidebar-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><div class="bp mc md me mf mg mh mi mj mk ml"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="mm r"><div class="mn"><h4 class="by fj fk ca cd"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx">98 </button></h4></div></div></div></div><div><div class="cu"><a href="https://web.archive.org/web/20191204194207/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><svg width="25" height="25" viewbox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div><div class="du di lt s mo fd mp mq lv mr"></div><div><div class="ms do n dd p"><div class="n p"><div class="ac ae af ag ah eg aj ak"><div class="n mt"></div><div class="n o mt"></div><div class="mu r"><ul class="bp bq"><li class="cu mv mw mx"><a href="/web/20191204194207/https://medium.com/tag/programming" class="my mz cv cd r kx na a b gb">Programming</a></li><li class="cu mv mw mx"><a href="/web/20191204194207/https://medium.com/tag/gadgets" class="my mz cv cd r kx na a b gb">Gadgets</a></li><li class="cu mv mw mx"><a href="/web/20191204194207/https://medium.com/tag/internet-of-things" class="my mz cv cd r kx na a b gb">Internet of Things</a></li><li class="cu mv mw mx"><a href="/web/20191204194207/https://medium.com/tag/stm32" class="my mz cv cd r kx na a b gb">Stm32</a></li></ul></div><div class="nb n et ab"><div class="n o"><div class="nc r ds"><a href="https://web.archive.org/web/20191204194207/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89&amp;source=post_actions_footer-----b7f1a1508e89---------------------clap_footer-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><div class="c nd ff n o ne ds nf ng nh ni nj nk nl nm nn no np nq nr ns"><div class="bp mc md me mf mg nt mi o ef ff n p nu u dw de t ak mj mk ml nv"><svg width="33" height="33" viewbox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></div></a></div><div class="mm r"><div class="mn"><h4 class="by fj fk ca ar"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx">98 claps</button></h4></div></div></div><div class="n o"><div class="gk r bh"><a href="//web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/share/twitter?source=post_actions_footer---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" target="_blank" rel="noopener"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="gk r bh"><a href="//web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/share/linkedIn?source=post_actions_footer---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" target="_blank" rel="noopener"><svg width="29" height="29" viewbox="0 0 29 29" fill="none" class="q"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></a></div><div class="gk r bh"><a href="//web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/share/facebook?source=post_actions_footer---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" target="_blank" rel="noopener"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="gk r bh"><div><div class="cu"><a href="https://web.archive.org/web/20191204194207/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89&amp;source=post_actions_footer--------------------------bookmark_sidebar-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><svg width="25" height="25" viewbox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div><div class="cu"><div class="cu"><div class="cu"><div class="r bh"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewbox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div></div><div class="nw nx ny mu r ab"><div class="nz oa r ds"><span class="r ob an oc"><div class="r de od oe"><a rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee?source=follow_footer--------------------------follow_footer-"><div class="ds of og"><div class="ch n ez o p de fa fb fc fd fe di"><svg width="91" height="91" viewbox="0 0 91 91"><path fill-rule="evenodd" clip-rule="evenodd" d="M45.5 1.4c-17.14 0-32 9.95-39.25 24.5L5 25.28C12.47 10.28 27.8 0 45.5 0S78.53 10.29 86 25.28l-1.25.62C77.5 11.35 62.65 1.4 45.5 1.4zM6.25 65.1c7.25 14.55 22.1 24.5 39.25 24.5 17.14 0 32-9.95 39.25-24.5l1.25.62C78.53 80.72 63.2 91 45.5 91S12.47 80.71 5 65.72l1.25-.62z"></path></svg></div><img alt="Lup Yuen Lee 李立源" class="r ff og of" src="https://web.archive.org/web/20191204194207im_/https://miro.medium.com/fit/c/160/160/1*KGohS3sQaUnr58gc0BIfoQ.jpeg" width="80" height="80"/></div></a></div><span class="r"><div class="oh r oi"><p class="by fj gb ca cd oj ok">Written by</p></div><div class="oh ol n oi"><div class="ak n o et"><h2 class="by ik ia om ar"><a class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener" href="/web/20191204194207/https://medium.com/@ly.lee?source=follow_footer--------------------------follow_footer-">Lup Yuen Lee 李立源</a></h2><div class="r g"><button class="on ar q cn fq fr fs ft br bw fu fv fw fx fy fz cq by b bz ca cb cc cr cs ct cu cv bu">Follow</button></div></div></div></span></span><div class="oh oo r oi bd"><div class="op r"><h4 class="by fj kl oq cd">Techie and Educator in IoT 物聯網教師</h4></div><div class="bc or bd"><button class="on ar q cn fq fr fs ft br bw fu fv fw fx fy fz cq by b bz ca cb cc cr cs ct cu cv bu">Follow</button></div></div></div></div><div class="os nx r ab"><a href="https://web.archive.org/web/20191204194207/https://medium.com/p/b7f1a1508e89/responses/show?source=follow_footer--------------------------follow_footer-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" rel="noopener"><span class="ot ou mf"><div class="kw ov cq r ho g"><span class="cg">Write the first response</span></div></span></a></div></div></div><div class="ow r ox ab"><div class="n p"><div class="ac ae af ag ah ai aj ak"></div></div></div></div></div><div class="oy r oz pa"><section class="da db ak ct r jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="pb pc nz n et g"><div class="pd n et"><div class="pe r pf"><div class="pg r"><a href="https://web.archive.org/web/20191204194207/https://medium.com/about?autoplay=1&amp;source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br ph pi bu bv pj pk" rel="noopener"><h4 class="pl pm pn by ik bz oq po pp r">Discover <!-- -->Medium</h4></a></div><span class="by b bz ca cb cc r pq pr">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://web.archive.org/web/20191204194207/https://medium.com/about?autoplay=1&amp;source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br bu bv pj pk ps" rel="noopener">Watch</a></span></div><div class="pe r pf"><div class="pt r"><a href="https://web.archive.org/web/20191204194207/https://medium.com/topics?source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br ph pi bu bv pj pk" rel="noopener"><h4 class="pl pm pn by ik bz oq po pp r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="by b bz ca cb cc r pq pr">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://web.archive.org/web/20191204194207/https://medium.com/topics?source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br bu bv pj pk ps" rel="noopener">Explore</a></span></div><div class="pe r pf"><div class="pg r"><a href="https://web.archive.org/web/20191204194207/https://medium.com/membership?source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br ph pi bu bv pj pk" rel="noopener"><h4 class="pl pm pn by ik bz oq po pp r">Become a member</h4></a></div><span class="by b bz ca cb cc r pq pr">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://web.archive.org/web/20191204194207/https://medium.com/membership?source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br bu bv pj pk ps" rel="noopener">Upgrade</a></span></div></div></div><div class="n o et"><a class="bi bj bk bl bm bn bo bp bq br ph pi bu bv pj pk" rel="noopener" href="/web/20191204194207/https://medium.com/?source=post_page-----b7f1a1508e89----------------------"><svg height="22" width="112" viewbox="0 0 111.5 22" class="pm"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="by b bz ca cb cc r pq pr"><div class="pu pv n et pw an"><a href="https://web.archive.org/web/20191204194207/https://medium.com/about?autoplay=1&amp;source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br fn bu bv pj pk" rel="noopener">About</a><a href="https://web.archive.org/web/20191204194207/https://help.medium.com/?source=post_page-----b7f1a1508e89----------------------" class="bi bj bk bl bm bn bo bp bq br fn bu bv pj pk" rel="noopener">Help</a><a class="bi bj bk bl bm bn bo bp bq br fn bu bv pj pk" rel="noopener" href="/web/20191204194207/https://medium.com/policy/9db0094a1e0f?source=post_page-----b7f1a1508e89----------------------">Legal</a></div></span></div></section></div></div></div><script src="https://web.archive.org/web/20191204194207js_/https://cdn.optimizely.com/js/16180790160.js"></script><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://web.archive.org/web/20191204194207/https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20191204-181919-f1d0be3b6c","productName":"Medium","publicUrl":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20191204-181919-f1d0be3b6c"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"]},"debug":{"requestId":"82f7b93b-6117-4645-a6a5-f104a465b5c0","originalSpanCarrier":{"ot-tracer-spanid":"12cb2b2744536bcf","ot-tracer-traceid":"7a1714113fac9c1c","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_bSzVyNxXpaVB"},"xsrf":""},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hasRenderedBranchBanner":null,"hideGoogleOneTap":false,"hideAlternateUser":false,"branchData":{"loaded":false},"shareKey":"661984e9775f991a97e5747a67214b60","referrerSource":"friends_link","currentLocation":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89","host":"medium.com","hostname":"medium.com","referrer":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002Ftag\u002Frust","susiModal":{"step":null,"operation":"register","reportEventInfo":{"eventName":"","data":{}}}},"client":{"isBot":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":false},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"viewer":null,"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.83","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.84","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.85","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.86","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.87","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.88","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.89","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.90","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.91","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.92","typename":"VariantFlag"}],"meterPost({\"postId\":\"b7f1a1508e89\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"b7f1a1508e89\"})":{"type":"id","generated":false,"id":"Post:b7f1a1508e89","typename":"Post"}},"ROOT_QUERY.variantFlags.0":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.3":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.4":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.5":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.6":{"name":"daily_read_non_silent","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.7":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"disable_post_recommended_from_friends_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"diversification_no_embedding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_filter_by_resend_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_first_name_on_blocker_banner","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_gift_membership_ended_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_inline_search_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_inline_search_popover_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.33":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_lite_read_next","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagString","value":"sidebar"},"ROOT_QUERY.variantFlags.42":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_lo_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_lo_scroll_away_metabar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_new_gdpr_partner_export","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_new_partner_dashboard","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_new_partner_program_updates","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_new_pub_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_new_pub_modules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_new_suspended_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_new_three_dot_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_no_cache_control","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_popularity_feature_exp_retrain","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_post_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_sign_up_with_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_stripe_express_initial_expansion_copy","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_stripe_express_rest_of_world_copy","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"enable_suggest_account","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.74":{"name":"enable_suggest_account_li","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"enable_susi_font_changes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.79":{"name":"enable_tribute_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.81":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.82":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.83":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.83.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.83.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.84":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.84.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.84.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.85":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.85.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.85.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.86":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.86.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.86.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.87":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.87.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.87.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.88":{"name":"share_post_linkedin","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.88.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.88.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.89":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.89.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.89.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.90":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.90.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.90.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.91":{"name":"ten_stories_in_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.91.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.91.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.92":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.92.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.92.valueType":{"__typename":"VariantFlagBoolean","value":true},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:b7f1a1508e89":{"__typename":"Post","visibility":"LOCKED","latestPublishedVersion":"ea60e5d3f3da","collection":null,"id":"b7f1a1508e89","creator":{"type":"id","generated":false,"id":"User:1da08193a324","typename":"User"},"isLocked":true,"lockedSource":"LOCKED_POST_SOURCE_UGC_UNENROLLED","sequence":null,"mediumUrl":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-dissecting-the-webusb-bootloader-for-makecode-b7f1a1508e89","canonicalUrl":"","content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}})":{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}})","typename":"PostContent"},"firstPublishedAt":1550250106544,"isPublished":true,"layerCake":3,"primaryTopic":{"type":"id","generated":false,"id":"gadgets","typename":"Topic"},"title":"STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode","isLimitedState":false,"pendingCollection":{"type":"id","generated":false,"id":"Collection:721b17443fd5","typename":"Collection"},"shareKey":null,"statusForCollection":"PENDING","readingTime":12.382389937106918,"readingList":"READING_LIST_NONE","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:programming","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:gadgets","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:internet-of-things","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:stm32","typename":"Tag"}],"viewerClapCount":0,"clapCount":98,"voterCount":24,"recommenders":[],"responsesCount":0,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":1550250104992,"audioVersionUrl":"","seoTitle":"","socialTitle":"","socialDek":"","metaDescription":"How the MakeCode Bootloader for Blue Pill implements flashing over WebUSB","latestPublishedAt":1550250106544,"wordCount":2981,"previewContent":{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*0P7BkmUox48Rak_cta48QA.png","typename":"ImageMetadata"},"updatedAt":1550258275701,"topics":[{"type":"id","generated":false,"id":"gadgets","typename":"Topic"},{"type":"id","generated":false,"id":"programming","typename":"Topic"}],"seoDescription":"","isSuspended":false},"User:1da08193a324":{"id":"1da08193a324","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Lup Yuen Lee 李立源","isFollowing":false,"username":"ly.lee","bio":"Techie and Educator in IoT 物聯網教師","imageId":"1*KGohS3sQaUnr58gc0BIfoQ.jpeg","mediumMemberAt":1571194811000,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":"MisterTechBlog"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}})":{"isLockedPreviewOnly":false,"validatedShareKey":"661984e9775f991a97e5747a67214b60","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel","typename":"RichText"}},"gadgets":{"name":"Gadgets","slug":"gadgets","__typename":"Topic","isFollowing":null},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.0":{"name":"24d8","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.1":{"name":"ef5a","startIndex":20,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.2":{"name":"22b0","startIndex":32,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.3":{"name":"b993","startIndex":44,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.4":{"name":"d5d4","startIndex":63,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.5":{"name":"e3d0","startIndex":84,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.6":{"name":"c456","startIndex":100,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.0","typename":"Section"},{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.1","typename":"Section"},{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.2","typename":"Section"},{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.3","typename":"Section"},{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.4","typename":"Section"},{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.5","typename":"Section"},{"type":"id","generated":true,"id":"$Post:b7f1a1508e89.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftag\u002Frust\",\"sk\":\"661984e9775f991a97e5747a67214b60\",\"source\":\"friends_link\"}}).bodyModel.sections.6","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_75","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_76","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_77","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_78","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_79","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_80","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_81","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_82","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_83","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_84","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_85","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_86","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_87","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_88","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_89","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_90","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_91","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_92","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_93","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_94","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_95","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_96","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_97","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_98","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_99","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_100","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_101","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_102","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_103","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_104","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_105","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_106","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_107","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_108","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_109","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_110","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_111","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_112","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_113","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_114","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_115","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_116","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_117","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_118","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_119","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_120","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:ea60e5d3f3da_121","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:ea60e5d3f3da_0":{"id":"ea60e5d3f3da_0","name":"c57b","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*0P7BkmUox48Rak_cta48QA.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0P7BkmUox48Rak_cta48QA.png":{"id":"1*0P7BkmUox48Rak_cta48QA.png","originalHeight":1886,"originalWidth":4708,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_1":{"id":"ea60e5d3f3da_1","name":"8c8f","type":"H3","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill — Dissecting the WebUSB Bootloader for MakeCode","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_2":{"id":"ea60e5d3f3da_2","name":"d978","type":"P","href":null,"layout":null,"metadata":null,"text":"Could STM32 Blue Pill overtake Arduino as the preferred platform for creating IoT prototypes?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_2.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_2.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_2.markups.0":{"type":"A","start":6,"end":21,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttp:\u002F\u002Fwiki.stm32duino.com\u002Findex.php?title=Blue_Pill","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_2.markups.1":{"type":"STRONG","start":46,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_3":{"id":"ea60e5d3f3da_3","name":"f241","type":"P","href":null,"layout":null,"metadata":null,"text":"1️⃣ Blue Pill is packed with features, yet costs under US$ 2","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_3.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_3.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_3.markups.0":{"type":"STRONG","start":17,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_3.markups.1":{"type":"STRONG","start":49,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_4":{"id":"ea60e5d3f3da_4","name":"5d99","type":"P","href":null,"layout":null,"metadata":null,"text":"2️⃣ Cheaper Blue Pill clones are now emerging. No signs of Blue Pill fatigue.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_4.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_4.markups.0":{"type":"STRONG","start":4,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_5":{"id":"ea60e5d3f3da_5","name":"76af","type":"P","href":null,"layout":null,"metadata":null,"text":"3️⃣ Microcontrollers are joining mesh networks to become smarter collectives. Cheap microcontrollers like Blue Pill are needed.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_5.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_5.markups.0":{"type":"STRONG","start":33,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_6":{"id":"ea60e5d3f3da_6","name":"9df0","type":"P","href":null,"layout":null,"metadata":null,"text":"4️⃣ The closest competitor, ESP8266 \u002F ESP32, is still slowly growing its software base from scratch (though the embedded WiFi is a huge advantage)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_6.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_6.markups.0":{"type":"STRONG","start":28,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_7":{"id":"ea60e5d3f3da_7","name":"f4a0","type":"P","href":null,"layout":null,"metadata":null,"text":"5️⃣ Blue Pill developers have plenty of open-source Arm and STM32 code to guide them","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_7.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_7.markups.0":{"type":"STRONG","start":30,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_8":{"id":"ea60e5d3f3da_8","name":"c014","type":"P","href":null,"layout":null,"metadata":null,"text":"So what’s holding back Blue Pill? Blue Pill is way more advanced than the ancient Arduino Uno, yet we are still using the same primitive coding tools… a text editor and a C compiler.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_8.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_8.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_8.markups.0":{"type":"STRONG","start":151,"end":182,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_8.markups.1":{"type":"EM","start":34,"end":182,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_9":{"id":"ea60e5d3f3da_9","name":"9613","type":"P","href":null,"layout":null,"metadata":null,"text":"There must be a modern, easier way to write Blue Pill programs. Maybe we should sacrifice a bit of Blue Pill’s processing power to make it faster and friendlier to code and test. And this leads to MakeCode, the popular web-based tool for programming and flashing microcontrollers…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_10":{"id":"ea60e5d3f3da_10","name":"4dd3","type":"IFRAME","href":null,"layout":"FULL_WIDTH","metadata":null,"text":"Creating a MakeCode visual program and flashing to Blue Pill","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_10.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:77b6897b4aa44555a19043477d81e87c":{"id":"77b6897b4aa44555a19043477d81e87c","iframeSrc":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FDSNDvrVOJns%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DDSNDvrVOJns&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FDSNDvrVOJns%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube","iframeHeight":480,"iframeWidth":640,"title":"STM32 Blue Pill USB Bootloader and MakeCode","__typename":"MediaResource"},"$Paragraph:ea60e5d3f3da_10.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:77b6897b4aa44555a19043477d81e87c","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:ea60e5d3f3da_11":{"id":"ea60e5d3f3da_11","name":"8ac4","type":"P","href":null,"layout":null,"metadata":null,"text":"MakeCode is an open-source visual programming tool that’s easy to learn and use — makers around the world are already using MakeCode today with the BBC micro:bit. It generates Static TypeScript, a variant of JavaScript that’s optimised for newer powerful microcontrollers like Blue Pill. MakeCode could be the missing element that will make Blue Pill wildly successful for IoT.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_11.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_11.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_11.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_11.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_11.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_11.markups.5","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_11.markups.0":{"type":"A","start":0,"end":8,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmakecode.com\u002Fabout","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_11.markups.1":{"type":"A","start":176,"end":193,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmakecode.com\u002Flanguage","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_11.markups.2":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_11.markups.3":{"type":"STRONG","start":27,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_11.markups.4":{"type":"STRONG","start":176,"end":193,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_11.markups.5":{"type":"EM","start":288,"end":377,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_12":{"id":"ea60e5d3f3da_12","name":"f46e","type":"P","href":null,"layout":null,"metadata":null,"text":"Will MakeCode run on Blue Pill? There’s no official port of MakeCode for Blue Pill, but we’re nearly there. I have ported the most complicated part of MakeCode to Blue Pill: the MakeCode Bootloader. If the MakeCode Bootloader runs on Blue Pill, the rest is a piece of cake!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_12.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_12.markups.0":{"type":"STRONG","start":178,"end":197,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_13":{"id":"ea60e5d3f3da_13","name":"0c84","type":"P","href":null,"layout":null,"metadata":null,"text":"In this article we’ll take our surgical scalpels, dissect and explore the innards of the MakeCode Bootloader that I have ported to Blue Pill. We’ll learn…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_14":{"id":"ea60e5d3f3da_14","name":"54b7","type":"OLI","href":null,"layout":null,"metadata":null,"text":"What’s a Bootloader and why we need a Custom Bootloader","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_14.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_14.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_14.markups.0":{"type":"STRONG","start":9,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_14.markups.1":{"type":"STRONG","start":38,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_15":{"id":"ea60e5d3f3da_15","name":"9c81","type":"OLI","href":null,"layout":null,"metadata":null,"text":"CODAL runtime library used by MakeCode to execute Blue Pill-specific functions","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_15.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_15.markups.0":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_16":{"id":"ea60e5d3f3da_16","name":"8dc0","type":"OLI","href":null,"layout":null,"metadata":null,"text":"How the Bootloader uses Blue Pill memory optimally","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_16.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_16.markups.0":{"type":"STRONG","start":8,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_17":{"id":"ea60e5d3f3da_17","name":"f6de","type":"OLI","href":null,"layout":null,"metadata":null,"text":"HF2 Protocol used by MakeCode and the Bootloader to flash the Blue Pill","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_17.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_17.markups.0":{"type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_18":{"id":"ea60e5d3f3da_18","name":"bc88","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Linker Script used to create the Bootloader memory layout","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_18.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_18.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_19":{"id":"ea60e5d3f3da_19","name":"e56c","type":"P","href":null,"layout":null,"metadata":null,"text":"What’s a visual program? Check this video to see how MakeCode may be used to write a visual program that blinks the Blue Pill LED.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_19.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_19.markups.0":{"type":"A","start":25,"end":41,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fyoutu.be\u002FP8GDrmWWSbk","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_20":{"id":"ea60e5d3f3da_20","name":"16d5","type":"H3","href":null,"layout":null,"metadata":null,"text":"What’s A Bootloader?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_21":{"id":"ea60e5d3f3da_21","name":"15ae","type":"P","href":null,"layout":null,"metadata":null,"text":"Well it boots and it loads… Duh.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_21.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_21.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_21.markups.0":{"type":"STRONG","start":8,"end":13,"href":"","anchorType":"LINK","userId":"","linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_21.markups.1":{"type":"STRONG","start":21,"end":26,"href":"","anchorType":"LINK","userId":"","linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_22":{"id":"ea60e5d3f3da_22","name":"54b9","type":"P","href":null,"layout":null,"metadata":null,"text":"Boot: The Bootloader is a small program that’s pre-installed in the ROM of the microcontroller. It’s the first program that runs when we power on the device. Normally the Bootloader will jump to the custom program that we have flashed into the ROM (assuming it has been flashed). So most of the time we won’t notice that the Bootloader is actually started before our custom program.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_22.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_22.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_23":{"id":"ea60e5d3f3da_23","name":"7a08","type":"P","href":null,"layout":null,"metadata":null,"text":"Load: The Bootloader enables us to load (or flash) our custom program into ROM. On the Arduino Uno, the Bootloader receives our custom program file via the USB Serial Port and flashes the custom program into ROM. For Blue Pill, the factory-installed Bootloader works the same way except that it uses the UART pins instead of the USB port. See AN3155: USART protocol used in the STM32 bootloader and AN2606: STM32 microcontroller system memory boot mode.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_23.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_23.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_23.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_23.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_23.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_23.markups.0":{"type":"A","start":343,"end":394,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fwww.st.com\u002Fcontent\u002Fccc\u002Fresource\u002Ftechnical\u002Fdocument\u002Fapplication_note\u002F51\u002F5f\u002F03\u002F1e\u002Fbd\u002F9b\u002F45\u002Fbe\u002FCD00264342.pdf\u002Ffiles\u002FCD00264342.pdf\u002Fjcr:content\u002Ftranslations\u002Fen.CD00264342.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_23.markups.1":{"type":"A","start":399,"end":452,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fwww.st.com\u002Fcontent\u002Fccc\u002Fresource\u002Ftechnical\u002Fdocument\u002Fapplication_note\u002Fb9\u002F9b\u002F16\u002F3a\u002F12\u002F1e\u002F40\u002F0c\u002FCD00167594.pdf\u002Ffiles\u002FCD00167594.pdf\u002Fjcr:content\u002Ftranslations\u002Fen.CD00167594.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_23.markups.2":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_23.markups.3":{"type":"EM","start":342,"end":394,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_23.markups.4":{"type":"EM","start":399,"end":452,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_24":{"id":"ea60e5d3f3da_24","name":"090f","type":"P","href":null,"layout":null,"metadata":null,"text":"Remember that we set the BOOT0 jumper to 0 while flashing Blue Pill via ST Link? This disables the factory-installed Bootloader so we don’t actually flash the custom program via the UART pins. ST Link uses the SWD port on the Blue Pill to flash our custom program into the ROM.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_24.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_24.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_24.markups.0":{"type":"CODE","start":25,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_24.markups.1":{"type":"CODE","start":41,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_25":{"id":"ea60e5d3f3da_25","name":"af68","type":"H3","href":null,"layout":null,"metadata":null,"text":"Why Build A Custom Bootloader?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_26":{"id":"ea60e5d3f3da_26","name":"4960","type":"P","href":null,"layout":null,"metadata":null,"text":"Flashing the Blue Pill via the bare UART pins or the SWD port (via ST Link) is cumbersome. What if we could simply click a button in a web page, and transmit our custom program directly into the Blue Pill ROM? And how would we connect the Blue Pill to our computer? Just use the USB port that’s already provided on Blue Pill! Flashing the Blue Pill would become so easy — just like in the demo above!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_26.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_26.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_26.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_26.markups.0":{"type":"STRONG","start":115,"end":208,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_26.markups.1":{"type":"STRONG","start":279,"end":287,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_26.markups.2":{"type":"EM","start":326,"end":400,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_27":{"id":"ea60e5d3f3da_27","name":"fe22","type":"P","href":null,"layout":null,"metadata":null,"text":"But there’s a catch (or two)…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_27.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_27.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_27.markups.0":{"type":"STRONG","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_27.markups.1":{"type":"EM","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_28":{"id":"ea60e5d3f3da_28","name":"f15e","type":"P","href":null,"layout":null,"metadata":null,"text":"1️⃣ The Blue Pill’s USB port doesn’t have any built-in functionality. (Surprised? Many of my students assumed that the Blue Pill USB port actually did something.) We need to write the Blue Pill code to perform the flashing over USB. And the code will go into a Custom Bootloader that we’ll install ourselves into our new Blue Pills. Once installed, we shouldn’t need to re-flash the Custom Bootloader (although there’s actually an easy way to do this… in our next article!)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_28.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_28.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_28.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_28.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_28.markups.0":{"type":"STRONG","start":4,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_28.markups.1":{"type":"STRONG","start":261,"end":278,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_28.markups.2":{"type":"EM","start":151,"end":160,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_28.markups.3":{"type":"EM","start":401,"end":473,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_29":{"id":"ea60e5d3f3da_29","name":"642a","type":"P","href":null,"layout":null,"metadata":null,"text":"2️⃣ Web Browsers won’t allow us to access all types of USB devices (e.g. Blue Pill) directly through a web page, for safety reasons. The Chrome browser provides the WebUSB JavaScript API for safely accessing some USB devices, including Blue Pill. With the right code in the web page and the right code in the Custom Bootloader, we’ll see in a while that it’s indeed possible to flash the Blue Pill via a web page, as we have seen in the demo above.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_29.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_29.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_29.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_29.markups.0":{"type":"A","start":165,"end":186,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fdevelopers.google.com\u002Fweb\u002Fupdates\u002F2016\u002F03\u002Faccess-usb-devices-on-the-web","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_29.markups.1":{"type":"STRONG","start":4,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_29.markups.2":{"type":"STRONG","start":165,"end":186,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_30":{"id":"ea60e5d3f3da_30","name":"7ea0","type":"P","href":null,"layout":null,"metadata":null,"text":"So this article is all about the internals of the Custom Bootloader for Blue Pill that supports flashing over WebUSB. Details on implementing WebUSB on Blue Pill may be found in my earlier article.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_30.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_30.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_30.markups.0":{"type":"A","start":178,"end":196,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c?source=friends_link&sk=70a29cd31425ec4d03144bce14a1c922","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_30.markups.1":{"type":"STRONG","start":33,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_31":{"id":"ea60e5d3f3da_31","name":"5a3e","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill USB Bootloader — How I fixed the USB Storage, Serial, DFU and WebUSB interfaces\nBuilding a complex composite USB device with libopencm3 that works on Windows, Mac and Linuxmedium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_31.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_31.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_31.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_31.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_31.markups.0":{"type":"A","start":0,"end":198,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_31.markups.1":{"type":"STRONG","start":0,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_31.markups.2":{"type":"EM","start":96,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_31.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c","thumbnailImageId":"1*fjfoda1Ovwdahy09TwUkqA.png","mediaResourceId":"1*fjfoda1Ovwdahy09TwUkqA.png","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_32":{"id":"ea60e5d3f3da_32","name":"7763","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"CODAL\nInformation on the Component Oriented Device Abstraction Layer (CODAL), created and maintained by Lancaster University.lancaster-university.github.io","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_32.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_32.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_32.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_32.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_32.markups.0":{"type":"A","start":0,"end":155,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Flancaster-university.github.io\u002Fcodal\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_32.markups.1":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_32.markups.2":{"type":"EM","start":6,"end":125,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_32.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Flancaster-university.github.io\u002Fcodal\u002F","thumbnailImageId":"","mediaResourceId":"","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_33":{"id":"ea60e5d3f3da_33","name":"a2de","type":"H3","href":null,"layout":null,"metadata":null,"text":"CODAL Runtime for Embedded Devices","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_34":{"id":"ea60e5d3f3da_34","name":"5671","type":"P","href":null,"layout":null,"metadata":null,"text":"The CODAL runtime library created by Lancaster University provides a friendly and flexible C++ API for programming embedded devices. MakeCode compiles our visual programs into Static TypeScript code that calls the CODAL library to access the device and peripheral functions like the onboard LED and ports for UART, I2C, SPI, …","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_34.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_34.markups.0":{"type":"A","start":4,"end":57,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Flancaster-university.github.io\u002Fcodal\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_35":{"id":"ea60e5d3f3da_35","name":"1d1f","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s a sample CODAL program that blinks the LED…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_35.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_35.markups.0":{"type":"A","start":9,"end":49,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fsamples\u002Fmain.cpp","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_36":{"id":"ea60e5d3f3da_36","name":"e934","type":"PRE","href":null,"layout":null,"metadata":null,"text":"void Blink_main(STM32BluePill& device) {\n int state = 0;\n while(1) {    \n   device.io.led.setDigitalValue(state);\n   device.sleep(1000);\n   state = !state;\n }\n}","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_36.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_36.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_36.markups.0":{"type":"STRONG","start":16,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_36.markups.1":{"type":"STRONG","start":73,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37":{"id":"ea60e5d3f3da_37","name":"0122","type":"P","href":null,"layout":null,"metadata":null,"text":"Comparing this with the same Arduino program that blinks the LED, it doesn’t look that different. But note that the onboard LED is neatly encapsulated as device.io.led. device is an STM32BluePill object that’s defined as…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_37.markups.6","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_37.markups.0":{"type":"CODE","start":154,"end":167,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37.markups.1":{"type":"CODE","start":169,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37.markups.2":{"type":"CODE","start":182,"end":195,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37.markups.3":{"type":"A","start":24,"end":64,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fwww.arduino.cc\u002Fen\u002Ftutorial\u002Fblink","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37.markups.4":{"type":"A","start":182,"end":195,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fstm32\u002Fmodel\u002FSTM32BluePill.h","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37.markups.5":{"type":"STRONG","start":154,"end":167,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_37.markups.6":{"type":"STRONG","start":182,"end":195,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_38":{"id":"ea60e5d3f3da_38","name":"9810","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class STM32BluePill : public CodalComponent {\npublic:\n  Timer              timer;\n  MessageBus         messageBus;\n  STM32BluePillIO    io;\n  I2C                i2c1;\n  SPI                spi1;\n  SPI                spi2;\n  Serial             usart2;","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_39":{"id":"ea60e5d3f3da_39","name":"decb","type":"P","href":null,"layout":null,"metadata":null,"text":"Wow we have just dissected the Blue Pill to reveal its innards: the system timer, I2C port, SPI port, USART port, … Each of these are CODAL objects that expose methods for accessing the device and port-specific functions. The led object we saw earlier is just another CODAL object defined in STM32BluePillIO.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_39.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_39.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_39.markups.0":{"type":"CODE","start":226,"end":229,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_39.markups.1":{"type":"CODE","start":292,"end":307,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_40":{"id":"ea60e5d3f3da_40","name":"beba","type":"P","href":null,"layout":null,"metadata":null,"text":"CODAL gives us a clean way to write embedded programs in C++ that will work with many types of modern microcontrollers, without resorting to Arduino’s preprocessor symbols like in digitalWrite(LED_BUILTIN, HIGH).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_40.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_40.markups.0":{"type":"CODE","start":180,"end":211,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_41":{"id":"ea60e5d3f3da_41","name":"7c1e","type":"P","href":null,"layout":null,"metadata":null,"text":"CODAL is officially supported for Arm microcontrollers that use Arm’s Mbed device library (including the BBC micro:bit). However Mbed is not optimised for Blue Pill so I have ported CODAL to Blue Pill using the optimised open-source libopencm3 library instead…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_41.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_41.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_41.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_41.markups.0":{"type":"A","start":34,"end":54,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flancaster-university\u002Fcodal-mbed","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_41.markups.1":{"type":"A","start":105,"end":118,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flancaster-university\u002Fmicrobit-dal","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_41.markups.2":{"type":"A","start":233,"end":243,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flibopencm3\u002Flibopencm3\u002Fwiki","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_42":{"id":"ea60e5d3f3da_42","name":"7e0d","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"lupyuen\u002Fcodal-libopencm3\nCodal framework ported to libopencm3 to support MakeCode on STM32 Blue Pill - lupyuen\u002Fcodal-libopencm3github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_42.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_42.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_42.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_42.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_42.markups.0":{"type":"A","start":0,"end":137,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_42.markups.1":{"type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_42.markups.2":{"type":"EM","start":25,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_42.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3","thumbnailImageId":"0*DObDXKFSly6ip9jt","mediaResourceId":"0*DObDXKFSly6ip9jt","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_43":{"id":"ea60e5d3f3da_43","name":"ea2e","type":"P","href":null,"layout":null,"metadata":null,"text":"From here onwards, we’ll use the term “CODAL” to refer to the Blue Pill version of CODAL. We’ll now look at the challenges in squeezing CODAL to run on Blue Pill, coexisting with the Bootloader.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_44":{"id":"ea60e5d3f3da_44","name":"e1fc","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill — Analyse and Optimise Your RAM and ROM\nTips and tools to prevent Blue Pill Bloatmedium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_44.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_44.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_44.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_44.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_44.markups.0":{"type":"A","start":0,"end":107,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_44.markups.1":{"type":"STRONG","start":0,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_44.markups.2":{"type":"EM","start":56,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_44.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7","thumbnailImageId":"1*sqHQVxWsmoA7_PW7j9_GJQ.png","mediaResourceId":"1*sqHQVxWsmoA7_PW7j9_GJQ.png","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_45":{"id":"ea60e5d3f3da_45","name":"1d5c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Memory Layout for Bootloader","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_46":{"id":"ea60e5d3f3da_46","name":"1b01","type":"P","href":null,"layout":null,"metadata":null,"text":"In my article on memory optimisation, we learnt that the Blue Pill has 64 KB of ROM, from address 0x0800 0000 to 0x0801 0000. Assuming that we can use all 64 KB of ROM, our MakeCode Application (the one we created through drag-and-drop) will fill up the available ROM like this…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_46.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_46.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_46.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_46.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_46.markups.0":{"type":"CODE","start":98,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_46.markups.1":{"type":"CODE","start":113,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_46.markups.2":{"type":"A","start":3,"end":36,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7?source=friends_link&sk=54719084d640bb1d92ac1097d623bba2","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_46.markups.3":{"type":"STRONG","start":71,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_47":{"id":"ea60e5d3f3da_47","name":"54af","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*yso3pjwk8Vkvb3GxOqwkgg.png","typename":"ImageMetadata"},"text":"Memory Layout for MakeCode Application","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yso3pjwk8Vkvb3GxOqwkgg.png":{"id":"1*yso3pjwk8Vkvb3GxOqwkgg.png","originalHeight":1049,"originalWidth":4278,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_48":{"id":"ea60e5d3f3da_48","name":"651c","type":"P","href":null,"layout":null,"metadata":null,"text":"MakeCode compiles our visual program into Arm Cortex machine code (not into intermediate bytecode), so the compiled MakeCode App appears to Blue Pill like any other C function. The compiled MakeCode App calls the CODAL library to execute Blue Pill device functions. To do its job, CODAL needs to call some friends…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_48.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_48.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_48.markups.0":{"type":"A","start":213,"end":226,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_48.markups.1":{"type":"STRONG","start":42,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_49":{"id":"ea60e5d3f3da_49","name":"a327","type":"ULI","href":null,"layout":null,"metadata":null,"text":"libopencm3: The open-source library for Blue Pill device functions","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_49.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_49.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_49.markups.0":{"type":"A","start":16,"end":35,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flibopencm3\u002Flibopencm3\u002Fwiki","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_49.markups.1":{"type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_50":{"id":"ea60e5d3f3da_50","name":"8e8b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"nano-float: Math library optimised for Blue Pill. Includes Qfplib. I wrote about nano-float in this article and the Unit Testing too.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_50.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_50.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_50.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_50.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_50.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_50.markups.0":{"type":"A","start":11,"end":24,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Ftree\u002Fmaster\u002Flib\u002Fnano-float","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_50.markups.1":{"type":"A","start":59,"end":65,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fwww.quinapalus.com\u002Fqfplib.html","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_50.markups.2":{"type":"A","start":92,"end":107,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-shrink-your-math-libraries-with-qfplib-55093aab163a?source=friends_link&sk=d7cd162dabcc45f96490e5e1f5f4c534","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_50.markups.3":{"type":"A","start":116,"end":128,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-unit-testing-with-qemu-blue-pill-emulator-9d88002a68b2?source=friends_link&sk=9a9389cdea5828cb48713f963c8f7615","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_50.markups.4":{"type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_51":{"id":"ea60e5d3f3da_51","name":"7ba2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"newlib: Standard C library optimised for Blue Pill","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_51.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_51.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_51.markups.0":{"type":"A","start":8,"end":26,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fnewlib\u002Ftree\u002Fmaster","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_51.markups.1":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_52":{"id":"ea60e5d3f3da_52","name":"73d2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"logger: Library for logging errors and diagnostic messages","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_52.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_52.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_52.markups.0":{"type":"A","start":8,"end":27,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Ftree\u002Fmaster\u002Fstm32\u002Flogger","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_52.markups.1":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_53":{"id":"ea60e5d3f3da_53","name":"2836","type":"ULI","href":null,"layout":null,"metadata":null,"text":"bluepill: Common functions for Real-Time Clock and System Timers","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_53.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_53.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_53.markups.0":{"type":"A","start":10,"end":26,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Ftree\u002Fmaster\u002Fstm32\u002Fbluepill","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_53.markups.1":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_54":{"id":"ea60e5d3f3da_54","name":"0077","type":"ULI","href":null,"layout":null,"metadata":null,"text":"hal: Hardware Adaptation Layer, called by CODAL","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_54.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_54.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_54.markups.0":{"type":"A","start":5,"end":30,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Ftree\u002Fmaster\u002Fstm32\u002Fhal","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_54.markups.1":{"type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_55":{"id":"ea60e5d3f3da_55","name":"ed9c","type":"P","href":null,"layout":null,"metadata":null,"text":"What’s missing from the picture? The Bootloader of course! Without the Bootloader, we won’t be able to flash the MakeCode App to Blue Pill via the web browser. Let’s add the Bootloader…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_55.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_55.markups.0":{"type":"STRONG","start":37,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_56":{"id":"ea60e5d3f3da_56","name":"049c","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*6-mdzt_0NGcai867jdRFJw.png","typename":"ImageMetadata"},"text":"Memory Layout after adding Bootloader","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*6-mdzt_0NGcai867jdRFJw.png":{"id":"1*6-mdzt_0NGcai867jdRFJw.png","originalHeight":1049,"originalWidth":4278,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_57":{"id":"ea60e5d3f3da_57","name":"fb1e","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we have a problem… 1️⃣ CODAL calls the libopencm3 library to access the Blue Pill device functions 2️⃣ Bootloader needs the libopencm3 library to write to flash memory and to access the USB port. So we have TWO copies of the libopencm3 code in ROM.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_57.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_57.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_57.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_57.markups.0":{"type":"STRONG","start":27,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_57.markups.1":{"type":"STRONG","start":107,"end":146,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_57.markups.2":{"type":"STRONG","start":211,"end":221,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_58":{"id":"ea60e5d3f3da_58","name":"3421","type":"P","href":null,"layout":null,"metadata":null,"text":"We don’t have enough ROM space for two copies of libopencm3, so let’s use only one copy of libopencm3, shared by the Application (CODAL + MakeCode App) and the Bootloader…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_58.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_58.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_58.markups.0":{"type":"STRONG","start":117,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_58.markups.1":{"type":"STRONG","start":160,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_59":{"id":"ea60e5d3f3da_59","name":"52cc","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*afGJhqhuce_Ld0b6Eks1kw.png","typename":"ImageMetadata"},"text":"Memory Layout optimised for Application + Bootloader","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*afGJhqhuce_Ld0b6Eks1kw.png":{"id":"1*afGJhqhuce_Ld0b6Eks1kw.png","originalHeight":1049,"originalWidth":4278,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_60":{"id":"ea60e5d3f3da_60","name":"e92a","type":"P","href":null,"layout":null,"metadata":null,"text":"For clarity, we segregate the Bootloader and the Application into two Memory Regions: bootrom (for Bootloader) and rom (for Application). Recall that the Application (rom) will be updated more often than the Bootloader (bootrom).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_60.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_60.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_60.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_60.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_60.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_60.markups.5","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_60.markups.0":{"type":"CODE","start":86,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_60.markups.1":{"type":"CODE","start":115,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_60.markups.2":{"type":"CODE","start":167,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_60.markups.3":{"type":"CODE","start":220,"end":227,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_60.markups.4":{"type":"STRONG","start":86,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_60.markups.5":{"type":"STRONG","start":115,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_61":{"id":"ea60e5d3f3da_61","name":"5001","type":"P","href":null,"layout":null,"metadata":null,"text":"This Bootloader design is rarely used in real life because it needs the Bootloader and the Application to be carefully matched by code version. Otherwise the Application might call a shared function (in libopencm3, for example) using an older address that’s no longer valid in the current Bootloader.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_61.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_61.markups.0":{"type":"STRONG","start":72,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_62":{"id":"ea60e5d3f3da_62","name":"dfc1","type":"P","href":null,"layout":null,"metadata":null,"text":"How do we tell the Blue Pill compiler and linker to use this memory layout? We define the memory layout in the Linker Script. The details may be found in the “For Advanced Programmers: Linker Script for Bootloader” section below.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_62.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_62.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_62.markups.0":{"type":"A","start":111,"end":124,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fld\u002Fstm32f103x8.ld","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_62.markups.1":{"type":"EM","start":158,"end":214,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_63":{"id":"ea60e5d3f3da_63","name":"d175","type":"H3","href":null,"layout":null,"metadata":null,"text":"WebUSB Flashing with the HF2 Protocol","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_64":{"id":"ea60e5d3f3da_64","name":"5c9c","type":"P","href":null,"layout":null,"metadata":null,"text":"The WebUSB Bootloader that I have implemented for Blue Pill (adapted from various sources) is a hefty embedded program taking 29 KB of ROM space. Why is it so huge? Because it supports…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_64.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_64.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_64.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_64.markups.0":{"type":"A","start":4,"end":21,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Ftree\u002Fmaster\u002Fstm32\u002Fbootloader","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_64.markups.1":{"type":"A","start":74,"end":89,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fstm32\u002Fbootloader\u002FREADME.md","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_64.markups.2":{"type":"STRONG","start":126,"end":138,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_65":{"id":"ea60e5d3f3da_65","name":"ebdd","type":"P","href":null,"layout":null,"metadata":null,"text":"1️⃣ WebUSB and WinUSB protocols. Allows the MakeCode website to access the Blue Pill via USB through the Chrome web browser, without installing any drivers. I wrote about WebUSB and WinUSB in this article.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_65.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_65.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_65.markups.0":{"type":"A","start":189,"end":204,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c?source=friends_link&sk=70a29cd31425ec4d03144bce14a1c922","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_65.markups.1":{"type":"STRONG","start":4,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_66":{"id":"ea60e5d3f3da_66","name":"9346","type":"P","href":null,"layout":null,"metadata":null,"text":"2️⃣ USB Serial Port (USB CDC) for debug logging","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_66.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_66.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_66.markups.0":{"type":"A","start":21,"end":28,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FUSB_communications_device_class","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_66.markups.1":{"type":"STRONG","start":4,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_67":{"id":"ea60e5d3f3da_67","name":"c131","type":"P","href":null,"layout":null,"metadata":null,"text":"3️⃣ HF2 Protocol for flashing Blue Pill via WebUSB","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_67.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_67.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_67.markups.0":{"type":"A","start":4,"end":16,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002FMicrosoft\u002Fuf2\u002Fblob\u002Fmaster\u002Fhf2.md","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_67.markups.1":{"type":"STRONG","start":4,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_68":{"id":"ea60e5d3f3da_68","name":"36f1","type":"P","href":null,"layout":null,"metadata":null,"text":"4️⃣ And remember that the Bootloader includes libopencm3 and other common functions used by the MakeCode Application, due to the way we partitioned the ROM space into Bootloader and Application regions.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_68.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_68.markups.0":{"type":"STRONG","start":46,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_69":{"id":"ea60e5d3f3da_69","name":"fe8e","type":"P","href":null,"layout":null,"metadata":null,"text":"How do we tell Blue Pill that we want to flash a new Application into ROM? Do we press a button on Blue Pill to enter Bootloader Mode, like on some MakeCode devices?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_69.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_69.markups.0":{"type":"A","start":135,"end":164,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Flearn.adafruit.com\u002Fmakecode\u002Fdownloading-and-flashing","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_70":{"id":"ea60e5d3f3da_70","name":"8214","type":"P","href":null,"layout":null,"metadata":null,"text":"Not so! The demo above shows that the flashing of Blue Pill is fully automated and triggered by the web browser, when we click the Download button in the MakeCode web page. How does this work?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_70.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_70.markups.0":{"type":"CODE","start":131,"end":139,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_71":{"id":"ea60e5d3f3da_71","name":"aa78","type":"P","href":null,"layout":null,"metadata":null,"text":"While the Application runs on Blue Pill (we call this the Application Mode), the Bootloader is called periodically to check for USB requests. When the Bootloader receives a request for flashing, it restarts the Blue Pill into Bootloader Mode to perform the flashing. The Application doesn’t run until the flashing has been completed.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_71.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_71.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_71.markups.0":{"type":"STRONG","start":58,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_71.markups.1":{"type":"STRONG","start":226,"end":241,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_72":{"id":"ea60e5d3f3da_72","name":"0d2c","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*kciuJ3Kl_p9eC1cVE9hOPw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kciuJ3Kl_p9eC1cVE9hOPw.png":{"id":"1*kciuJ3Kl_p9eC1cVE9hOPw.png","originalHeight":1176,"originalWidth":2074,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_73":{"id":"ea60e5d3f3da_73","name":"386b","type":"P","href":null,"layout":null,"metadata":null,"text":"The flashing magic is made possible by the HF2 Protocol implemented in the MakeCode website and in the Bootloader code. The MakeCode website transmits HF2 command packets via in-browser JavaScript, via the WebUSB JavaScript API, via the WinUSB driver (on Windows), finally to the USB port of the Blue Pill.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_73.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_73.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_73.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_73.markups.0":{"type":"A","start":75,"end":91,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fstm32bluepill-makecode","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_73.markups.1":{"type":"A","start":141,"end":170,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fpxt\u002Fblob\u002Fmaster\u002Fpxtlib\u002Fhf2.ts","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_73.markups.2":{"type":"STRONG","start":43,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_74":{"id":"ea60e5d3f3da_74","name":"fa37","type":"P","href":null,"layout":null,"metadata":null,"text":"The Blue Pill Bootloader receives the HF2 command packets and executes them, switching between Application and Bootloader Modes when necessary.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_74.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_74.markups.0":{"type":"A","start":4,"end":24,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fstm32\u002Fbootloader\u002Fhf2.c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_75":{"id":"ea60e5d3f3da_75","name":"c82a","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s the overall flow of the HF2 flashing process as implemented in our Blue Pill WebUSB Bootloader…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_75.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_75.markups.0":{"type":"A","start":74,"end":101,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fstm32\u002Fbootloader\u002Fhf2.c#L101-L215","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_76":{"id":"ea60e5d3f3da_76","name":"352d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*niQsB5ijxu28x4dj3naRiw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*niQsB5ijxu28x4dj3naRiw.png":{"id":"1*niQsB5ijxu28x4dj3naRiw.png","originalHeight":1228,"originalWidth":1726,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_77":{"id":"ea60e5d3f3da_77","name":"2f2b","type":"P","href":null,"layout":null,"metadata":null,"text":"1️⃣ MakeCode website first sends the BININFO command. Blue Pill returns the current mode (Application or Bootloader Mode), and the flash memory size (64 KB).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_77.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_77.markups.0":{"type":"CODE","start":37,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_78":{"id":"ea60e5d3f3da_78","name":"f7df","type":"P","href":null,"layout":null,"metadata":null,"text":"2️⃣ MakeCode then sends the INFO command. Blue Pill returns the identity of the device e.g. STM32BLUEPILL.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_78.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_78.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_78.markups.0":{"type":"CODE","start":28,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_78.markups.1":{"type":"CODE","start":92,"end":105,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_79":{"id":"ea60e5d3f3da_79","name":"2696","type":"P","href":null,"layout":null,"metadata":null,"text":"3️⃣ MakeCode sends START_FLASH. Blue Pill restarts in Bootloader Mode to begin flashing.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_79.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_79.markups.0":{"type":"CODE","start":19,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_80":{"id":"ea60e5d3f3da_80","name":"c417","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*8BrNvbyovzAuZDjn9yTrlg.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8BrNvbyovzAuZDjn9yTrlg.png":{"id":"1*8BrNvbyovzAuZDjn9yTrlg.png","originalHeight":1498,"originalWidth":1726,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:ea60e5d3f3da_81":{"id":"ea60e5d3f3da_81","name":"ed5f","type":"P","href":null,"layout":null,"metadata":null,"text":"4️⃣ For each 1 KB page of data to be flashed, MakeCode sends the WRITE_FLASH_PAGE command and the data to be flashed. Blue Pill compares the received data with the current ROM data. If the data is different, it writes the received data to ROM. This is only applicable for the Application ROM, not the Bootloader ROM.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_81.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_81.markups.0":{"type":"CODE","start":65,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_82":{"id":"ea60e5d3f3da_82","name":"3328","type":"P","href":null,"layout":null,"metadata":null,"text":"5️⃣ MakeCode sends RESET_INTO_APP. Blue Pill restarts in Application Mode and runs the flashed Application.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_82.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_82.markups.0":{"type":"CODE","start":19,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_83":{"id":"ea60e5d3f3da_83","name":"6fe6","type":"P","href":null,"layout":null,"metadata":null,"text":"What if the Bootloader needs to be upgraded? The same flow works for upgrading the Bootloader as well. In the next article I’ll explain how the Baseloader upgrades the Bootloader code.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_83.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_83.markups.0":{"type":"A","start":144,"end":154,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Ftree\u002Fmaster\u002Fstm32\u002Fbaseloader","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_84":{"id":"ea60e5d3f3da_84","name":"5c8c","type":"H3","href":null,"layout":null,"metadata":null,"text":"What’s Next?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_85":{"id":"ea60e5d3f3da_85","name":"4055","type":"P","href":null,"layout":null,"metadata":null,"text":"The WebUSB Bootloader for MakeCode on Blue Pill is incredibly complex — it required four articles (plus this article) to explain the topics that we have covered today…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_86":{"id":"ea60e5d3f3da_86","name":"7026","type":"P","href":null,"layout":null,"metadata":null,"text":"1️⃣ We implemented the WebUSB and WinUSB interfaces on Blue Pill…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_87":{"id":"ea60e5d3f3da_87","name":"14e8","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill USB Bootloader — How I fixed the USB Storage, Serial, DFU and WebUSB interfaces\nBuilding a complex composite USB device with libopencm3 that works on Windows, Mac and Linuxmedium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_87.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_87.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_87.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_87.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_87.markups.0":{"type":"A","start":0,"end":198,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_87.markups.1":{"type":"STRONG","start":0,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_87.markups.2":{"type":"EM","start":96,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_87.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-usb-bootloader-how-i-fixed-the-usb-storage-serial-dfu-and-webusb-interfaces-36d7fe245b5c","thumbnailImageId":"1*fjfoda1Ovwdahy09TwUkqA.png","mediaResourceId":"1*fjfoda1Ovwdahy09TwUkqA.png","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_88":{"id":"ea60e5d3f3da_88","name":"4e43","type":"P","href":null,"layout":null,"metadata":null,"text":"2️⃣ We applied memory optimisation tools and techniques to squeeze the Bootloader into Blue Pill…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_89":{"id":"ea60e5d3f3da_89","name":"7c98","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill — Analyse and Optimise Your RAM and ROM\nTips and tools to prevent Blue Pill Bloatmedium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_89.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_89.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_89.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_89.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_89.markups.0":{"type":"A","start":0,"end":107,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_89.markups.1":{"type":"STRONG","start":0,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_89.markups.2":{"type":"EM","start":56,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_89.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7","thumbnailImageId":"1*sqHQVxWsmoA7_PW7j9_GJQ.png","mediaResourceId":"1*sqHQVxWsmoA7_PW7j9_GJQ.png","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_90":{"id":"ea60e5d3f3da_90","name":"38d8","type":"P","href":null,"layout":null,"metadata":null,"text":"3️⃣ We created nano-float, an optimised version of the standard math library…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_91":{"id":"ea60e5d3f3da_91","name":"f988","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill – Shrink your math libraries with Qfplib\nFloating-point math libraries can bloat your Blue Pill code. Here’s one way to fix thatmedium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_91.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_91.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_91.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_91.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_91.markups.0":{"type":"A","start":0,"end":154,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-shrink-your-math-libraries-with-qfplib-55093aab163a","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_91.markups.1":{"type":"STRONG","start":0,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_91.markups.2":{"type":"EM","start":57,"end":144,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_91.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-shrink-your-math-libraries-with-qfplib-55093aab163a","thumbnailImageId":"1*Vxgr9fS45NRgtYPmDzkOgg.png","mediaResourceId":"1*Vxgr9fS45NRgtYPmDzkOgg.png","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_92":{"id":"ea60e5d3f3da_92","name":"60d5","type":"P","href":null,"layout":null,"metadata":null,"text":"4️⃣ And we verified the accuracy of the nano-float library through Unit Testing…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_93":{"id":"ea60e5d3f3da_93","name":"f8f6","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"STM32 Blue Pill — Unit Testing with Qemu Blue Pill Emulator\nUnit Testing can help to stop bugs before they pollute the entire IoT chainmedium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_93.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_93.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_93.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_93.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_93.markups.0":{"type":"A","start":0,"end":145,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-unit-testing-with-qemu-blue-pill-emulator-9d88002a68b2","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_93.markups.1":{"type":"STRONG","start":0,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_93.markups.2":{"type":"EM","start":60,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_93.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-unit-testing-with-qemu-blue-pill-emulator-9d88002a68b2","thumbnailImageId":"1*M3Y_T_EI28gPHHBXGxTmjw.png","mediaResourceId":"1*M3Y_T_EI28gPHHBXGxTmjw.png","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_94":{"id":"ea60e5d3f3da_94","name":"1c37","type":"P","href":null,"layout":null,"metadata":null,"text":"5️⃣ We have one upcoming article that explains how the Baseloader upgrades the Bootloader.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_95":{"id":"ea60e5d3f3da_95","name":"e041","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s been a long journey — join me if you’re keen to complete the Blue Pill port of MakeCode! So that we’ll finally have the perfect platform to build and test IoT prototypes.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_95.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_95.markups.0":{"type":"STRONG","start":26,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_96":{"id":"ea60e5d3f3da_96","name":"b3c7","type":"P","href":null,"layout":null,"metadata":null,"text":"There are too many topics to cover, so I kept a log of all things that I have tried (even the failed ones)…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_97":{"id":"ea60e5d3f3da_97","name":"a7f1","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"[Work In Progress] STM32 Blue Pill Visual Programming with MakeCode, CODAL and libopencm3\nNote: This work-in-progress document describes an incomplete implementation of STM32 Blue Pill visual programming. The…medium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_97.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_97.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_97.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:ea60e5d3f3da_97.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:ea60e5d3f3da_97.markups.0":{"type":"A","start":0,"end":219,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fwork-in-progress-stm32-blue-pill-visual-programming-with-makecode-codal-and-libopencm3-422d308f252e","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_97.markups.1":{"type":"STRONG","start":0,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_97.markups.2":{"type":"EM","start":90,"end":209,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:ea60e5d3f3da_97.mixtapeMetadata":{"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fwork-in-progress-stm32-blue-pill-visual-programming-with-makecode-codal-and-libopencm3-422d308f252e","thumbnailImageId":"1*nRCSpyqsYtpaJSNGwD13bQ.jpeg","mediaResourceId":"1*nRCSpyqsYtpaJSNGwD13bQ.jpeg","__typename":"MixtapeMetadata"},"Paragraph:ea60e5d3f3da_98":{"id":"ea60e5d3f3da_98","name":"427a","type":"P","href":null,"layout":null,"metadata":null,"text":"Why not port MicroPython to Blue Pill? I tried but failed miserably. MicroPython was designed for dynamic memory allocation, which works poorly on Blue Pill’s constrained RAM. Unlike MakeCode, which implements Static TypeScript without dynamic memory.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_98.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_98.markups.0":{"type":"A","start":39,"end":67,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fsend_altitude_cocoos\u002Ftree\u002Fmicropython\u002Flib\u002Fbluepill-micropython\u002Fports\u002Fbluepill","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_99":{"id":"ea60e5d3f3da_99","name":"345d","type":"P","href":null,"layout":null,"metadata":null,"text":"Look forward to having you onboard the Blue Pill MakeCode journey! :-)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_100":{"id":"ea60e5d3f3da_100","name":"37f4","type":"H3","href":null,"layout":null,"metadata":null,"text":"For Advanced Programmers: Linker Script for Bootloader","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_101":{"id":"ea60e5d3f3da_101","name":"b877","type":"P","href":null,"layout":null,"metadata":null,"text":"If you’re interested in writing a Linker Script to customise the memory layout in your embedded program, read on…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_101.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_101.markups.0":{"type":"EM","start":0,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_102":{"id":"ea60e5d3f3da_102","name":"465f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"_bootrom_size = 29K\n...\nMEMORY \u002F* Define memory regions. *\u002F\n{\n  \u002F* Available ROM is 64K (0x10000). \n     Reserve lower part for Bootloader, \n     upper part for Application. *\u002F","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_103":{"id":"ea60e5d3f3da_103","name":"3538","type":"PRE","href":null,"layout":null,"metadata":null,"text":"bootrom (rx)  : ORIGIN = 0x08000000,      \n                 LENGTH = _bootrom_size","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_104":{"id":"ea60e5d3f3da_104","name":"5fc9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"rom     (rx)  : ORIGIN = 0x08000000 + _bootrom_size, \n                 LENGTH = 64K - _bootrom_size","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_105":{"id":"ea60e5d3f3da_105","name":"05a6","type":"P","href":null,"layout":null,"metadata":null,"text":"The above Linker Script tells the GNU Linker to create two memory regions: bootrom (29 KB) and rom (64–29=35 KB). How do we instruct the linker to allocate various libraries to bootrom and rom?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_105.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_105.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_105.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_105.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_105.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_105.markups.0":{"type":"CODE","start":75,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_105.markups.1":{"type":"CODE","start":95,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_105.markups.2":{"type":"CODE","start":177,"end":184,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_105.markups.3":{"type":"CODE","start":189,"end":192,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_105.markups.4":{"type":"A","start":10,"end":23,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fld\u002Fstm32f103x8.ld","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_106":{"id":"ea60e5d3f3da_106","name":"089b","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*afGJhqhuce_Ld0b6Eks1kw.png","typename":"ImageMetadata"},"text":"Memory Layout with two memory regions","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_107":{"id":"ea60e5d3f3da_107","name":"fef5","type":"P","href":null,"layout":null,"metadata":null,"text":"From my article on memory optimisation, you’ll recall that the rom memory region contains a Text Section (for program code) and a Data Section (for initial values of non-zero variables). Here’s how we tell the linker which libraries to allocate into the Text Section of bootrom…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_107.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_107.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_107.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_107.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_107.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_107.markups.0":{"type":"CODE","start":63,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_107.markups.1":{"type":"CODE","start":270,"end":277,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_107.markups.2":{"type":"A","start":5,"end":38,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fmedium.com\u002F@ly.lee\u002Fstm32-blue-pill-analyse-and-optimise-your-ram-and-rom-9fc805e16ed7?source=friends_link&sk=54719084d640bb1d92ac1097d623bba2","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_107.markups.3":{"type":"STRONG","start":92,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_107.markups.4":{"type":"STRONG","start":130,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_108":{"id":"ea60e5d3f3da_108","name":"bbd7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SECTIONS\n{\n .boot_text : { \u002F* Bootloader ROM *\u002F\n  ...\n  *liblibopencm3.a: (.text*) \u002F* libopencm3       *\u002F\n  *libnano-float.a: (.text*) \u002F* Math Library     *\u002F\n  *libnewlib.a:     (.text*) \u002F* C Library        *\u002F\n  *liblogger.a:     (.text*) \u002F* Logger           *\u002F\n  *libbluepill.a:   (.text*) \u002F* Device Functions *\u002F\n  *libbootloader.a: (.text*) \u002F* Bootloader       *\u002F\n  ...\n} \u003Ebootrom","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_109":{"id":"ea60e5d3f3da_109","name":"23f2","type":"P","href":null,"layout":null,"metadata":null,"text":"The * wildcard matches any number of characters. When used like this…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_109.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_109.markups.0":{"type":"CODE","start":4,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_110":{"id":"ea60e5d3f3da_110","name":"804b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"*liblibopencm3.a: (.text*)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_111":{"id":"ea60e5d3f3da_111","name":"0888","type":"P","href":null,"layout":null,"metadata":null,"text":"…the linker takes all object files (*.o) from the library liblibopencm3.a, extracts all the Text Sections, and writes them into the bootrom memory region.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_111.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_111.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_111.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_111.markups.0":{"type":"CODE","start":36,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_111.markups.1":{"type":"CODE","start":58,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_111.markups.2":{"type":"CODE","start":132,"end":139,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_112":{"id":"ea60e5d3f3da_112","name":"0f36","type":"P","href":null,"layout":null,"metadata":null,"text":"All other libraries and object files that don’t match the above patterns will be allocated in the rom memory region, according to this rule…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_112.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_112.markups.0":{"type":"CODE","start":98,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_113":{"id":"ea60e5d3f3da_113","name":"0eac","type":"PRE","href":null,"layout":null,"metadata":null,"text":".text : {          \u002F* Application ROM        *\u002F\n  ...\n  * (.text*) \u002F* Other Application Code *\u002F\n  ...\n} \u003Erom","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_114":{"id":"ea60e5d3f3da_114","name":"fa86","type":"P","href":null,"layout":null,"metadata":null,"text":"What about the Blue Pill RAM? We allocate the available RAM into three memory regions: bootram (for the Bootloader), ram (for the Application) and bootbuf. bootbuf contains the RAM buffers used for flashing the ROM in Bootloader Mode. Since bootbuf is not used in Application Mode, we convert bootbuf into an extended memory space for the stack and the heap while running the Application.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_114.markups.6","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_114.markups.0":{"type":"CODE","start":87,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_114.markups.1":{"type":"CODE","start":117,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_114.markups.2":{"type":"CODE","start":147,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_114.markups.3":{"type":"CODE","start":156,"end":163,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_114.markups.4":{"type":"CODE","start":241,"end":248,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_114.markups.5":{"type":"CODE","start":293,"end":300,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_114.markups.6":{"type":"A","start":282,"end":357,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fstm32\u002Fbootloader\u002Fbootloader.c#L170-L173","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_115":{"id":"ea60e5d3f3da_115","name":"05ef","type":"P","href":null,"layout":null,"metadata":null,"text":"The Linker Script for RAM layout looks like this…","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:ea60e5d3f3da_115.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_115.markups.0":{"type":"A","start":4,"end":17,"href":"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20191204194207\u002Fhttps:\u002F\u002Fgithub.com\u002Flupyuen\u002Fcodal-libopencm3\u002Fblob\u002Fmaster\u002Fld\u002Fstm32f103x8.ld","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:ea60e5d3f3da_116":{"id":"ea60e5d3f3da_116","name":"13cc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"_bootrom_size = 29K;    \u002F* Size of Bootloader ROM \n                           (code + constant data) *\u002F","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_117":{"id":"ea60e5d3f3da_117","name":"5881","type":"PRE","href":null,"layout":null,"metadata":null,"text":"_bootram_size =  4K;    \u002F* Size of Bootloader RAM *\u002F","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_118":{"id":"ea60e5d3f3da_118","name":"c6c3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"_bootbuf_size = \u002F* Size of the Bootloader buffers...         *\u002F\n 1090 +         \u002F* flashBuf from stm32\u002Fbootloader\u002Fghostfat.c *\u002F\n 1024 +         \u002F* hf2_buffer from stm32\u002Fbootloader\u002Fhf2.c    *\u002F\n    2;          \u002F* Align to 4 bytes *\u002F\n...\nMEMORY \u002F* Define memory regions. *\u002F\n{\n  \u002F* Available RAM is 20K (0x5000). \n     Reserve lower part for Bootloader, \n     middle part for Application,\n     upper part for Bootloader flash buffers \n     (not used in Application Mode). *\u002F","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_119":{"id":"ea60e5d3f3da_119","name":"2ee4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  bootram (rwx) : ORIGIN = 0x20000000,      \n                  LENGTH = _bootram_size","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_120":{"id":"ea60e5d3f3da_120","name":"0368","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  ram     (rwx) : ORIGIN = 0x20000000 + _bootram_size, \n                  LENGTH = 20K - _bootram_size - _bootbuf_size","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:ea60e5d3f3da_121":{"id":"ea60e5d3f3da_121","name":"531c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  bootbuf (rwx) : ORIGIN = 0x20005000 - _bootbuf_size, \n                  LENGTH = _bootbuf_size","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"User:87a61f1520ab":{"id":"87a61f1520ab","__typename":"User"},"Collection:721b17443fd5":{"creator":{"type":"id","generated":false,"id":"User:87a61f1520ab","typename":"User"},"viewerIsEditor":false,"__typename":"Collection","name":"Coinmonks","avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*-_aiJHzJPz655N7iSSrLrQ.png","typename":"ImageMetadata"},"id":"721b17443fd5","domain":null,"slug":"coinmonks"},"Tag:programming":{"id":"programming","displayTitle":"Programming","__typename":"Tag"},"Tag:gadgets":{"id":"gadgets","displayTitle":"Gadgets","__typename":"Tag"},"Tag:internet-of-things":{"id":"internet-of-things","displayTitle":"Internet of Things","__typename":"Tag"},"Tag:stm32":{"id":"stm32","displayTitle":"Stm32","__typename":"Tag"},"ImageMetadata:1*-_aiJHzJPz655N7iSSrLrQ.png":{"id":"1*-_aiJHzJPz655N7iSSrLrQ.png","__typename":"ImageMetadata"},"$Post:b7f1a1508e89.previewContent":{"subtitle":"How  the MakeCode Bootloader for Blue Pill implements flashing over WebUSB","__typename":"PreviewContent"},"programming":{"name":"Programming","slug":"programming","__typename":"Topic"}}</script><script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/manifest.c83c1a1a.js"></script><script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/vendors~main.9c8dc7d0.chunk.js"></script><script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/main.c5c932e3.chunk.js"></script><script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/vendors~screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~scre~3e410f11.faa5af01.chunk.js"></script>
<script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~screen.post~~73c4bb05.cf7c8ea6.chunk.js"></script>
<script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/screen.post~screen.post.amp~screen.post.series~screen.profile~screen.sequence.library~screen.sequenc~036c6b37.3e471c5d.chunk.js"></script>
<script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tick~screen.landingp~ed90ee39.3c8733a8.chunk.js"></script>
<script src="https://web.archive.org/web/20191204194207js_/https://cdn-client.medium.com/lite/static/js/screen.post.1aa42b57.chunk.js"></script><script>window.main();</script></body></html><!--
     FILE ARCHIVED ON 19:42:07 Dec 04, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 01:30:26 Feb 23, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 132.391
  exclusion.robots: 0.37
  exclusion.robots.policy: 0.357
  RedisCDXSource: 2.02
  esindex: 0.016
  LoadShardBlock: 94.043 (3)
  PetaboxLoader3.datanode: 54.885 (4)
  CDXLines.iter: 31.615 (3)
  load_resource: 52.065
  PetaboxLoader3.resolve: 20.617
-->