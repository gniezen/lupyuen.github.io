<!doctype html>
<html lang="en">

<head>
  <link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=bsmaklHF" />
  <link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
  <!-- End Wayback Rewrite JS Include -->
  <title data-rh="true">Hey GD32 VF103 on RISC-V: I surrender… For now - Lup Yuen Lee 李立源 - Medium</title>
  <meta data-rh="true" charset="utf-8" />
  <meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
  <meta data-rh="true" name="theme-color" content="#000000" />
  <meta data-rh="true" name="twitter:app:name:iphone" content="Medium" />
  <meta data-rh="true" name="twitter:app:id:iphone" content="828256236" />
  <meta data-rh="true" property="al:ios:app_name" content="Medium" />
  <meta data-rh="true" property="al:ios:app_store_id" content="828256236" />
  <meta data-rh="true" property="al:android:package" content="com.medium.reader" />
  <meta data-rh="true" property="fb:app_id" content="542599432471018" />
  <meta data-rh="true" property="og:site_name" content="Medium" />
  <meta data-rh="true" property="og:type" content="article" />
  <meta data-rh="true" property="article:published_time" content="2019-11-23T15:55:20.275Z" />
  <meta data-rh="true" name="title"
    content="Hey GD32 VF103 on RISC-V: I surrender… For now - Lup Yuen Lee 李立源 - Medium" />
  <meta data-rh="true" property="og:title" content="Hey GD32 VF103 on RISC-V: I surrender… For now" />
  <meta data-rh="true" property="twitter:title" content="Hey GD32 VF103 on RISC-V: I surrender… For now" />
  <meta data-rh="true" name="twitter:site" content="@Medium" />
  <meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/d39d0c7b0001" />
  <meta data-rh="true" property="al:android:url" content="medium://p/d39d0c7b0001" />
  <meta data-rh="true" property="al:ios:url" content="medium://p/d39d0c7b0001" />
  <meta data-rh="true" property="al:android:app_name" content="Medium" />
  <meta data-rh="true" name="description"
    content="I have failed only once… Building a simple IoT Sensor Device on FPGA. The reason for that failure was strongly evident… FPGA Programming is not meant for ordinary mortals! I tucked that project away…" />
  <meta data-rh="true" property="og:description"
    content="Me vs Tech: I will never admit defeat to Tech because I have too much pride… Or toxic masculinity." />
  <meta data-rh="true" property="twitter:description"
    content="Me vs Tech: I will never admit defeat to Tech because I have too much pride… Or toxic masculinity." />
  <meta data-rh="true" property="og:url"
    content="https://web.archive.org/web/20191123160606/https://medium.com/@ly.lee/hey-gd32-vf103-on-risc-v-i-surrender-for-now-d39d0c7b0001" />
  <meta data-rh="true" property="al:web:url"
    content="https://medium.com/@ly.lee/hey-gd32-vf103-on-risc-v-i-surrender-for-now-d39d0c7b0001" />
  <meta data-rh="true" property="og:image"
    content="https://web.archive.org/web/20191123160606im_/https://miro.medium.com/max/1200/1*G3vyMuMZHKSC2YvO8zxNNg.png" />
  <meta data-rh="true" name="twitter:image:src"
    content="https://miro.medium.com/max/1200/1*G3vyMuMZHKSC2YvO8zxNNg.png" />
  <meta data-rh="true" name="twitter:card" content="summary_large_image" />
  <meta data-rh="true" property="article:author" content="https://medium.com/@ly.lee" />
  <meta data-rh="true" name="twitter:creator" content="@MisterTechBlog" />
  <meta data-rh="true" name="author" content="Lup Yuen Lee 李立源" />
  <meta data-rh="true" name="robots" content="index,follow" />
  <meta data-rh="true" name="referrer" content="unsafe-url" />
  <meta data-rh="true" name="twitter:label1" value="Reading time" />
  <meta data-rh="true" name="twitter:data1" value="5 min read" />
  <meta data-rh="true" name="parsely-post-id" content="d39d0c7b0001" />
  <link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246" />
  <link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium"
    href="/web/20191123160606/https://medium.com/osd.xml" />
  <link data-rh="true" rel="apple-touch-icon" sizes="152x152"
    href="https://web.archive.org/web/20191123160606im_/https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png" />
  <link data-rh="true" rel="apple-touch-icon" sizes="120x120"
    href="https://web.archive.org/web/20191123160606im_/https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png" />
  <link data-rh="true" rel="apple-touch-icon" sizes="76x76"
    href="https://web.archive.org/web/20191123160606im_/https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png" />
  <link data-rh="true" rel="apple-touch-icon" sizes="60x60"
    href="https://web.archive.org/web/20191123160606im_/https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png" />
  <link data-rh="true" rel="mask-icon"
    href="https://web.archive.org/web/20191123160606im_/https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg"
    color="#171717" />
  <link data-rh="true" rel="icon"
    href="https://web.archive.org/web/20191123160606im_/https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" />
  <link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css"
    href="https://web.archive.org/web/20191123160606cs_/https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css" />
  <link data-rh="true" rel="author" href="https://medium.com/@ly.lee" />
  <link data-rh="true" rel="canonical"
    href="https://web.archive.org/web/20191123160606/https://medium.com/@ly.lee/hey-gd32-vf103-on-risc-v-i-surrender-for-now-d39d0c7b0001" />
  <link data-rh="true" rel="alternate"
    href="https://web.archive.org/web/20191123160606/android-app://com.medium.reader/https/medium.com/p/d39d0c7b0001" />
</head>

<body>
  <div id="root">
    <div class="a b c">
      <article>
        <section class="cj ck cl cm ak cn ce n co"></section><span class="r"></span>
        <div>
          <div class="cp u cq cr cs ct"></div>
          <section class="cu cv cw cx cy">
            <div class="cz ak">
              <figure class="da cz ak paragraph-image">
                <div class="db dc dd de ak">
                  <div class="dl r dd dm">
                    <div class="dn r">
                      <div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq"
                          src="https://web.archive.org/web/20191123160606im_/https://miro.medium.com/max/60/1*G3vyMuMZHKSC2YvO8zxNNg.png?q=20"
                          width="5169" height="3608" role="presentation" /></div><img class="df dg cp t u dh ak dr"
                        width="5169" height="3608" role="presentation" /><noscript><img class="cp t u dh ak"
                          src="https://web.archive.org/web/20191123160606im_/https://miro.medium.com/max/10338/1*G3vyMuMZHKSC2YvO8zxNNg.png"
                          width="5169" height="3608" role="presentation" /></noscript>
                    </div>
                  </div>
                </div>
                <figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">“All creatures bow down and surrender to the
                  mighty GigaDevice GD32 VF103 on RISC-V!”</figcaption>
              </figure>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <div>
                  <div id="a62e" class="ea eb ec bk ed b ee ef eg eh ei ej ek">
                    <h1 class="ed b ee el ec">Hey GD32 VF103 on RISC-V: I surrender… For now</h1>
                  </div>
                  <div class="em">
                    <div class="n en eo ep eq">
                      <div class="o n">
                        <div><a rel="noopener"
                            href="/web/20191123160606/https://medium.com/@ly.lee?source=post_page-----d39d0c7b0001----------------------">
                            <div class="dd er es">
                              <div class="bs n et o p cp eu ev ew ex ey ct"><svg width="57" height="57"
                                  viewbox="0 0 57 57">
                                  <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M28.5 1.2A27.45 27.45 0 0 0 4.06 15.82L3 15.27A28.65 28.65 0 0 1 28.5 0C39.64 0 49.29 6.2 54 15.27l-1.06.55A27.45 27.45 0 0 0 28.5 1.2zM4.06 41.18A27.45 27.45 0 0 0 28.5 55.8a27.45 27.45 0 0 0 24.44-14.62l1.06.55A28.65 28.65 0 0 1 28.5 57 28.65 28.65 0 0 1 3 41.73l1.06-.55z">
                                  </path>
                                </svg></div><img alt="Lup Yuen Lee 李立源" class="r ez es er"
                                src="https://web.archive.org/web/20191123160606im_/https://miro.medium.com/fit/c/96/96/1*KGohS3sQaUnr58gc0BIfoQ.jpeg"
                                width="48" height="48" />
                            </div>
                          </a></div>
                        <div class="fa ak r">
                          <div class="n">
                            <div style="flex:1"><span class="bj b bk bl bm bn r ec q">
                                <div class="fb n o fc"><span class="bj dy ds bl di fd fe ff fg fh ec"><a
                                      class="at au av aw ax ay az ba bb bc fi bf bg bh bi" rel="noopener"
                                      href="/web/20191123160606/https://medium.com/@ly.lee?source=post_page-----d39d0c7b0001----------------------">Lup
                                      Yuen Lee 李立源</a></span>
                                  <div class="fj r ar h"><button
                                      class="fk ec q by fl fm fn fo bc bh fp fq fr fs ft fu cb bj b bk fv fw bn cc cd ce cf cg bf">Follow</button>
                                  </div>
                                </div>
                              </span></div>
                          </div><span class="bj b bk bl bm bn r bo bp"><span class="bj dy ds bl di fd fe ff fg fh bo">
                              <div><a class="at au av aw ax ay az ba bb bc fi bf bg bh bi" rel="noopener"
                                  href="/web/20191123160606/https://medium.com/@ly.lee/hey-gd32-vf103-on-risc-v-i-surrender-for-now-d39d0c7b0001?source=post_page-----d39d0c7b0001----------------------">Nov
                                  23</a> <!-- -->·
                                <!-- -->
                                <!-- -->5
                                <!-- --> min read
                              </div>
                            </span></span>
                        </div>
                      </div>
                      <div class="n fx fy fz ga gb gc gd ge ab">
                        <div class="n o">
                          <div class="gf r ar g"><a
                              href="//web.archive.org/web/20191123160606/https://medium.com/p/d39d0c7b0001/share/twitter?source=post_actions_header---------------------------"
                              class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank"
                              rel="noopener"><svg width="29" height="29" class="q">
                                <path
                                  d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z">
                                </path>
                              </svg></a></div>
                          <div class="gf r ar g"><a
                              href="//web.archive.org/web/20191123160606/https://medium.com/p/d39d0c7b0001/share/facebook?source=post_actions_header---------------------------"
                              class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank"
                              rel="noopener"><svg width="29" height="29" class="q">
                                <path
                                  d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79">
                                </path>
                              </svg></a></div>
                          <div class="gf ap aq">
                            <div class="cf"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi"><svg
                                  width="25" height="25" class="q">
                                  <g fill-rule="evenodd">
                                    <path
                                      d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01">
                                    </path>
                                    <path
                                      d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2">
                                    </path>
                                  </g>
                                </svg></button></div>
                          </div>
                          <div class="gg r ao">
                            <div>
                              <div class="cf"><a
                                  href="https://web.archive.org/web/20191123160606/https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fhey-gd32-vf103-on-risc-v-i-surrender-for-now-d39d0c7b0001&amp;source=post_actions_header--------------------------bookmark_sidebar-"
                                  class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25"
                                    height="25" viewbox="0 0 25 25">
                                    <path
                                      d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z"
                                      fill-rule="evenodd"></path>
                                  </svg></a></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <p id="3564" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Me vs Tech: I will <strong
                    class="gj gv">never admit defeat to Tech</strong> because I have too much pride… Or toxic
                  masculinity.</p>
                <p id="c041" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><em class="gw">I have failed only
                    once…</em> <a class="at cg gx gy gz ha" target="_blank" rel="noopener"
                    href="/web/20191123160606/https://medium.com/coinmonks/program-your-first-fpga-with-gowin-gw1n-4-b0d5c22b9fea?source=friends_link&amp;sk=d52b303b432a5268b5d485aea6ca404c">Building
                    a simple IoT Sensor Device on FPGA</a>. The reason for that failure was strongly evident… <em
                    class="gw">FPGA Programming is not meant for ordinary mortals!</em> I tucked that project away until
                  we have better open-source graphical FPGA programming tools that can synthesise exactly what I need,
                  without micromanaging every single LUT <em class="gw">(OK that’s an exaggeration)</em></p>
                <p id="6481" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><strong class="gj gv">Porting
                  </strong><a href="https://web.archive.org/web/20191123160606/https://mynewt.apache.org/"
                    class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow"><strong class="gj gv">Mynewt
                      OS</strong></a><strong class="gj gv"> to </strong><a
                    href="https://web.archive.org/web/20191123160606/https://www.gigadevice.com/products/microcontrollers/gd32/risc-v/"
                    class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow"><strong class="gj gv">GD32
                      VF103</strong></a><strong class="gj gv"> on </strong><a
                    href="https://web.archive.org/web/20191123160606/https://en.wikipedia.org/wiki/RISC-V"
                    class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow"><strong
                      class="gj gv">RISC-V</strong></a><strong class="gj gv"> is my second failure</strong>. <a
                    class="at cg gx gy gz ha" target="_blank" rel="noopener"
                    href="/web/20191123160606/https://medium.com/swlh/porting-apache-mynewt-os-to-gigadevice-gd32-vf103-on-risc-v-4054a5922493?source=friends_link&amp;sk=215cd06186d912277d0469224666d60d">As
                    I have documented earlier</a>, the low level Mynewt OS code was running fine, even Embedded Rust.
                  But then other issues crept in. Here’s what failure looks like…</p>
                <figure class="hc hd he hf hg cz cl cm paragraph-image">
                  <div class="db dc dd de ak">
                    <div class="cl cm hb">
                      <div class="dl r dd dm">
                        <div class="hh r">
                          <div class="df dg cp t u dh ak di dj dk"><img class="cp t u dh ak do dp dq"
                              src="https://web.archive.org/web/20191123160606im_/https://miro.medium.com/max/38/1*GaG9LNXlFvDHwKsvqcCd0w.png?q=20"
                              width="815" height="1312" role="presentation" /></div><img class="df dg cp t u dh ak dr"
                            width="815" height="1312" role="presentation" /><noscript><img class="cp t u dh ak"
                              src="https://web.archive.org/web/20191123160606im_/https://miro.medium.com/max/1630/1*GaG9LNXlFvDHwKsvqcCd0w.png"
                              width="815" height="1312" role="presentation" /></noscript>
                        </div>
                      </div>
                    </div>
                  </div>
                  <figcaption class="bo ds dt du dv cn cl cm dw dx bj dy">History of GitHub commits on the GD32 VF103
                    port of Mynewt OS. From <a
                      href="https://web.archive.org/web/20191123160606/https://github.com/lupyuen/stm32bluepill-mynewt-sensor/commits/gd32vf103"
                      class="at cg gx gy gz ha" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/commits/gd32vf103</a>
                  </figcaption>
                </figure>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="1af3" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">1️⃣ <strong class="gj gv">Too
                    comfortable with Arm Semihosting, SWD Flashing + Debugging and ST-Link</strong></p>
                <p id="34ff" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">After working on RISC-V for a
                  while, I gotta admit that Arm and STMicroelectronics did a really great job with programming support:
                  <strong class="gj gv">Flashing and Debugging</strong>!</p>
                <p id="33ee" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">I love using <strong
                    class="gj gv">Arm Semihosting</strong> to display debug messages on OpenOCD! Yes some developers are
                  annoyed by the slow transfer of debug messages over Semihosting… But I solved it the software way:
                  Buffering in memory before going a giant dump of debug messages.</p>
                <p id="8729" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">I don’t like the hassle of
                  connecting another UART port just to see debug messages. To me, <strong class="gj gv">Embedded
                    Programming should be Plug and Play</strong>… Just Plug in the ST-Link USB Programmer and start
                  Playing with the gadget! Let’s not subject Embedded Newbies to any extra hassle… <em class="gw">We
                    should be thankful they are still hanging on!</em></p>
                <p id="47e8" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">While experimenting with Nordic
                  nRF52, I realised there’s something magical about the ST-Link USB dongle. It’s known as a High Level
                  Adapter for SWD, because <strong class="gj gv">ST-Link handles the complex SWD protocol
                    internally</strong> and presents a <strong class="gj gv">simple, high-speed USB interface</strong>
                  to OpenOCD. <em class="gw">(That’s why I had to use a Raspberry Pi to remove the Flash Protection on
                    nRF52)</em></p>
                <p id="0353" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">So using ST-Link and OpenOCD to
                  flash and debug any STM32 microcontroller, even Nordic nRF52, are super efficient. Today I still enjoy
                  rapid iterative development on <a class="at cg gx gy gz ha" target="_blank" rel="noopener"
                    href="/web/20191123160606/https://medium.com/swlh/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot-81b74161c159?source=friends_link&amp;sk=d9301466f5499bece3e7b638e99ec20d"><strong
                      class="gj gv">PineTime Smart Watch</strong></a> (nRF52)… <em class="gw">Arm Semihosting + SWD +
                    ST-Link make the perfect workflow for Embedded Developers!</em></p>
                <p id="b4eb" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Now here are my gripes about
                  RISC-V and GD32 VF103…</p>
                <ol class="">
                  <li id="8a70" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu hr hs ht">Took me a while to
                    figure out how to <strong class="gj gv">connect OpenOCD to GD32 VF103 via JTAG</strong>. <a
                      href="https://web.archive.org/web/20191123160606/https://github.com/Tencent/TencentOS-tiny/blob/master/doc/14.How_to_build_RISC-V_eclipse_development_environment.md"
                      class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow">Instructions were spotty</a>,
                    and I had to build a <a
                      href="https://web.archive.org/web/20191123160606/https://github.com/riscv-mcu/riscv-openocd"
                      class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow">special version of OpenOCD just
                      to support GD32 VF103</a>!</li>
                  <li id="9d76" class="gh gi ec bk gj b gk hu gm hv go hw gq hx gs hy gu hr hs ht">Building OpenOCD on
                    macOS to support GD32 VF103 was relatively painless. But <strong class="gj gv">building OpenOCD on
                      Windows</strong>… <em class="gw">It really hurts! </em>You can see in the Commit Log above that I
                    gave up after many failed attempts to build OpenOCD on Windows… Just not worth my time to solve this
                    tooling issue<em class="gw">. (I think GigaDevice should be the party to solve this and provide the
                      Windows binaries for OpenOCD!)</em></li>
                  <li id="11c6" class="gh gi ec bk gj b gk hu gm hv go hw gq hx gs hy gu hr hs ht"><strong
                      class="gj gv">Flashing over JTAG is slow</strong>. It disrupts my iterative coding workflow. And I
                    become much less productive. Wished there’s some High Level Adapter for JTAG that flashes more
                    efficiently.</li>
                  <li id="7555" class="gh gi ec bk gj b gk hu gm hv go hw gq hx gs hy gu hr hs ht"><strong
                      class="gj gv">Debug output goes… where?</strong> JTAG doesn’t expose a debug messaging port like
                    Arm Semihosting. So I have to use the UART port. Only <a
                      href="https://web.archive.org/web/20191123160606/https://www.seeedstudio.com/Sipeed-USB-JTAG-TTL-RISC-V-Debugger-p-2910.html"
                      class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow">Sipeed’s JTAG dongle</a>
                    includes a UART interface… Are there other JTAG dongles that support this? I doubt so. <em
                      class="gw">(I gave up while porting the UART driver, which was supposed to make my debugging more
                      productive)</em></li>
                </ol>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="a9f1" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">2️⃣ <strong class="gj gv">GD32
                    VF103 is just too different from SiFive FE310-G000</strong></p>
                <p id="635d" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Mynewt (and Zephyr) has already
                  been ported to a RISC-V development board: <a
                    href="https://web.archive.org/web/20191123160606/https://www.sifive.com/boards/hifive1"
                    class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow"><strong class="gj gv">SiFive
                      HiFive1</strong></a> based on the <a
                    href="https://web.archive.org/web/20191123160606/https://www.sifive.com/chip-designer#fe310"
                    class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow"><strong class="gj gv">SiFive
                      FE310-G000</strong></a> microcontroller. So why don’t we start with the HiFive1 code and tweak it
                  for GD32 VF103?</p>
                <p id="90c6" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><em class="gw">That’s how I
                    started… And I quickly ran into deep sh… shenanigans.</em></p>
                <p id="876a" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><strong class="gj gv">GD32 VF103
                    has too many I/O ports</strong>: UART, I2C, SPI, CAN, USB… Most of them don’t exist on SiFive
                  FE310-G000. Most modern microcontrollers have a huge selection of ports so I’m not blaming GigaDevice.
                  Since GD32 VF103 was inspired by STM32 Blue Pill (F103), it has as many ports as Blue Pill. <em
                    class="gw">(That’s the reason why I upgraded from Arduino Uno to Blue Pill… Farewell Bit Banging,
                    Hello Proper Ports!)</em></p>
                <p id="9b7f" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">This causes problems when we port
                  an operating system like Mynewt to GD32 VF103… <strong class="gj gv">We need to build a
                    driver</strong> for UART, another for I2C, another for SPI, another for CAN, another for USB, …</p>
                <p id="0217" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">I gave up while building the UART
                  driver (so that I could debug GD32 VF103 more productively).</p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="95a8" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><strong class="gj gv">3️⃣ GD32
                    VF103 is also too different from STM32 Blue Pill</strong></p>
                <p id="1604" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><em class="gw">Since GD32 VF103
                    was inspired by STM32 Blue Pill, why not copy the driver code from Blue Pill?</em></p>
                <p id="b9ff" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">It’s not 100% the same.
                  GigaDevice tried very hard to make them look the same (even the Interrupt Vector Table). But the
                  architectures are fundamentally different: Arm vs RISC-V.</p>
                <p id="3ce7" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">System Constants get renamed,
                  Peripheral Addresses get shuffled around, … It gets very tiring to reconcile the STM32 Blue Pill docs
                  with GD32 VF103.</p>
                <p id="773d" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Maybe if I had a whole class of
                  IoT students, I could assign this as homework. But to me it feels like… <em class="gw">Administrative
                    Paperwork</em>. Not sure if it’s worth my time.</p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="3e6e" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><strong class="gj gv">4️⃣ Is
                    there really an urgency to support RISC-V?</strong></p>
                <p id="bb7d" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Reflecting on my <a
                    class="at cg gx gy gz ha" target="_blank" rel="noopener"
                    href="/web/20191123160606/https://medium.com/swlh/porting-apache-mynewt-os-to-gigadevice-gd32-vf103-on-risc-v-4054a5922493?source=friends_link&amp;sk=215cd06186d912277d0469224666d60d">earlier
                    optimism about RISC-V and GD32 VF103</a>… It seemed to be a sure thing that the China-US Trade War
                  would escalate and the IoT Ecosystem in the East would stop producing Arm chips altogether, and move
                  on to RISC-V.</p>
                <p id="b6a4" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><a
                    href="https://web.archive.org/web/20191123160606/https://www.theverge.com/2019/10/25/20932096/arm-license-chip-architecture-huawei-trump-trade-ban-uk-us"
                    class="at cg gx gy gz ha" target="_blank" rel="noopener nofollow"><em class="gw">But that’s not
                      happening any more</em></a><em class="gw">.</em></p>
                <p id="c79e" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">I backtracked to first principles
                  and recalled… <em class="gw">What problem are we solving?</em></p>
                <p id="c4bb" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">If we are trying to make sure
                  that RISC-V boards have a decent operating system like Mynewt (and a proper language like Rust) for
                  teaching IoT… Maybe that’s not so urgent any more. The supply of STM32 Blue Pills and Nordic nRF52
                  microcontrollers will last for a long while.</p>
                <p id="5e74" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Meanwhile we have <a
                    class="at cg gx gy gz ha" target="_blank" rel="noopener"
                    href="/web/20191123160606/https://medium.com/swlh/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot-81b74161c159?source=friends_link&amp;sk=d9301466f5499bece3e7b638e99ec20d">$20
                    smart watches like PineTime</a> running on nRF52 desperately seeking a decent operating system like
                  Mynewt (and a proper language like Rust) for teaching IoT. <em class="gw">Isn’t that an urgent problem
                    to solve?</em></p>
                <p id="d2ed" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">Thus I’m waving the White Flag at
                  RISC-V and GD32 VF103 for now… Retreating to the warm cozy feeling of Arm Semihosting, SWD Flashing +
                  Debugging and ST-Link… <a class="at cg gx gy gz ha" target="_blank" rel="noopener"
                    href="/web/20191123160606/https://medium.com/@ly.lee/building-a-rust-driver-for-pinetimes-touch-controller-cbc1a5d5d3e9?source=friends_link&amp;sk=d8cf73fc943d9c0e960627d768f309cb">As
                    I hack away productively on the PineTime Smart Watch</a>.</p>
                <p id="654c" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu"><em class="gw">No Regrets!</em>
                </p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="7630" class="gh gi ec bk gj b gk gl gm gn go gp gq gr gs gt gu">The incomplete port of Mynewt OS
                  to GD32 VF103 on RISC-V is at the <code class="dm hz ia ib ic b">gd32vf103</code> branch of the
                  repository below. Basic features like task scheduling are working and so is Rust… Just that we have no
                  drivers for UART, I2C, SPI, CAN, USB, …</p>
                <div class="id ie if ig ih ii"><a
                    href="https://web.archive.org/web/20191123160606/https://github.com/lupyuen/stm32bluepill-mynewt-sensor/tree/gd32vf103?source=post_page-----d39d0c7b0001----------------------"
                    rel="noopener nofollow">
                    <section class="il cl cm ak ce n ar im in io ip iq ir is it iu iv iw ix iy iz ja">
                      <div class="jb n co p jc jd">
                        <h2 class="bj je jf bl ec">
                          <div class="di ij fe ff ik fh">lupyuen/stm32bluepill-mynewt-sensor</div>
                        </h2>
                        <div class="jg r">
                          <h3 class="bj dy ds bl bo">
                            <div class="di ij fe ff ik fh">This gd32vf103 branch contains the source code for a Sensor
                              Application for GigaDevice GD32VF103 with Apache Mynewt and…</div>
                          </h3>
                        </div>
                        <div class="jh r">
                          <h4 class="bj dy fw bl bo">
                            <div class="di ij fe ff ik fh">github.com</div>
                          </h4>
                        </div>
                      </div>
                      <div class="ji r">
                        <div class="jj r jk jl jm ji jn jo jp"></div>
                      </div>
                    </section>
                  </a></div>
              </div>
            </div>
          </section>
        </div>
      </article>
    </div>
  </div>
</body>

</html>
<!--
     FILE ARCHIVED ON 16:06:06 Nov 23, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 23:05:43 Feb 22, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  esindex: 0.01
  PetaboxLoader3.resolve: 49.455
  CDXLines.iter: 29.78 (3)
  exclusion.robots.policy: 0.185
  RedisCDXSource: 1.889
  load_resource: 108.553
  captures_list: 250.926
  LoadShardBlock: 215.363 (3)
  PetaboxLoader3.datanode: 95.794 (4)
  exclusion.robots: 0.195
-->